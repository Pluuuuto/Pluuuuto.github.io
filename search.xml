<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>CTF-Reverseå·¥å…·ä¸ç¯å¢ƒé…ç½®</title>
      <link href="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"/>
      <url>/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="ctf-reverseå·¥å…·ä¸ç¯å¢ƒé…ç½®">CTF-Reverseå·¥å…·ä¸ç¯å¢ƒé…ç½®</h1><h2 id="ä»€ä¹ˆæ˜¯-re">ä»€ä¹ˆæ˜¯ reï¼Ÿ</h2><p>ç”¨ã€Šé€†å‘å·¥ç¨‹æ ¸å¿ƒåŸç†ã€‹ä¸­çš„å®šä¹‰</p><blockquote><p>è½¯ä»¶é€†å‘å·¥ç¨‹æ˜¯ä¸€ç§æ¢ç©¶åº”ç”¨ç¨‹åºå†…éƒ¨ç»„æˆç»“æ„åŠå·¥ä½œåŸç†çš„æŠ€æœ¯ï¼Œè¿ç”¨é€†å‘åˆ†ææŠ€æœ¯,çª¥æ¢ç¨‹åºå†…éƒ¨ç»“æ„, æŒæ¡å…¶å·¥ä½œåŸç†ã€‚</p></blockquote><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220210716651.png" class="" title="image-20250220210716651"><p>é€†è¿‡æ¥å°±æ˜¯</p><blockquote><p>è¯†åˆ«ç¨‹åºæ–‡ä»¶çš„ç±»å‹ ---&gt; åˆ©ç”¨åˆé€‚çš„åç¼–è¯‘å·¥å…·å°†ç¨‹åºè¿˜åŸæˆæµç¨‹å›¾ orä¼ªä»£ç  ---&gt; é™æ€åˆ†æåç¼–è¯‘åçš„ç¨‹åº or åŠ¨æ€è°ƒè¯•ç¨‹åº ---&gt;æ ¹æ®åˆ†æç»“æœè·å¾— flag</p></blockquote><h2 id="çŸ¥è¯†å‚¨å¤‡">çŸ¥è¯†å‚¨å¤‡</h2><ul><li>åŸºç¡€è¯¾ç¨‹â€”â€”C è¯­è¨€ã€æ•°æ®ç»“æ„ã€è®¡ç®—æœºç³»ç»ŸåŸºç¡€åŠå®éªŒ</li><li>å¿…è¦è¯­è¨€â€”â€”C/C++ã€Pythonã€Javaï¼ˆå¯é€‰ï¼‰ã€JavaScriptsï¼ˆå¯é€‰ï¼‰</li><li>æ‰©å±•çŸ¥è¯†â€”â€”åŸºæœ¬ x86æ±‡ç¼–æŒ‡ä»¤ã€å¸¸ç”¨åŠ è§£å¯†ç®—æ³•ã€å¯æ‰§è¡Œç¨‹åºç›¸å…³çŸ¥è¯†ã€cmake</li></ul><h2 id="æŸ¥å£³å·¥å…·">æŸ¥å£³å·¥å…·</h2><h3 id="exeinfo-pe"><a href="http://www.exeinfo.byethost18.com/">ExeinfoPE</a></h3><p>æ­£å¸¸äºŒè¿›åˆ¶ç¨‹åº</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220200728052.png" class="" title="image-20250220200728052"><p>åŠ äº† UPX å£³çš„</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220201435261.png" class="" title="image-20250220201435261"><h3 id="die"><ahref="https://github.com/horsicq/DIE-engine">DIE</a></h3><p>æ­£å¸¸äºŒè¿›åˆ¶ç¨‹åº</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220200627658.png" class="" title="image-20250220200627658"><p>åŠ äº† UPX å£³çš„</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220201549485.png" class="" title="image-20250220201549485"><h3 id="peid"><ahref="https://www.softpedia.com/get/Programming/Packers-Crypters-Protectors/PEiD-updated.shtml">PEiD</a></h3><p>è‡ªè¡Œä¸‹è½½ä½“éªŒ</p><h2 id="é€†å‘å¿…å¤‡ç¥å™¨ida-pro">é€†å‘å¿…å¤‡ç¥å™¨â€”â€”IDA Pro</h2><p><a href="https://www.52pojie.cn/">å¾çˆ±ç ´è§£</a>ä¸‹è½½</p><h3 id="æ’ä»¶ä¸‹è½½">æ’ä»¶ä¸‹è½½</h3><p>åœ¨ Github ä¸Šä¸‹è½½åæ”¾åˆ° IDA å®‰è£…ç›®å½•ä¸‹çš„ plugins æ–‡ä»¶å¤¹ä¸­å³å¯</p><h4 id="findcrypt"><ahref="https://github.com/polymorf/findcrypt-yara">findcrypt</a></h4><p>è¯†åˆ«ç®—æ³•çš„æ’ä»¶ï¼Œéœ€è¦ Python ç¯å¢ƒï¼ŒIDA9.0 ä¸è‡ªå¸¦Pythonï¼Œå»ºè®®è‡ªå·±ä¸‹è½½ä¸€ä¸ªæ”¾åœ¨ IDA å®‰è£…ç›®å½•ä¸‹</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250221152604060.png" class="" title="image-20250221152604060"><h4 id="patching"><ahref="https://github.com/gaasedelen/patching">patching</a></h4><p>keypatch çš„æ›¿ä»£ï¼Œkeypatchç”Ÿæˆçš„æ±‡ç¼–ä»£ç æœ‰çš„æ—¶å€™ä¼šå˜é•¿ï¼Œè€Œä¸”ç›®å‰å·²ç»åœæ›´ï¼Œpatchingåœ¨æŒç»­æ›´æ–°ä¸­</p><h4 id="obpo"><ahref="https://github.com/obpo-project/obpo-plugin">obpo</a></h4><p>åollvmæ··æ·†çš„æ’ä»¶ï¼Œç›®å‰åœ¨ Github ä¸Šå·² archivedï¼ˆå·²å½’æ¡£ï¼‰</p><h2 id="åŠ¨æ€è°ƒè¯•å·¥å…·">åŠ¨æ€è°ƒè¯•å·¥å…·</h2><h3 id="x64dbg"><a href="https://x64dbg.com/">x64dbg</a></h3><p>é€‚ç”¨äº windows å¹³å°çš„ 32 ä½/64 ä½è°ƒè¯•å™¨</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220210614668.png" class="" title="image-20250220210614668"><h3 id="ollydbg"><a href="https://www.ollydbg.de/">Ollydbg</a></h3><p>ä¹Ÿå¯åœ¨<ahref="https://www.52pojie.cn/">å¾çˆ±ç ´è§£</a>ä¸‹è½½ï¼ŒåŒæ ·æ˜¯é€‚ç”¨äº windowså¹³å°çš„è°ƒè¯•å™¨</p><h3 id="ida">IDA</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œç®€å•çš„è°ƒè¯•åœ¨ IDA ä¸­å°±å¯ä»¥è¿›è¡Œï¼Œæ–¹ä¾¿å¿«æ·ï¼›åŒæ—¶ IDAè¿˜å¯ä»¥è¿›è¡Œ Linux ä¸‹çš„ elf æ–‡ä»¶åŠ¨æ€è°ƒè¯•ï¼Œå»ºè®®æ–°æ‰‹å¯ä»¥å…ˆå­¦ IDAçš„åŠ¨æ€è°ƒè¯•</p><h2 id="æ–‡ä»¶ç¼–è¾‘å™¨">æ–‡ä»¶ç¼–è¾‘å™¨</h2><h3 id="editor">010editor</h3><p>è‡ªè¡Œæ£€ç´¢èµ„æºä¸‹è½½ï¼Œå®‰è£…éœ€è¦çš„æ–‡ä»¶ç±»å‹çš„æ¨¡æ¿</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220210446987.png" class="" title="image-20250220210446987"><h3 id="winhex">winhex</h3><p>è‡ªè¡Œä¸‹è½½ä½“éªŒ</p><h2 id="ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®</h2><h3 id="cc-ç¯å¢ƒé…ç½®">C/C++ ç¯å¢ƒé…ç½®</h3><p>é¦–å…ˆåˆ†æ¸…æ¥š <strong>ç¼–è¯‘å™¨ï¼ˆCompilerï¼‰ </strong>ä¸<strong>IDEï¼ˆIntegrated Development Environmentï¼Œé›†æˆå¼€å‘ç¯å¢ƒï¼‰</strong>çš„åŒºåˆ«</p><p>ç¼–è¯‘å™¨æ˜¯</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220215755755.png" class="" title="image-20250220215755755"><p>IDE æ˜¯</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220215927382.png" class="" title="image-20250220215927382"><h4 id="gcc-ç¼–è¯‘å™¨">GCC ç¼–è¯‘å™¨</h4><p>GCC (GNU Compiler Collection) æ˜¯ GNUé¡¹ç›®ä¸­çš„ç¼–è¯‘å™¨é›†åˆï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ Cã€C++ã€Fortranã€Adaç­‰ã€‚å®ƒæ˜¯å¼€æºä¸”è·¨å¹³å°çš„ï¼Œå¹¿æ³›åº”ç”¨äº Linux å’Œå…¶ä»–æ“ä½œç³»ç»Ÿä¸­</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/522c612dbc613668fe630bac1d1dd30d.jpeg" class="" title="522c612dbc613668fe630bac1d1dd30d"><h5 id="windows-ä¸­çš„-gcc">Windows ä¸­çš„ GCC</h5><blockquote><p>å¦‚æœæŒ‰ç…§è€å¸ˆä¸Šè¯¾æ•™çš„å»ä¸‹è½½ IDEï¼Œè€å¸ˆä¼šå‘Šè¯‰ä½ ä¸éœ€è¦è‡ªå·±é…ç½® GCCçš„ç¯å¢ƒï¼Œå› ä¸ºä¸‹è½½çš„ IDE é‡Œè‡ªå¸¦äº† MinGWï¼Œé‚£ä¹ˆ MinGW åˆæ˜¯ä»€ä¹ˆï¼Ÿ</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E4%B8%8B%E8%BD%BD.jpg" class="" title="ä¸‹è½½"></blockquote><p>MinGW æ˜¯ä¸€ä¸ªä¸º Windows å¹³å°æä¾›çš„ GNU å·¥å…·é“¾ï¼ŒåŒ…å«äº† GCCå’Œå…¶ä»–å·¥å…·ï¼Œå¦‚ gdb è°ƒè¯•å™¨ï¼ŒMinGW çš„ç›®æ ‡æ˜¯ä¸º Windowsæä¾›ä¸€ä¸ªæœ¬åœ°çš„ç¼–è¯‘å™¨ï¼Œä½¿å¼€å‘è€…èƒ½å¤Ÿä½¿ç”¨ GCC å·¥å…·é›†è¿›è¡Œ Windows å¼€å‘</p><p>GCC æœ¬èº«æ˜¯è·¨å¹³å°çš„ï¼Œæ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿï¼Œä¸»è¦ç”¨äº Linuxã€macOS ç­‰ç±» Unixç³»ç»Ÿçš„å¼€å‘ï¼Œä½†ä¹Ÿèƒ½åœ¨ Windows ä¸Šä½¿ç”¨ï¼Œé€šå¸¸éœ€è¦é€šè¿‡ Cygwin æˆ– MinGWç­‰å·¥å…·æ¥è¿è¡Œ</p><h4 id="ç¯å¢ƒå˜é‡é…ç½®">ç¯å¢ƒå˜é‡é…ç½®</h4><p>ä¸€èˆ¬ä¸‹è½½ codeblocks æˆ– MinGW ä¼šè‡ªåŠ¨é…ç½®</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250221150903329.png" class="" title="image-20250221150903329"><h5 id="æ¼”ç¤º">æ¼”ç¤º</h5><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250220224713327.png" class="" title="image-20250220224713327"><h4 id="msvc-ç¼–è¯‘å™¨">MSVC ç¼–è¯‘å™¨</h4><p>MSVCï¼ˆMicrosoft Visual C++ï¼‰ æ˜¯å¾®è½¯æä¾›çš„ C å’Œ C++ ç¼–è¯‘å™¨ï¼Œä½œä¸ºVisual Studio é›†æˆå¼€å‘ç¯å¢ƒçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒåœ¨ Windows æ“ä½œç³»ç»Ÿä¸­å¹¿æ³›ä½¿ç”¨</p><h5 id="ç‰¹ç‚¹">ç‰¹ç‚¹</h5><ul><li>ä¸“ä¸º Windows ç³»ç»Ÿä¼˜åŒ–</li><li>ä¸ Visual Studio é›†æˆï¼Œæä¾›å¼ºå¤§çš„è°ƒè¯•å’Œå¼€å‘å·¥å…·</li><li>æ”¯æŒ Windows API å’Œå…¶ä»–å¾®è½¯çš„åº“</li></ul><h5 id="ä¸‹è½½ä¸ç¯å¢ƒé…ç½®">ä¸‹è½½ä¸ç¯å¢ƒé…ç½®</h5><p>æ¨èç›´æ¥ä¸‹è½½ <ahref="https://visualstudio.microsoft.com/zh-hans/">VisualStudio</a>ï¼Œä¸‹è½½æ—¶å‹¾é€‰ â€œä½¿ç”¨ C++ çš„æ¡Œé¢å¼€å‘â€ï¼Œè‡ªåŠ¨å‹¾é€‰ MSVCç¼–è¯‘å™¨ä¸‹è½½ï¼ˆåæœŸè¿˜å¯ä»¥é€šè¿‡ Visual Studio Installer å®‰è£…å…¶ä»–å·¥å…·ï¼‰</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250221145720106.png" class="" title="image-20250221145720106"><p>é…ç½® PATH ç¯å¢ƒå˜é‡</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250221150033488.png" class="" title="image-20250221150033488"><p>é…ç½® INCLUDE ä¸ LIB ç¯å¢ƒå˜é‡</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250221145459970.png" class="" title="image-20250221145459970"><p>INCLUDE å˜é‡è¯¦æƒ…</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250221145927428.png" class="" title="image-20250221145927428"><p>LIB å˜é‡è¯¦æƒ…</p><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250221145939349.png" class="" title="image-20250221145939349"><h5 id="æ¼”ç¤º-1">æ¼”ç¤º</h5><img src="/2025/02/20/CTF-Reverse%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/image-20250221150753244.png" class="" title="image-20250221150753244"><h4 id="å…¶ä»–ç¼–è¯‘å™¨">å…¶ä»–ç¼–è¯‘å™¨</h4><p>Clang ç¼–è¯‘å™¨æ˜¯ä¸€ä¸ªç”± LLVM é¡¹ç›®å¼€å‘çš„ç¼–è¯‘å™¨ï¼Œæ”¯æŒ Cã€C++ã€Objective-Cå’Œ Swift ç­‰è¯­è¨€ï¼Œå®ƒè¢«è®¾è®¡ä¸ºä¸€ä¸ªç°ä»£ã€é«˜æ•ˆçš„ç¼–è¯‘å™¨ï¼ŒmacOSä½¿ç”¨ Clangä½œä¸ºé»˜è®¤ç¼–è¯‘å™¨</p><h2 id="python-ç¯å¢ƒé…ç½®">Python ç¯å¢ƒé…ç½®</h2><p>ä¹‹å‰æ‰«ç›²è¯¾ä»‹ç»äº†</p><h2 id="å¦‚ä½•å­¦-re">å¦‚ä½•å­¦ reï¼Ÿ</h2><h3 id="åŠ¨æ‰‹å†™ä»£ç ">åŠ¨æ‰‹å†™ä»£ç </h3><p><strong>ä¸€å®šä¸€å®šä¸€å®šè¦è‡ªå·±åŠ¨æ‰‹å†™ä»£ç </strong>ï¼Œé”»ç‚¼ä»£ç èƒ½åŠ›ï¼ŒåŒ…æ‹¬C/C++ã€ Python ä»£ç ï¼Œå®‰å“è¿˜æ¶‰åŠåˆ° Javaã€JavaScripts</p><p>å¦å¤–ï¼Œå¹³æ—¶å¤šç§¯ç´¯ä¸€äº›å¯†ç ç®—æ³•çš„æ¿å­ï¼Œå¦‚ TEA ç³»åˆ—ç®—æ³•ã€RC4 ç®—æ³•ã€AESç®—æ³•ç­‰</p><p><a href="https://gchq.github.io/CyberChef/">CyberChef</a></p><h3 id="å¤šåˆ·é¢˜">å¤šåˆ·é¢˜</h3><p><a href="https://ctf.xidian.edu.cn/">è¥¿ç”µCTFå¹³å°</a>ï¼ˆé‡Œé¢çš„ MoeCTFæ¯”èµ›æ¯”è¾ƒé€‚åˆæ–°ç”Ÿï¼‰</p><p><a href="https://buuoj.cn/">BUUOJ</a></p><p><a href="https://ctf.show/">CTFshow</a></p><p><a href="https://www.nssctf.cn/">NSSCTF</a></p><h3 id="å¤šçœ‹æ–‡ç« ">å¤šçœ‹æ–‡ç« </h3><p><a href="https://www.52pojie.cn/">å¾çˆ±ç ´è§£</a></p><p><a href="https://www.kanxue.com/">çœ‹é›ªè®ºå›</a></p>]]></content>
      
      
      <categories>
          
          <category> reverseç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP-[2025.1è¥¿æ¹–è®ºå‰‘]matrixRSA</title>
      <link href="/2025/02/03/2025%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-matrixRSA/"/>
      <url>/2025/02/03/2025%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-matrixRSA/</url>
      
        <content type="html"><![CDATA[<h1 id="matrixrsa">matrixRSA</h1><h2 id="åˆæ¬¡å¤ç°">åˆæ¬¡å¤ç°</h2><p>æ¯”èµ›çš„æ—¶å€™åœ¨å“ˆå°”æ»¨ğŸ§Šç©ï¼Œé˜Ÿå‹å¤ªç»™åŠ›äº†ï¼Œå·®ç‚¹å¹²è¿›å†³èµ›äº†ğŸ®ï¼Œèµ›åå¤ç°ä¸€ä¸‹</p><p>è¿™æ˜¯ä¸€é“ä¸éš¾çš„ RSAï¼Œç¬¬ä¸€æ®µæ˜¯ä¸€ä¸ªæ³„éœ² <spanclass="math inline">\(p\)</span> é«˜ä½ï¼Œ<spanclass="math inline">\(512\)</span> ä½çš„ <spanclass="math inline">\(p\)</span> æ³„éœ²äº† <spanclass="math inline">\(412\)</span> ä½ï¼Œç»°ç»°æœ‰ä½™ï¼Œå¥—æ¿å­å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line">p4 = <span class="number">9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line"></span><br><span class="line">kbits=pbits - p4.nbits()</span><br><span class="line"><span class="built_in">print</span>(p4.nbits())</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> roots:</span><br><span class="line">    p = p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n/p</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;n:&quot;</span>,n)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;p:&quot;</span>,p)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;q:&quot;</span>,q)</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ®µæ˜¯ä¸€ä¸ªè®ºæ–‡é¢˜ï¼Œ<ahref="https://www.researchtrend.net/ijet/pdf/13%20%20Matrix%20Modification%20of%20RSA%20Public%20Key%20Cryptosystem%20and%20its%20Variant%20Manju%20Sanghi%203513.pdf">è®ºæ–‡é“¾æ¥åœ¨æ­¤</a></p><p>æ ¹æ®è®ºæ–‡ä¸­çš„ç»“è®ºï¼Œè¿™ç§åŸºäºçŸ©é˜µçš„ RSA åœ¨æ±‚ <spanclass="math inline">\(d\)</span> æ—¶ï¼Œ <spanclass="math inline">\(e\)</span> çš„é€†å…ƒæ˜¯åœ¨æ¨¡ <spanclass="math inline">\(N\prime\)</span> æ„ä¹‰ä¸‹çš„ï¼Œ<spanclass="math inline">\(N \prime\)</span> çš„å€¼ä¸º <spanclass="math inline">\((p^h-1)(q^h-1)\)</span>ï¼Œå…¶ä¸­ <spanclass="math inline">\(h\)</span> ä¸ºçŸ©é˜µçš„é˜¶</p><p>ä½†æ˜¯ï¼Œç»è¿‡æµ‹è¯•ï¼Œå®é™…ä¸Šä¸ç®¡çŸ©é˜µçš„é˜¶æ˜¯å¤šå°‘ï¼Œ<spanclass="math inline">\(N \prime\)</span> çš„å€¼å– <spanclass="math inline">\((p^2-1)(q^2-1)\)</span> éƒ½å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ <spanclass="math inline">\(d\)</span>ï¼Œè€Œä¸”ç›®å‰çœ‹åˆ°çš„æ‰€æœ‰wpï¼Œä¸ç®¡æ˜¯å„ä¸ªå¸ˆå‚…çš„ï¼Œè¿˜æ˜¯å®˜æ–¹çš„ï¼Œç”¨çš„éƒ½æ˜¯ <spanclass="math inline">\((p^2-1)(q^2-1)\)</span>ï¼Œä½†è¿™é“é¢˜é‡Œæ˜æ˜æ˜¯ä¸€ä¸ªä¸‰é˜¶çŸ©é˜µï¼ŒæŒ‰ç…§è®ºæ–‡ä¸­çš„ç»“è®ºåº”è¯¥ç”¨<span class="math inline">\((p^3-1)(q^3-1)\)</span>æ‰å¯¹ï¼Œäº‹å®å´æ˜¯é”™çš„ï¼Œè‡³äºåŸå› ï¼Œç°åœ¨è¿˜æ²¡æƒ³æ¸…æ¥š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">d = <span class="built_in">pow</span>(e,-<span class="number">1</span>,(p**<span class="number">2</span>-<span class="number">1</span>)*(q**<span class="number">2</span>-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">C = Matrix(Zmod(n),[[..., ..., ...],</span><br><span class="line">[..., ..., ...],</span><br><span class="line">[..., ..., ...]])</span><br><span class="line"></span><br><span class="line">M = C**<span class="built_in">int</span>(d)</span><br><span class="line"><span class="keyword">for</span> MM <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">for</span> MMM <span class="keyword">in</span> MM:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(MMM)).decode(),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="æ¢ç©¶æ­£ç¡®æ¨¡æ•°">æ¢ç©¶æ­£ç¡®æ¨¡æ•°</h2><p>å®é™…ä¸Šï¼Œåˆšæ‰ä¸Šé¢å¼•ç”¨çš„è®ºæ–‡ä¸­ï¼Œæœ‰æåŠå‰äººå·²æœ‰çš„æˆæœï¼Œè¿™ç¯‡æ–‡ç« ä¹Ÿæ˜¯åœ¨æ­¤åŸºç¡€ä¸Šæ€»ç»“ï¼Œæ¨æµ‹å¯ä»¥ä½¿ç”¨æ¨¡æ•°<spanclass="math inline">\((p^h-1)(q^h-1)\)</span>ï¼Œè€Œå‰äººå·²æœ‰æˆæœä¸­ï¼Œå°±æœ‰å–<span class="math display">\[g=\prod_{i=0}^{h-1}(p^h-p^i)\prod_{i=0}^{h-1}(q^h-q^i)\]</span> <img src="/2025/02/03/2025%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-matrixRSA/image-20250201214230733.png" class=""></p><p>ç»è¿‡æµ‹è¯•ï¼Œä½¿ç”¨è¿™ä¸ª <span class="math inline">\(g\)</span>ä½œä¸ºæ¨¡æ•°ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿå°±æ˜¯åœ¨è¿™é¢˜ä¸­å– <span class="math display">\[d = \mathrm{pow}(e,-1,(p^3-p^2)(p^3-p)(p^3-1)(q^3-q^2)(q^3-q)(q^3-1))\]</span> ä¹Ÿæ˜¯å¯ä»¥å¾—åˆ°æ­£ç¡®çš„ <span class="math inline">\(d\)</span>çš„</p><p>è€Œä¸Šé¢æåˆ°çš„è¿™ä¸ªç»“è®ºï¼Œä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­æ¡†å‡ºçš„ Andrew Pangia æå‡ºçš„ç»“è®ºï¼Œ<ahref="https://www.gcsu.edu/sites/files/page-assets/node-808/attachments/pangia.pdf">è®ºæ–‡é“¾æ¥åœ¨æ­¤</a>ï¼Œæ–‡ç« ä¸­å¯¹ç»“è®ºåœ¨<span class="math inline">\(h=2\)</span>çš„æƒ…å†µæ—¶åšäº†è¯æ˜ï¼Œä¸‹é¢åšä¸€ä¸ªç®€å•æ•´ç†</p><h3 id="è¯æ˜è¿‡ç¨‹">è¯æ˜è¿‡ç¨‹</h3><p>é¦–å…ˆæ ¹æ®ä¸€èˆ¬çº¿æ€§ç¾¤çš„æ€§è´¨ï¼Œæœ‰ç¾¤ <spanclass="math inline">\(GF_2(\mathbb{Z_p})\)</span> çš„é˜¶ä¸º <spanclass="math display">\[g_p=(p^2-p)(p^2-1)\]</span> åŒç†ï¼Œç¾¤ <spanclass="math inline">\(GF_2(\mathbb{Z_q})\)</span> çš„é˜¶ä¸º <spanclass="math display">\[g_q=(q^2-q)(q^2-1)\]</span> é‡‡ç”¨çš„æ¨¡æ•° <span class="math display">\[g=g_pg_q\]</span> å³ <span class="math display">\[ed\equiv1\bmod g\]</span> å³ <span class="math display">\[ed=1+kg,k\in\mathbb{Z}\]</span> æ•… <span class="math display">\[\begin{aligned}C^d&amp;=M^{ed}\bmod n\\&amp;=M^{1+kg}\bmod n\\&amp;=M\cdot M^{kg_pg_q}\bmod p\\&amp;=M\cdot ((M^{g_p})^{g_q})^k\bmod p\\\end{aligned}\]</span> ç”±äºæ˜æ–‡çŸ©é˜µ <span class="math inline">\(\langleM\rangle\)</span> æ˜¯ <spanclass="math inline">\(GF_2(\mathbb{Z_q})\)</span>çš„å­ç¾¤ï¼Œç”±æ‹‰æ ¼æœ—æ—¥å®šç†ï¼Œç¾¤ <span class="math inline">\(\langleM\rangle\)</span> çš„é˜¶çš„æ˜¯ç¾¤ <spanclass="math inline">\(GF_2(\mathbb{Z_q})\)</span> çš„é˜¶çš„å› å­ï¼Œè®¾ä¸º <spanclass="math inline">\(x\)</span>ï¼Œå³æœ‰ <span class="math display">\[g_p=jx,j\in\mathbb{Z}\]</span> æ•… <span class="math display">\[\begin{aligned}C^d&amp;=M\cdot ((M^{g_p})^{g_q})^k\bmod p\\&amp;=M\cdot ((M^{jx})^{g_q})^k\bmod p\\&amp;=M\cdot ((M^{x})^{jg_q})^k\bmod p\\&amp;=M\cdot I^{jg_qk}\bmod p\\&amp;=M\bmod p\\\end{aligned}\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(I\)</span> ä¸ºå•ä½çŸ©é˜µï¼Œå› ä¸º<span class="math inline">\(x\)</span> æ˜¯ç¾¤ <spanclass="math inline">\(\langle M\rangle\)</span> çš„é˜¶</p><blockquote><p>éœ€è¦æ³¨æ„è¿™é‡Œå¾—åˆ° <span class="math inline">\(M^x=I\)</span> éœ€è¦åœ¨<span class="math inline">\(\mathbb{Z_p}\)</span>ä¸‹æ‰èƒ½æˆç«‹ï¼Œè¿™æ˜¯ä¸€èˆ¬çº¿æ€§ç¾¤çš„å®šä¹‰è¦æ±‚çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢ä»<spanclass="math inline">\(\bmod n\)</span> å˜æˆäº†<spanclass="math inline">\(\bmod p\)</span></p></blockquote><p>åŒç†ï¼Œè¿˜å¯ä»¥å¾—åˆ° <span class="math display">\[C^d=M\bmod q\\\]</span> æ•… <span class="math display">\[C^d=M\bmod n\\\]</span> è¯æ˜å®Œæ¯•</p><h3 id="æ¨å¹¿">æ¨å¹¿</h3><p>å¯ä»¥çœ‹åˆ°ï¼Œä»¥ä¸Šè¯æ˜è¿‡ç¨‹ï¼Œä¸æ‰€æ¶‰åŠçš„ä¸€èˆ¬çº¿æ€§ç¾¤çš„é˜¶çš„å€¼ <spanclass="math inline">\(g_p,g_q\)</span>å¹¶æ— ç›´æ¥å…³ç³»ï¼Œå› æ­¤å¯ä»¥å°†ç»“è®ºæ¨å¹¿è‡³é«˜é˜¶ï¼Œå³ <spanclass="math inline">\(h\)</span> é˜¶çš„åŸºäºçŸ©é˜µçš„ RSA åŠ å¯†ï¼Œåœ¨æ±‚ <spanclass="math inline">\(d\)</span> æ—¶æ‰€ç”¨çš„æ¨¡æ•°ä¸º <spanclass="math display">\[\begin{aligned}g&amp;=g_pg_q\\&amp;=\prod_{i=0}^{h-1}(p^h-p^i)\prod_{i=0}^{h-1}(q^h-q^i)\end{aligned}\]</span> åŒæ ·ï¼Œå½“ <span class="math inline">\(h\)</span> å– <spanclass="math inline">\(1\)</span> çš„æ—¶å€™ï¼Œ<spanclass="math inline">\(g\)</span> çš„å€¼å°±æ˜¯ <spanclass="math inline">\((p-1)(q-1)\)</span>ï¼Œä¹Ÿå°±æ˜¯æ­£å¸¸ RSA çš„ <spanclass="math inline">\(\varphi\)</span> å€¼ï¼Œå› ä¸º <spanclass="math inline">\(h\)</span> å– <spanclass="math inline">\(1\)</span> çš„æ—¶å€™ï¼Œæ˜¯ä¸€ä¸ª <spanclass="math inline">\(1\times1\)</span>çš„çŸ©é˜µï¼Œä¹Ÿå°±ç›¸å½“äºæ²¡æœ‰çŸ©é˜µï¼Œæ˜¯ä¸€ä¸ªæ­£å¸¸çš„ RSA</p><h3 id="æ–°-wp">æ–° wp</h3><p>ä¿®æ”¹åçš„ wp å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">gp = (p**<span class="number">3</span>-p**<span class="number">2</span>)*(p**<span class="number">3</span>-p)*(p**<span class="number">3</span>-<span class="number">1</span>)</span><br><span class="line">gq = (q**<span class="number">3</span>-q**<span class="number">2</span>)*(q**<span class="number">3</span>-q)*(q**<span class="number">3</span>-<span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e,-<span class="number">1</span>,gp*gq)</span><br><span class="line"></span><br><span class="line">C = Matrix(Zmod(n),[[..., ..., ...],</span><br><span class="line">[..., ..., ...],</span><br><span class="line">[..., ..., ...]])</span><br><span class="line"></span><br><span class="line">M = C**<span class="built_in">int</span>(d)</span><br><span class="line"><span class="keyword">for</span> MM <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">for</span> MMM <span class="keyword">in</span> MM:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(MMM)).decode(),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="ä»å­˜åœ¨çš„é—®é¢˜">ä»å­˜åœ¨çš„é—®é¢˜</h3><p>ç›®å‰ä¸ºæ­¢ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆç”¨è¿™ä¸ª <spanclass="math inline">\(d\)</span> ä¹Ÿå¯ä»¥ <span class="math display">\[d = \mathrm{pow}(e,-1,(p^2-p)(p^2-1)(q^2-q)(q^2-1))\]</span> ç”¨è¿™ä¸ª <span class="math inline">\(d\)</span>ä¹Ÿå¯ä»¥æ¢å¤å‡ºä¸€æ ·çš„æ˜æ–‡çŸ©é˜µ <span class="math inline">\(M\)</span></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> RSA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP-[2025.1è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›]happylock</title>
      <link href="/2025/01/14/2025%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E8%B5%9B-happylock/"/>
      <url>/2025/01/14/2025%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E8%B5%9B-happylock/</url>
      
        <content type="html"><![CDATA[<h1 id="happylock">HappyLock</h1><p>æ¯”èµ›çš„æ—¶å€™å†™äº†å¥½ä¹…ï¼Œå¯æƒœè¿˜æ˜¯å·®ä¸€äº›ï¼Œæ²¡æœ‰å†™å‡ºæ¥...</p><h2 id="èµ›ä¸­è¿›åº¦">èµ›ä¸­è¿›åº¦</h2><p>æ¨¡æ‹Ÿå™¨é‡Œè¿è¡Œä¸€ä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªæ‰‹åŠ¿å¯†ç éªŒè¯ç¨‹åºï¼Œé€šè¿‡è¾“å…¥æ­£ç¡®æ‰‹åŠ¿å¯†ç å¾—åˆ°ä¸€ä¸ªå“ˆå¸Œå€¼ä½œä¸º<code>flag</code></p><h3 id="æ¡†æ¶oncompleteæ–¹æ³•">æ¡†æ¶<code>oncomplete</code>æ–¹æ³•</h3><p>jadxåç¼–è¯‘ï¼Œæ ¸å¿ƒåœ¨<code>com.crackme.happylock.MainActivity</code>ç±»çš„<code>oncomplete</code>æ–¹æ³•ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•å®ç°äº†å°†ç”¨æˆ·è¾“å…¥çš„æ‰‹åŠ¿å¯†ç è¿›è¡Œç¼–ç åŠ å¯†å¤„ç†ä»¥åŠä¸é¢„è®¾å€¼è¿›è¡Œå¯¹æ¯”</p><p><img src="image-20250111111423716.png" /></p><p>è§£æå¦‚ä¸‹ï¼Œå…¶ä¸­<code>StringObf.decode</code>æ–¹æ³•å°±æ˜¯ base64 è§£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span> <span class="comment">// com.andrognito.patternlockview.listener.PatternLockViewListener</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onComplete</span><span class="params">(List&lt;PatternLockView.Dot&gt; list)</span> &#123;</span><br><span class="line">    <span class="type">MainActivity</span> <span class="variable">$r2</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">    <span class="type">PatternLockView</span> <span class="variable">$r3</span> <span class="operator">=</span> $r2.mPatternLockView;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">$r4</span> <span class="operator">=</span> PatternLockUtils.enc($r3, list); <span class="comment">// å°†ç”¨æˆ·ç»˜åˆ¶çš„å›¾æ¡ˆè¿›è¡ŒåŠ å¯†</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">$z0</span> <span class="operator">=</span> Utils.cmp($r4); <span class="comment">// æ¯”è¾ƒåŠ å¯†åçš„å›¾æ¡ˆå’Œé¢„è®¾çš„å›¾æ¡ˆ</span></span><br><span class="line">        <span class="keyword">if</span> (!$z0) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå›¾æ¡ˆä¸åŒ¹é…</span></span><br><span class="line">            <span class="type">MainActivity</span> <span class="variable">$r22</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">            <span class="type">PatternLockView</span> <span class="variable">$r32</span> <span class="operator">=</span> $r22.mPatternLockView;</span><br><span class="line">            $r32.setViewMode(<span class="number">2</span>); <span class="comment">// è®¾ç½®å›¾æ¡ˆé”ä¸ºé”™è¯¯æ¨¡å¼ï¼ˆæ˜¾ç¤ºé”™è¯¯æç¤ºï¼‰</span></span><br><span class="line">            <span class="type">MainActivity</span> <span class="variable">$r23</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">            <span class="type">Context</span> <span class="variable">$r5</span> <span class="operator">=</span> $r23.context;</span><br><span class="line">            <span class="type">Toast</span> <span class="variable">$r8</span> <span class="operator">=</span> Toast.makeText($r5, StringObf.decode(<span class="string">&quot;VHJ5IGFnYWlu&quot;</span>), <span class="number">0</span>); <span class="comment">// è§£å¯†æç¤ºä¿¡æ¯ï¼Œbase64è§£ç ä¸º&quot;Try again&quot;</span></span><br><span class="line">            $r8.show(); <span class="comment">// æ˜¾ç¤ºæç¤ºä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœå›¾æ¡ˆåŒ¹é…</span></span><br><span class="line">        <span class="type">MainActivity</span> <span class="variable">$r24</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">        <span class="type">PatternLockView</span> <span class="variable">$r33</span> <span class="operator">=</span> $r24.mPatternLockView;</span><br><span class="line">        $r33.setViewMode(<span class="number">0</span>); <span class="comment">// è®¾ç½®å›¾æ¡ˆé”ä¸ºæ­£å¸¸æ¨¡å¼ï¼ˆæ˜¾ç¤ºæˆåŠŸæç¤ºï¼‰</span></span><br><span class="line">        <span class="type">MainActivity</span> <span class="variable">$r25</span> <span class="operator">=</span> MainActivity.<span class="built_in">this</span>;</span><br><span class="line">        <span class="type">Context</span> <span class="variable">$r52</span> <span class="operator">=</span> $r25.context;</span><br><span class="line">        <span class="type">String</span> <span class="variable">$r7</span> <span class="operator">=</span> StringObf.decode(<span class="string">&quot;U3VibWl0IGRhcnR7&quot;</span>); <span class="comment">// è§£å¯†æˆåŠŸæç¤ºçš„å­—ç¬¦ä¸²ï¼Œbase64è§£ç ä¸º&quot;Submit dart&#123;&quot;</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">$r6</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>($r7);</span><br><span class="line">        <span class="type">Toast</span> <span class="variable">$r82</span> <span class="operator">=</span> Toast.makeText($r52, $r6.append($r4).append(StringObf.decode(<span class="string">&quot;fQ==&quot;</span>)).toString(), <span class="number">1</span>); <span class="comment">// æ˜¾ç¤ºåŒ…å«åŠ å¯†å›¾æ¡ˆçš„æç¤ºä¿¡æ¯ï¼Œbase64è§£ç ä¸º&quot;&#125;&quot;</span></span><br><span class="line">        $r82.show(); <span class="comment">// æ˜¾ç¤ºæç¤º</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (UnsupportedEncodingException | NoSuchAlgorithmException $r9) &#123;</span><br><span class="line">        <span class="comment">// å¼‚å¸¸å¤„ç†</span></span><br><span class="line">        <span class="type">RuntimeException</span> <span class="variable">$r10</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>($r9);</span><br><span class="line">        <span class="keyword">throw</span> $r10; <span class="comment">// æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè°ƒç”¨<code>PatternLockUtils.enc</code>æ–¹æ³•å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œè°ƒç”¨<code>Utils.cmp</code>æ–¹æ³•æ¯”è¾ƒåŠ å¯†åçš„å›¾æ¡ˆå’Œé¢„è®¾çš„å›¾æ¡ˆï¼Œæ­£ç¡®ä¼šå°†ç»“æœç”¨<code>Submit dart&#123;&#125;</code>åŒ…è£¹èµ·æ¥æ˜¾ç¤ºï¼Œé”™è¯¯ä¼šæ˜¾ç¤º<code>Try again</code></p><h3 id="hookutils.cmpæ–¹æ³•">Hook<code>Utils.cmp</code>æ–¹æ³•</h3><p>äºæ˜¯å…ˆå°è¯•ç›´æ¥åœ¨<code>onComplete</code>é‡Œhookæ¯”è¾ƒå‡½æ•°<code>Utils.cmp</code>ï¼Œå°†è¿”å›å€¼ä¿®æ”¹ä¸ºæ­£ç¡®ï¼Œçœ‹ä¸€ä¸‹åŠ å¯†ç»“æœçš„æ ¼å¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookUtilsCmp</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable constant_">C06201</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.crackme.happylock.MainActivity$1&quot;</span>);</span><br><span class="line">    <span class="variable constant_">C06201</span>[<span class="string">&quot;onComplete&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">list</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">Utils</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.crackme.happylock.Utils&quot;</span>);</span><br><span class="line">        <span class="title class_">Utils</span>.<span class="property">cmp</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Original input string: <span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="variable language_">this</span>[<span class="string">&quot;onComplete&quot;</span>](list);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">hookUtilsCmp</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p>ä¸å‡ºæ‰€æ–™ï¼Œç»“æœæ˜¯ä¸€ä¸ª40ä½åå…­è¿›åˆ¶çš„å“ˆå¸Œå€¼ï¼Œå¯èƒ½æ˜¯<code>SHA-1</code>åšçš„å“ˆå¸Œ</p><p><img src="image-20250111124414814.png" /></p><p>åŒæ—¶ï¼Œå®‰å“ç«¯ä¹Ÿæ˜¾ç¤ºäº†åŠ å¯†ç»“æœ</p><p><img src="image-20250111124802874.png" /></p><p>ä½†æ˜¯ä¸Šé¢çš„ä»£ç ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ç»•è¿‡äº†<code>cmp</code>çš„æ£€éªŒï¼Œè¿™é‡Œæ˜¾ç¤ºçš„å“ˆå¸Œå€¼è¿˜æ˜¯æˆ‘ä»¬éšæœºè¾“å…¥çš„æ‰‹åŠ¿å¯†ç çš„ç»“æœï¼Œå¹¶ä¸æ˜¯ç›®æ ‡å¯†ç çš„ç»“æœ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Toast</span> <span class="variable">$r82</span> <span class="operator">=</span> Toast.makeText($r52, $r6.append($r4).append(StringObf.decode(<span class="string">&quot;fQ==&quot;</span>)).toString(), <span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆå°±è¦å»çœ‹<code>Utils.cmp</code>æ–¹æ³•çš„å…·ä½“å®ç°äº†</p><p><img src="image-20250111132922994.png" /></p><p>ä¸»è¦å®ç°çš„æ˜¯åå°„è°ƒç”¨<code>clz.cmp</code>æ–¹æ³•</p><h3 id="åå°„è°ƒç”¨clz.cmpæ–¹æ³•">åå°„è°ƒç”¨<code>clz.cmp</code>æ–¹æ³•</h3><p>äºæ˜¯hookæŸ¥çœ‹ä¸€ä¸‹åå°„è°ƒç”¨çš„<code>clz</code>çš„å…·ä½“ä¿¡æ¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookUtilsCmp</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="title class_">Utils</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.crackme.happylock.Utils&quot;</span>);</span><br><span class="line">    <span class="title class_">Utils</span>[<span class="string">&quot;cmp&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Utils.cmp is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">var</span> clz = <span class="variable language_">this</span>.<span class="property">clz</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Reflection will invoke method in class: &quot;</span> + clz);</span><br><span class="line">        <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;cmp&quot;</span>](str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Utils.cmp result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">hookUtilsCmp</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ—¶å€™ç¨‹åºè¿è¡Œå´©æºƒäº†ï¼Œæ‰“å°äº†<code>clz</code>çš„ç›¸å…³ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°<code>clz</code>å®é™…ä¸Šæ˜¯ä¸€ä¸ª<code>Java.Field</code>ç±»å‹å¯¹è±¡ï¼Œå®ƒçš„<code>value</code>å±æ€§æ˜¯ä¸€ä¸ªåä¸º<code>com.crackme.happylock.Check</code>çš„ç±»ï¼Œæ¯”è¾ƒå¯ç–‘</p><p><img src="image-20250111140600164.png" /></p><p>äºæ˜¯æˆ‘ä»¬é€šè¿‡<code>clz.value</code>æ¥è®¿é—®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookUtilsCmp</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="title class_">Utils</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.crackme.happylock.Utils&quot;</span>);</span><br><span class="line">    <span class="title class_">Utils</span>[<span class="string">&quot;cmp&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Utils.cmp is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">var</span> clz = <span class="variable language_">this</span>.<span class="property">clz</span>.<span class="property">value</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Reflection will invoke method in class: &quot;</span> + clz);</span><br><span class="line">        <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;cmp&quot;</span>](str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Utils.cmp result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">hookUtilsCmp</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p>é—æ†¾çš„æ˜¯è™½ç„¶ <code>clz</code> è¢«æˆåŠŸè·å–ä¸º<code>class com.crackme.happylock.Check</code>ï¼Œä½†æ˜¯å´©æºƒä»ç„¶å‘ç”Ÿï¼Œåç»­è¿˜æ¢äº†å„ç§æ–¹æ³•ï¼Œè¿˜æ˜¯ä¸€ç›´å´©æºƒ</p><p><img src="image-20250111142509017.png" /></p><p>åŒæ—¶æ³¨æ„åˆ°ï¼Œå…¶å® jadxä¸­å¹¶æ²¡æœ‰<code>com.crackme.happylock.Check</code>ç±»ï¼Œå¯èƒ½æ˜¯åŠ¨æ€åŠ è½½çš„</p><h3 id="åŠ¨æ€åŠ è½½checkç±»">åŠ¨æ€åŠ è½½<code>Check</code>ç±»</h3><p>å…ˆå°è¯•ä¸€ä¸‹ç”¨<code>java.use()</code>å¼ºåˆ¶åŠ è½½</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookUtilsCmp</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="title class_">Utils</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.crackme.happylock.Utils&quot;</span>);</span><br><span class="line">    <span class="title class_">Utils</span>[<span class="string">&quot;cmp&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Utils.cmp is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">var</span> clz = <span class="variable language_">this</span>.<span class="property">clz</span>.<span class="property">value</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Reflection will invoke method in class: &quot;</span> + clz);</span><br><span class="line">        <span class="keyword">let</span> check = <span class="title class_">Java</span>.<span class="title function_">use</span>(clz.<span class="title function_">getName</span>());</span><br><span class="line">        <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;cmp&quot;</span>](str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Utils.cmp result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">hookUtilsCmp</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p>æœç„¶ä¸è¡Œï¼Œåº”è¯¥å°±æ˜¯åŠ¨æ€åŠ è½½çš„</p><p><img src="image-20250111162631704.png" /></p><p>åŒæ—¶è§‚å¯Ÿåˆ°<code>com.crackme.happylock.Utils</code>é‡Œæœ‰ä¸€ä¸ª<code>loadclass</code>æ–¹æ³•ï¼ŒçŒœæµ‹<code>Check</code>ç±»æ˜¯ç”±å®ƒåŠ è½½çš„ï¼Œä½†æ˜¯jadx å¹¶æ²¡æœ‰æŠŠå®ƒåç¼–è¯‘å‡ºæ¥ï¼Œæ²¡æ³•çœ‹åˆ°å®ƒçš„å…·ä½“å®ç°</p><p><img src="image-20250111173046052.png" /></p><p>hookæ£€æŸ¥ä¸€ä¸‹å®ƒæ˜¯å¦è°ƒç”¨äº† <code>DexClassLoader</code>æˆ–å…¶ä»–ç±»ä¼¼çš„ç±»åŠ è½½å™¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookDexClassLoader</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">DexClassLoader</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;dalvik.system.DexClassLoader&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Hook DexClassLoader çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="title class_">DexClassLoader</span>.<span class="property">$init</span>.<span class="title function_">overload</span>(</span><br><span class="line">        <span class="string">&quot;java.lang.String&quot;</span>,</span><br><span class="line">        <span class="string">&quot;java.lang.String&quot;</span>,</span><br><span class="line">        <span class="string">&quot;java.lang.String&quot;</span>,</span><br><span class="line">        <span class="string">&quot;java.lang.ClassLoader&quot;</span></span><br><span class="line">    ).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">dexPath, optimizedDirectory, librarySearchPath, parent</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DexClassLoader initialized:&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;  dexPath: &quot;</span> + dexPath);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;  optimizedDirectory: &quot;</span> + optimizedDirectory);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;  librarySearchPath: &quot;</span> + librarySearchPath);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;  parent: &quot;</span> + parent);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.$init(dexPath, optimizedDirectory, librarySearchPath, parent);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Hook loadClass æ–¹æ³•</span></span><br><span class="line">    <span class="title class_">DexClassLoader</span>.<span class="property">loadClass</span>.<span class="title function_">overload</span>(<span class="string">&quot;java.lang.String&quot;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">className</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DexClassLoader.loadClass called for class: &quot;</span> + className);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">loadClass</span>(className);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="title function_">hookDexClassLoader</span>(); <span class="comment">// Hook DexClassLoader</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>Check</code>ç±»çš„åŠ è½½ç¡®å®è°ƒç”¨äº†<code>DexClassLoader.loadClass</code>æ–¹æ³•ï¼Œè€Œä¸”åœ¨ä¸‹é¢è¿˜çœ‹åˆ°äº†<code>SHA-1</code>å­—æ ·ï¼ŒéªŒè¯äº†ä¹‹å‰çš„çŒœæµ‹ï¼Œæ‰‹åŠ¿å¯†ç åŠ å¯†ç¼–ç ä¹‹åæ˜¯ç”¨<code>SHA-1</code>åšå“ˆå¸Œçš„</p><p><img src="image-20250111181557996.png" /></p><p>æˆ‘èµ›ä¸­çš„è¿›åº¦å°±è‡³æ­¤äº†ï¼Œåé¢ä¸€ç›´åœ¨æ£é¼“åå°„çš„äº‹æƒ…ï¼Œå†åˆ°åé¢è¿˜å°è¯•äº†å…¨å±€æ‰«æ<code>SHA-1</code>å“ˆå¸Œç®—æ³•çš„è°ƒç”¨æƒ…å†µï¼Œè¯•å›¾æ‰«åˆ°ç›®æ ‡æ‰‹åŠ¿å¯†ç ç¼–ç ååšå“ˆå¸Œçš„è¿‡ç¨‹ï¼Œéƒ½å¤±è´¥äº†...</p><p>è€Œä¸”ï¼Œå…¶å®gptå½“æ—¶ç»™äº†æˆ‘æ­£ç¡®è§£æ³•ï¼Œä½†æˆ‘ä¸€ç›´å¿½ç•¥äº†ï¼Œåœ¨çº ç»“åå°„ã€è‡ªå·±çš„<code>loadclass</code>æ–¹æ³•ä»€ä¹ˆçš„...</p><h2 id="èµ›åå¤ç°">èµ›åå¤ç°</h2><h3 id="dumpclasses.dex">dump<code>classes.dex</code></h3><p>æ­£ç¡®è§£æ³•å°±æ˜¯å» dumpè¿è¡Œæ—¶çš„<code>dex</code>æ–‡ä»¶<code>classes.dex</code>ï¼Œè¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªæ–°å·¥å…·<code>GDA</code>ï¼Œå…·ä½“çš„ä»‹ç»è§<ahref="https://zhuanlan.zhihu.com/p/28354064">ä½œè€…çŸ¥ä¹</a></p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯å…ˆå°†<code>Gdump</code>pushåˆ°å®‰å“ç«¯ï¼ŒåŒæ—¶å°†<code>GDA</code>çš„<code>adb</code>ç¯å¢ƒå˜é‡æ”¾åœ¨æ¨¡æ‹Ÿå™¨<code>adb</code>ç¯å¢ƒå˜é‡ä¹‹ä¸Š</p></blockquote><p>æ‰“å¼€ GDAï¼Œç‚¹å‡»å¯¼èˆªæ å®‰å“å›¾æ ‡çš„ dumpåŠŸèƒ½æ‰“å¼€<code>GDA Device Dumper</code>ï¼Œåœ¨å·¦ä¾§é€‰æ‹©<code>com.crackme.happylock</code>è¿›ç¨‹ï¼Œå³ä¾§ç­›é€‰<code>DEX</code>æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°<code>/data/data/com.crackme.happylock/files/classes.dex</code>ï¼Œå³é”®<code>Dump Module</code>å³å¯</p><blockquote><p>ä¸€å¼€å§‹æˆ‘ä¹Ÿä¸€ç›´ dumpä¸å‡ºæ¥ï¼Œåªèƒ½è¯´å¤šè¯•å‡ æ¬¡ï¼Œé‡å¯ä¸€ä¸‹ä¹‹ç±»çš„å°±å¯ä»¥äº†ï¼Œæˆ–è€…å°±æ˜¯ GDA çš„Gdumpã€adb æ²¡æœ‰é…å¥½ï¼Œå°±æ˜¯æˆ‘ä¸Šé¢è¯´çš„</p></blockquote><p><img src="image-20250112115020163.png" /></p><p>ä¹Ÿå¯ä»¥å…¨å±€æŸ¥æ‰¾ï¼Œæ˜¾ç¤ºäº† PIDã€åœ°å€èŒƒå›´ç­‰ä¿¡æ¯</p><p><img src="image-20250112115336327.png" /></p><p>ä¹Ÿå¯ä»¥åœ¨ä¸‹æ–¹è¾“å…¥è¦ dump çš„æ–‡ä»¶çš„ PIDã€start_addr å’Œ size</p><p><img src="image-20250112115435981.png" /></p><p>dump å‡ºæ¥çš„æ–‡ä»¶åœ¨<code>GDA.exe</code>çš„åŒçº§ç›®å½•ä¸‹ï¼Œæ‹–åˆ° jadxé‡Œåˆ†æï¼Œä½†æ˜¯æŠ¥é”™äº†</p><p>æ—¥å¿—æ˜¾ç¤ºé”™è¯¯ä¸º<code>Bad checksum</code>ï¼Œçœ‹å¤§ä½¬çš„è§£é‡Šæ˜¯ hookä¹‹åå¡«å……å­—èŠ‚æ”¹å˜äº†<code>sum</code>å€¼</p><p><img src="image-20250112124255770.png" /></p><p>ä¿®æ”¹ dump å‡ºæ¥çš„<code>classes.dex</code>çš„<code>sum</code>å€¼å³å¯</p><p><img src="image-20250112125902731.png" /></p><p>ä½†æ˜¯ jadx è¿˜æ˜¯åç¼–è¯‘å¤±è´¥äº†</p><p><img src="image-20250112144514538.png" /></p><p>åŒæ ·ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æ‹–åˆ° GDA é‡Œé¢åˆ†æï¼Œä½†ä»ç„¶åç¼–è¯‘ä¸å‡ºæ¥ä»€ä¹ˆä¸œè¥¿</p><p><img src="image-20250112145233210.png" /></p><p>åœ¨å­¦ä¹ å¤§ä½¬å†™çš„æ–‡ç« å¤ç°çš„æ—¶å€™ï¼Œè¿˜çœ‹åˆ°äº†ä¸€ä¸ª<code>frida-dump</code>çš„<ahref="\https://github.com/lasting-yang/frida_dump">è„šæœ¬åº“</a>ï¼Œåœ¨è¿™é‡Œè·‘å‡ºæ¥çš„ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„</p><p>æ ¹æ®å‚è€ƒçš„ä¸¤ç¯‡æ–‡ç« ï¼Œè¿™é‡Œæ˜¯å­—èŠ‚ç æœ‰é—®é¢˜ï¼Œä»£ç è¢«æŠ½å–ï¼Œè¿™é“é¢˜å®é™…ä¸Šå°±æ˜¯ç”¨ShadowHook å®ç°ç±»æŠ½å–</p><h3 id="ä¿®å¤classes.dex">ä¿®å¤<code>classes.dex</code></h3><p>Java å±‚å¡ä½äº†ï¼Œå°±è¦å» Native å±‚çœ‹ä¸€ä¸‹äº†</p><p><img src="image-20250112164750262.png" /></p><p>ida åˆ†æ libhappylock.so æ–‡ä»¶ï¼ˆä¸å¾—ä¸è¯´ ida9.0 ç¡®å®å¥½ç”¨ï¼Œ8.3 æ²¡æœ‰armã€mips ä»€ä¹ˆçš„åç¼–è¯‘å™¨ï¼Œè¿˜å¾—å»ç”¨ 7.7 åç¼–è¯‘ï¼Œç°åœ¨ 9.0éƒ½æœ‰äº†ï¼Œå®šä½åˆ°<code>JNI_OnLoad</code>å‡½æ•°</p><p><img src="image-20250114110829013.png" /></p><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<code>JNI_OnLoad</code>å‡½æ•°é‡Œä¼šæœ‰æœ¬åœ°æ–¹æ³•æ³¨å†Œ<code>RegisterNatives</code>ï¼Œä½†è¿™é‡Œå¹¶æ²¡æœ‰</p><p>åˆ°è¿™é‡Œï¼Œå¯¹äº<code>JNI_OnLoad</code>å‡½æ•°çš„åˆ†æï¼Œæˆ‘å‚è€ƒçš„ä¸¤ç¯‡å¤§ä½¬çš„æ–‡ç« ç”¨äº†ä¸ä¸€æ ·çš„æ–¹æ³•ï¼Œæˆ‘è¿™é‡Œå°±å¤ç°äº†ä¸€ç§</p><h4 id="ä½¿ç”¨bindiffæ¢å¤ç¬¦å·">ä½¿ç”¨<code>Bindiff</code>æ¢å¤ç¬¦å·</h4><blockquote><p>è‡³äºæ€ä¹ˆçœ‹å‡ºæ¥æ˜¯ ShadowHook çš„ï¼Œæˆ‘å°±ä¸çŸ¥é“äº†...</p></blockquote><p>ShadowHook æ˜¯å­—èŠ‚è·³åŠ¨çš„ä¸€ä¸ª<ahref="https://github.com/bytedance/android-inline-hook">å¼€æº inline hookæ¡†æ¶</a></p><p>äºæ˜¯ä¸‹è½½æŠ–éŸ³ apkï¼Œæå–<code>libshadowhook.so</code>æ–‡ä»¶ï¼Œç”¨ idaæ‰“å¼€ï¼Œä¿å­˜å¾—åˆ° i64 æ–‡ä»¶ï¼Œidaæ‰“å¼€<code>libhappylock.so</code>æ–‡ä»¶ï¼Œctrl+6è°ƒç”¨<code>bindiff</code>ï¼Œé€‰æ‹© DiffDatabaseï¼Œé€‰æ‹©<code>libshadowhook.so</code>çš„ i64 æ–‡ä»¶</p><blockquote><p>éœ€è¦æ³¨æ„<code>Bindiff</code>ä¸æ”¯æŒä¸­æ–‡è·¯å¾„ï¼Œæ‰€é€‰æ‹©çš„ i64æ–‡ä»¶è·¯å¾„ä¸è¦æœ‰ä¸­æ–‡ï¼Œä¹Ÿä¸è¦æœ‰é™¤ä¸‹åˆ’çº¿å¤–çš„ç‰¹æ®Šç¬¦å·</p></blockquote><p><img src="image-20250114154737249.png" /></p><p>åœ¨ Matched Functions çª—å£ä¸­é€‰ä¸­æ‰€æœ‰åŒ¹é…çš„å‡½æ•°ç¬¦å·</p><p><img src="image-20250114154710365.png" /></p><p>å³é”®ç‚¹å‡» Import symbols/comments å³å¯æ¢å¤åŒ¹é…çš„ç¬¦å·</p><p><img src="image-20250114155102195.png" /></p><p>å¯ä»¥çœ‹åˆ°ï¼Œç¡®å®æœ‰å¤§é‡ ShadowHookç›¸å…³å‡½æ•°ï¼Œè€Œä¸”<code>JNI_OnLoad</code>å‡½æ•°ä¸­å°±æœ‰è°ƒç”¨</p><p><img src="image-20250114160155875.png" /></p><h4 id="shadowhook-åˆ†æ">ShadowHook åˆ†æ</h4><p>å…¶ä¸­ï¼Œç”±äºæœ‰ç¬¦å·ä¿¡æ¯ï¼Œ<code>shadowhook_hook_func_addr</code>å‡½æ•°å°±æ˜¯è°ƒç”¨<code>shadowhook_hook_sym_name</code>å‡½æ•°</p><p><img src="image-20250114160541263.png" /></p><p>å‚è€ƒ<ahref="https://github.com/bytedance/android-inline-hook/blob/main/doc/manual.zh-CN.md">ShadowHookæ‰‹å†Œ</a>ï¼ŒShadowHook æ”¯æŒé€šè¿‡â€œå‡½æ•°åœ°å€â€æˆ–â€œåº“å + å‡½æ•°åâ€æŒ‡å®š hookä½ç½®</p><p>å‚è€ƒæ‰‹å†Œï¼Œ<code>shadowhook_hook_sym_name</code>å‡½æ•°å£°æ˜å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;shadowhook.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> *<span class="title">shadowhook_hook_sym_name</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *lib_name, <span class="type">const</span> <span class="type">char</span> *sym_name, <span class="type">void</span> *new_addr, <span class="type">void</span> **orig_addr)</span></span>;s</span><br></pre></td></tr></table></figure><p>å‚æ•°</p><ul><li><code>lib_name</code>ï¼ˆå¿…é¡»æŒ‡å®šï¼‰ï¼šéœ€è¦è¢« hook çš„å‡½æ•°æ‰€åœ¨çš„åº“å</li><li><code>sym_addr</code>ï¼ˆå¿…é¡»æŒ‡å®šï¼‰ï¼šéœ€è¦è¢« hook çš„å‡½æ•°çš„ç¬¦å·å</li><li><code>new_addr</code>ï¼ˆå¿…é¡»æŒ‡å®šï¼‰ï¼šæ–°å‡½æ•°ï¼ˆproxyå‡½æ•°ï¼‰çš„ç»å¯¹åœ°å€</li><li><code>orig_addr</code>ï¼ˆä¸éœ€è¦çš„è¯å¯ä¼ <code>NULL</code>ï¼‰ï¼šè¿”å›åŸå‡½æ•°åœ°å€</li></ul><p>è¿™ç§æ–¹å¼å¯ä»¥ hook â€œå½“å‰å·²åŠ è½½åˆ°è¿›ç¨‹ä¸­çš„åŠ¨æ€åº“â€ï¼Œä¹Ÿå¯ä»¥ hookâ€œè¿˜æ²¡æœ‰åŠ è½½åˆ°è¿›ç¨‹ä¸­çš„åŠ¨æ€åº“â€ï¼Œå³å¦‚æœ hook æ—¶åŠ¨æ€åº“è¿˜æœªåŠ è½½ï¼ŒShadowHookå†…éƒ¨ä¼šè®°å½•å½“å‰çš„ hookâ€œè¯‰æ±‚â€ï¼Œåç»­ä¸€æ—¦ç›®æ ‡åŠ¨æ€åº“è¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå°†ç«‹åˆ»æ‰§è¡Œ hook æ“ä½œ</p><p>å‚è€ƒä»¥ä¸Šï¼Œè§‚å¯Ÿè¿™é‡Œçš„<code>shadowhook_hook_sym_name</code>å‡½æ•°çš„å‚æ•°ï¼Œå‰ä¸¤ä¸ªå‚æ•°å¦‚ä¸‹ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œæ˜¾ç¤ºçš„æ•°æ®ä¸æ˜¯æ­£ç¡®çš„ï¼Œäº¤å‰å¼•ç”¨å¯ä»¥çœ‹åˆ°å¯¹è¿™äº›å€¼æœ‰åŠ¨æ€ä¿®æ”¹</p><p><img src="image-20250114192731996.png" /></p><p><code>sub_12414</code>å‡½æ•°å¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸­å¯¹<code>0x430C0-0x430C6</code>æœ‰ä¸€ä¸ªå¼‚æˆ–4çš„æ“ä½œï¼Œå¯¹<code>0x430B8</code>æœ‰ä¸€ä¸ªå¼‚æˆ–<code>0xE1E1E1E1E1E1E1E1</code>çš„æ“ä½œ</p><p><img src="image-20250114192827317.png" /></p><p>è€ŒæŸ¥çœ‹<code>sub_12414</code>çš„äº¤å‰å¼•ç”¨å°±èƒ½å‘ç°å®ƒåœ¨<code>.init_array</code>æ®µï¼Œä¹Ÿå°±æ„å‘³ç€è¿™äº›å¼‚æˆ–æ“ä½œç¨‹åºä¸€è¿è¡Œå°±ä¼šè¿›è¡Œ</p><p><img src="image-20250114194047000.png" /></p><p>æœ¬æ¥æƒ³åŠ¨è°ƒçš„ï¼Œä½†æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œé‚£å°±æ‰‹åŠ¨å¼‚æˆ–å›å»å§ï¼Œå¯ä»¥çœ‹åˆ°<code>lib_name</code>æ˜¯<code>libc.so</code>ï¼Œ<code>sym_name</code>æ˜¯<code>execve</code>ï¼Œ<code>execve</code>æ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œç”¨æ¥å¯åŠ¨ä¸€ä¸ªæ–°ç¨‹åº</p><p><img src="image-20250114201453009.png" /></p><p><img src="image-20250114201555986.png" /></p><p>çœ‹åˆ°ä¸æ˜¯ç›®æ ‡å‡½æ•°æˆ‘å°±æ²¡ç»§ç»­ä¸‹å»äº†ï¼Œçœ‹å¤§ä½¬çš„æ–‡ç« ï¼Œåé¢ä»£ç†å‡½æ•°<code>sub_121E4</code>ä¸­åˆ¤æ–­ç³»ç»Ÿè°ƒç”¨æ˜¯å¦ä¸º<code>dex2oat</code>ï¼Œå¦‚æœæ˜¯åˆ™ä¸æ‰§è¡Œ,å¦‚æœä¸æ˜¯åˆ™æ‰§è¡Œ</p><p>ä¸‹é¢<code>shadowhook_hook_sym_name_callback</code>é‡Œä¹Ÿè°ƒç”¨äº†<code>shadowhook_hook_sym_name</code></p><p><img src="image-20250114201827585.png" /></p><p>åŒæ ·åœ°ï¼Œä¹‹å‰çš„<code>sub_12414</code>å‡½æ•°ä¸­ä¹Ÿçœ‹åˆ°äº†ï¼Œå¯¹<code>0x430C8</code>æœ‰ä¸€ä¸ªå¼‚æˆ–<code>0x7D7D7D7D7D7D7D7D</code>çš„æ“ä½œï¼Œå¼‚æˆ–ä¹‹åå¾—åˆ°<code>lib_name</code>ä¸º<code>libart.so</code></p><p><img src="image-20250114204451933.png" /></p><p>æˆ‘è¿™é‡Œ idaè¯†åˆ«çš„æœ‰ç‚¹é—®é¢˜ï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä¸‹é¢<code>0x430D0</code>çš„<code>0x12</code>å¸¦ä¸Š</p><p><img src="image-20250114204549459.png" /></p><p>è¿™é‡Œç¬¦å·æ¢å¤å¾—ä¹Ÿæœ‰ç‚¹é—®é¢˜ï¼Œåˆ«äººçš„æ¢å¤é™¤äº†è¿™é‡Œçš„<code>sym_name</code>ï¼Œä¹Ÿå°±æ˜¯<code>sub_1216C</code>ï¼Œæ˜¯<code>__android_log_print</code>å‡½æ•°ï¼Œè€Œä»£ç†å‡½æ•°æ­£æ˜¯æˆ‘ä»¬è‹¦è‹¦å¯»æ±‚çš„ç›®æ ‡å‡½æ•°</p><p><img src="image-20250114205834218.png" /></p><p>è¿™ä¸ªå‡½æ•°å®ç°çš„åŠŸèƒ½æ˜¯æ£€æµ‹<code>dex</code>æ–‡ä»¶å¤§å°ï¼Œå¦‚æœåŒ¹é…åˆ°ç›®æ ‡<code>dex</code>åˆ™æ‰§è¡Œå›å¡«æ“ä½œï¼Œä»åç§»ä¸º<code>0x178(376)</code>å¼€å§‹çš„<code>0x98</code>å¤§å°çš„å­—èŠ‚ï¼Œå›å¡«çš„å†…å®¹å°±æ˜¯<code>0x42D90</code>å¤„å†…å®¹</p><p><img src="image-20250114210022136.png" /></p><p>è€Œæ£€æµ‹<code>dex</code>æ–‡ä»¶å¤§å°ä¸º<code>0x3AC</code>,å®é™…ä¸Šå°±æ˜¯ä¹‹å‰dump å‡ºæ¥çš„<code>dex</code>æ–‡ä»¶çš„æœ‰æ•ˆéƒ¨åˆ†ï¼Œåé¢éƒ½æ˜¯0</p><p><img src="image-20250114210259268.png" /></p><p>åŒæ—¶ï¼Œåç§»ä¸º<code>0x217(535)</code>çš„åœ°æ–¹ä¹Ÿè¦èµ‹å€¼ä¸º<code>0x430A0</code>å¤„çš„å€¼ï¼ŒåŒæ ·ä¹Ÿè¦è¿›è¡Œå¼‚æˆ–</p><p><img src="image-20250114211420838.png" /></p><p>æŠŠè¿™äº›å†…å®¹æŒ‰ç…§ä¸Šé¢çš„è¯´çš„åç§»ä½ç½®å¡«å…¥ï¼Œå³ä¿®å¤æˆåŠŸ</p><p><img src="image-20250113170400495.png" /></p><p>ç»ˆäºåç¼–è¯‘æˆåŠŸï¼ï¼ï¼</p><p><img src="image-20250114211511417.png" /></p><p>å¾ˆç®€å•çš„å¼‚æˆ–é€»è¾‘ï¼Œ<code>exp</code>å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">118</span>, <span class="number">17</span>, <span class="number">2</span>, <span class="number">80</span>, <span class="number">9</span>, <span class="number">125</span>, <span class="number">6</span>, <span class="number">22</span>, <span class="number">113</span>, <span class="number">66</span>, <span class="number">0</span>, <span class="number">81</span>, <span class="number">94</span>, <span class="number">41</span>, <span class="number">87</span>, <span class="number">20</span>, <span class="number">122</span>, <span class="number">65</span>, <span class="number">88</span>, <span class="number">5</span>, <span class="number">94</span>, <span class="number">41</span>, <span class="number">7</span>, <span class="number">19</span>, <span class="number">118</span>, <span class="number">22</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">90</span>, <span class="number">41</span>, <span class="number">87</span>, <span class="number">71</span>, <span class="number">117</span>, <span class="number">68</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">95</span>, <span class="number">116</span>, <span class="number">4</span>, <span class="number">67</span>]</span><br><span class="line">key = <span class="string">b&#x27;CrackMe!CrackMe!&#x27;</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    flag.append(enc[i]^key[i%<span class="built_in">len</span>(key)])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag).decode())</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><ahref="https://bbs.kanxue.com/thread-285135.htm">[2025è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›]HappyLockï¼ˆå¯¹æŠ—ä½¿ç”¨SHadowHookå®ç°çš„ç±»æŠ½å–ï¼‰</a></p><p><ahref="http://www.yxfzedu.com/article/12160">Androidå®‰å…¨-å…¨å›½é«˜æ ¡å¤§å­¦ç”Ÿè½¯ä»¶åˆ›æ–°å¤§èµ›-è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›HappyLockå¤ç°</a></p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reverse </tag>
            
            <tag> android </tag>
            
            <tag> hook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP-[2025.1è½¯ä»¶ç³»ç»Ÿå®‰å…¨èµ›]donntyousee</title>
      <link href="/2025/01/10/2025%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E8%B5%9B-donntyousee/"/>
      <url>/2025/01/10/2025%E8%BD%AF%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E8%B5%9B-donntyousee/</url>
      
        <content type="html"><![CDATA[<h1 id="donntyousee">donntyousee</h1><h2 id="åˆçœ‹">åˆçœ‹</h2><p>æ¯”èµ›çš„æ—¶å€™æ²¡æœ‰ç»†çœ‹ï¼Œå°±ç®€å•è°ƒäº†ä¸€ä¼šï¼Œæ²¡æ‰¾åˆ°è¾“å…¥çš„åœ°æ–¹ï¼Œè§‰å¾—æœ‰ç‚¹å¥‡æ€ªï¼Œå°±å»çœ‹å¦ä¸€é“happylock äº†ï¼ˆè™½ç„¶ä¹Ÿæ²¡å†™å‡ºæ¥</p><h2 id="åˆæ­¥å¤„ç†">åˆæ­¥å¤„ç†</h2><p>åœ¨<code>start</code>å‡½æ•°ä¸­çš„<code>sub_405559</code>é‡Œå¯ä»¥çœ‹åˆ°æœ‰å¼‚å¸¸</p><p><img src="image-20250108191600363.png" /></p><p><img src="image-20250108194703557.png" /></p><p>æ±‡ç¼–è§†å›¾å¾€ä¸Šçœ‹æœ‰ä¸ªè«åå…¶å¦™çš„<code>retn</code></p><p><img src="image-20250108194754301.png" /></p><p>nop æ‰å³å¯åæ±‡ç¼–</p><p><img src="image-20250108194819599.png" /></p><p>è¾“å…¥å‡½æ•°å³<code>sub_4D9660</code>ï¼Œ<code>unk_56602C</code>å³ä¸º<code>%s</code></p><p><img src="image-20250108222936992.png" /></p><p>åŒæ—¶åœ¨<code>unk_56602C</code>ä¸‹æ–¹çœ‹åˆ°<code>rc4</code>å­—æ ·ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯<code>RC4</code>åŠ å¯†</p><p><img src="image-20250108223044499.png" /></p><p>ä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰åœ¨<code>sub_4D9660</code>çš„ä¼ªä»£ç ä¸­çœ‹åˆ°è°ƒç”¨<code>RC4</code>åŠ å¯†ä»¥åŠ<code>flag</code>éªŒè¯çš„ç›¸å…³å‡½æ•°ï¼Œäºæ˜¯å›åˆ°æ±‡ç¼–è§†å›¾ï¼Œå‘ç°æœ‰<code>call r8</code>è¯­å¥ï¼ŒåŠ¨è°ƒçœ‹ä¸€ä¸‹<code>call r8</code>æ˜¯è°ƒç”¨äº†å“ªä¸ªå‡½æ•°</p><p><img src="image-20250110130021262.png" /></p><p>å¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ¡<code>call r8</code>è°ƒç”¨çš„æ˜¯<code>sub_405848</code>å‡½æ•°</p><p><img src="image-20250110130357037.png" /></p><p>ç¬¬äºŒæ¡<code>call r8</code>è°ƒç”¨çš„æ˜¯<code>sub_405EAA</code>å‡½æ•°</p><p><img src="image-20250110130456097.png" /></p><p>åŒæ ·ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°é‡Œä¹Ÿæœ‰<code>retn</code>èŠ±æŒ‡ä»¤ï¼Œå»é™¤å³å¯åæ±‡ç¼–</p><p><img src="image-20250110125326424.png" /></p><p><img src="image-20250110130841965.png" /></p><p><code>sub_405848</code>å‡½æ•°æ˜¯<code>RC4</code>çš„å¯†é’¥åˆå§‹åŒ–ï¼ˆKSAï¼‰é˜¶æ®µ</p><p><img src="image-20250110130705586.png" /></p><p><code>sub_405EAA</code>å‡½æ•°æ˜¯åŠ å¯†ï¼ˆPRGAï¼‰é˜¶æ®µï¼Œæ³¨æ„æœ‰ä¸ªé­”æ”¹ï¼Œæœ€åå¼‚æˆ–äº†<code>0x23</code></p><p><img src="image-20250110130854613.png" /></p><p>ä¼ªä»£ç ä¸­å¯ä»¥çœ‹åˆ°éƒ½æ˜¯ä¸´æ—¶å˜é‡ï¼Œäºæ˜¯å¯†é’¥å’Œå¯†æ–‡éœ€è¦åŠ¨è°ƒ dump å‡ºæ¥</p><p><code>sub_405848</code>å‡½æ•°ä¸­ï¼Œå‚æ•°<code>a3</code>å°±æ˜¯å¯†é’¥æ•°ç»„ï¼Œ<code>a4</code>ä¸ºå¯†é’¥é•¿åº¦</p><p><img src="image-20250110135357841.png" /></p><p><img src="image-20250110135530715.png" /></p><p><code>sub_405EAA</code>å‡½æ•°ä¸­å‚æ•°<code>a3</code>æ˜¯è¾“å…¥çš„<code>flag</code>ï¼Œ<code>a2</code>æ˜¯KSA ç”Ÿæˆçš„å¯†é’¥æµï¼Œ<code>a4</code>æ˜¯å¯†æ–‡é•¿åº¦</p><p>åŒæ—¶æ³¨æ„åˆ°ï¼Œè¾“å…¥çš„<code>flag</code>å­˜æ”¾çš„ä½ç½®æ˜¯<code>bss</code>æ®µï¼Œæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œèµ·å§‹åœ°å€ä¸º<code>0x5C6CC0</code></p><p><img src="image-20250110135901377.png" /></p><p><img src="image-20250110135911927.png" /></p><p><img src="image-20250110135853018.png" /></p><h2 id="å¯»æ‰¾å¯†æ–‡">å¯»æ‰¾å¯†æ–‡</h2><p>å¾—åˆ°äº†å¯†é’¥ï¼Œä½†æ˜¯æ²¡æœ‰å¯†æ–‡ï¼Œåœ¨<code>sub_4D9660</code>æ±‡ç¼–é‡Œä¹Ÿæ²¡æ‰¾åˆ°</p><p>ä½†æ˜¯å¯ä»¥æƒ³åˆ°ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯å°†è¾“å…¥çš„<code>flag</code>è¿›è¡ŒåŠ å¯†ä¸é¢„è®¾çš„å¯†æ–‡è¿›è¡Œæ¯”è¾ƒï¼Œä¸Šé¢ä¹Ÿæåˆ°ï¼Œå­˜æ”¾è¾“å…¥çš„<code>flag</code>çš„åœ°æ–¹æ˜¯<code>bss</code>æ®µï¼Œäºæ˜¯å»<code>0x5C6CC0</code>å¤„æŸ¥çœ‹äº¤å‰å¼•ç”¨ï¼Œå‘ç°æœç„¶æœ‰å¦å¤–ä¸€ä¸ªå‡½æ•°è°ƒç”¨</p><p><img src="image-20250110173035880.png" /></p><p>åŒæ ·ï¼Œè¿™ä¸ªå‡½æ•°é‡Œä¹Ÿæœ‰èŠ±æŒ‡ä»¤</p><p><img src="image-20250110173108323.png" /></p><p>ä½†å…¶å®å»äº†ä¹‹åä¹Ÿæ²¡ç”¨ï¼Œè¿™ä¸ªå‡½æ•°å¾ˆçŸ­ï¼Œè€Œä¸”æ³¨æ„åˆ°é‡Œé¢ä¹Ÿæœ‰<code>call å¯„å­˜å™¨</code>çš„æ“ä½œï¼ŒåŒæ ·åŠ¨è°ƒçœ‹ä¸€ä¸‹</p><p><img src="image-20250110173549668.png" /></p><p>å¯ä»¥çœ‹åˆ°æ˜¯è°ƒç”¨äº†<code>sub_405CAA</code>å‡½æ•°</p><p><img src="image-20250110173616903.png" /></p><p>åŒæ ·æœ‰èŠ±æŒ‡ä»¤</p><p><img src="image-20250110173723309.png" /></p><p>åæ±‡ç¼–</p><p><img src="image-20250110173803532.png" /></p><p>æœ€å¥½åœ¨åŠ¨è°ƒçš„æ—¶å€™çœ‹ï¼Œå¯ä»¥çœ‹åˆ°å‚æ•°<code>a2</code>æ˜¯<code>0x5C6CC0</code>ï¼Œå°±æ˜¯å­˜æ”¾è¾“å…¥çš„åœ°æ–¹</p><p><img src="image-20250110174858284.png" /></p><p>ä¸‹é¢çš„æ¯”è¾ƒé€»è¾‘è¯´æ˜å¯†æ–‡å°±æ˜¯<code>v8</code>æ•°ç»„</p><p>ï¼ˆè‡³äºå¯†æ–‡å¤§å°ä¸ºä»€ä¹ˆä¸æ˜¯ä¸Šé¢åŠ¨è°ƒå¾—åˆ°çš„<code>0x32</code>æˆ‘è¿˜æ²¡ææ‡‚</p><p><img src="image-20250110175018579.png" /></p><h2 id="åè°ƒè¯•">åè°ƒè¯•</h2><p>ä½†æ˜¯è§£äº†ä¸€ä¸‹å‘ç°è¿˜æ˜¯ä¸å¯¹ï¼Œæ€€ç–‘æ˜¯åè°ƒè¯•æçš„é¬¼</p><p>å›å»çœ‹å­˜å‚¨å¯†é’¥çš„åœ°æ–¹ï¼Œæ˜¯<code>data</code>æ®µ<code>0x5C5110</code>å¤„ï¼Œå¯ä»¥çœ‹åˆ°<code>sub_4053A5</code>å‡½æ•°è°ƒç”¨äº†æ­¤æ•°ç»„</p><p><img src="image-20250110210827528.png" /></p><p>åŒæ ·æœ‰èŠ±æŒ‡ä»¤</p><p><img src="image-20250110210924503.png" /></p><p>åæ±‡ç¼–å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªåè°ƒè¯•æ“ä½œï¼Œå°†<code>0x5C5110</code>å¼‚æˆ–äº†<code>0x45</code></p><p><img src="image-20250110213703546.png" /></p><p>æ‰€ä»¥åŠ¨è°ƒå‡ºæ¥çš„å¯†é’¥è¦å¼‚æˆ–<code>0x45</code>ï¼Œæˆ–è€…å› ä¸ºå¯†é’¥åœ¨<code>data</code>æ®µï¼Œä¹Ÿå¯ä»¥ç›´æ¥é™æ€æƒ…å†µä¸‹å»<code>0x5C5110</code>å¤„å–å¯†é’¥</p><p><img src="image-20250110215551053.png" /></p><p>å‘ç°æœ‰åè°ƒè¯•ï¼Œé™¤äº†æ„Ÿè§‰ä¸å¯¹ï¼Œè¿˜å¯ä»¥é€šè¿‡<code>strace</code>æ¥æ£€æµ‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸€ä¸ª<code>ptrace</code>ï¼Œä¸”<code>ptrace(PTRACE_TRACEME) = -1 EPERM (Operation not permitted)</code></p><p><code>ptrace</code> æ˜¯ç”¨äºè°ƒè¯•çš„ç³»ç»Ÿè°ƒç”¨ï¼Œè¿™é‡Œçš„è¿”å›å€¼<code>-1 EPERM</code>è¡¨ç¤ºæ²¡æœ‰æƒé™è¿›è¡Œè¿½è¸ªæ“ä½œï¼Œé€šå¸¸æ˜¯å› ä¸ºç¨‹åºæ²¡æœ‰è¶³å¤Ÿçš„æƒé™æˆ–è¢«ç¦æ­¢è¿›è¡Œè°ƒè¯•ï¼Œä¹Ÿå¯ä»¥ç”±æ­¤å‘ç°å­˜åœ¨åè°ƒè¯•</p><p><img src="image-20250115220837644.png" /></p><h2 id="init_arrayæ®µ"><code>.init_array</code>æ®µ</h2><p>åŒæ—¶ï¼ŒæŸ¥çœ‹<code>sub_4053A5</code>çš„äº¤å‰å¼•ç”¨å‘ç°ï¼Œè¿™ä¸ªå‡½æ•°åœ¨<code>.init_array</code>æ®µä¸­ï¼Œä¹Ÿå°±æ„å‘³ç€è¿™ä¸ªå‡½æ•°ä¼šåœ¨ç¨‹åºä¸€è¿è¡Œå°±æ‰§è¡Œï¼Œå› æ­¤ä¸€æ£€æµ‹åˆ°è°ƒè¯•å™¨å°±ä¼šæ”¹å˜å¯†é’¥çš„å€¼</p><p><img src="image-20250115200328813.png" /></p><p>çœ‹åˆ°è¿™é‡Œï¼Œè®©æˆ‘æƒ³èµ·äº†ä¸€å¼€å§‹åšè¿™é“é¢˜ï¼ŒæŸ¥æ‰¾å­—ç¬¦ä¸²çš„æ—¶å€™å¹¶æ²¡æœ‰<code>plz input your flag</code>ï¼ŒçŒœæƒ³ä¹Ÿæ˜¯åœ¨<code>.init_array</code>æ®µä¸­åˆå§‹åŒ–äº†ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹</p><p>ida ä¸­ View-Open Subviews-Segmentsæ‰“å¼€æ®µè§†å›¾ï¼Œå®šä½åˆ°<code>.init_array</code>æ®µ</p><p><img src="image-20250115201656571.png" /></p><p>è¿˜æŒºå¤šçš„</p><p><img src="image-20250115203643554.png" /></p><p>é¢é¢ï¼Œç¿»äº†åŠå¤©ï¼Œå…¶å®åˆå§‹åŒ–å°±æ˜¯åœ¨<code>sub_4053A5</code>å‡½æ•°é‡Œ</p><p><img src="image-20250115203742561.png" /></p><p>æŒ‰ç…§è¿™ä¸ªæ­¥éª¤æ¥å°±å¯ä»¥å¾—åˆ°</p><p><img src="image-20250115203834628-1736944815688-5.png" /></p><h2 id="exp">EXP</h2><p>exp å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">RC4_decrypt</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    key = [<span class="number">146</span>, <span class="number">28</span>, <span class="number">43</span>, <span class="number">31</span>, <span class="number">186</span>, <span class="number">251</span>, <span class="number">162</span>, <span class="number">255</span>, <span class="number">7</span>, <span class="number">105</span>, <span class="number">125</span>, <span class="number">119</span>, <span class="number">24</span>, <span class="number">140</span>]</span><br><span class="line">    S = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    out = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># KSA (Key Scheduling Algorithm)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % <span class="built_in">len</span>(key)]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># PRGA (Pseudo Random Generation Algorithm)</span></span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span>   </span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        out.append(<span class="number">0x23</span> ^ char ^ S[(S[i] + S[j]) % <span class="number">256</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(out)</span><br><span class="line"></span><br><span class="line">ciphertext = [<span class="number">37</span>, <span class="number">205</span>, <span class="number">84</span>, <span class="number">175</span>, <span class="number">81</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">211</span>, <span class="number">168</span>, <span class="number">75</span>, <span class="number">79</span>, <span class="number">86</span>, <span class="number">236</span>, <span class="number">131</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">246</span>, <span class="number">71</span>, <span class="number">74</span>, <span class="number">111</span>, <span class="number">224</span>, <span class="number">115</span>, <span class="number">176</span>, <span class="number">165</span>, <span class="number">168</span>, <span class="number">195</span>, <span class="number">23</span>, <span class="number">129</span>, <span class="number">94</span>, <span class="number">43</span>, <span class="number">244</span>, <span class="number">246</span>, <span class="number">113</span>, <span class="number">234</span>, <span class="number">47</span>, <span class="number">255</span>, <span class="number">168</span>, <span class="number">99</span>, <span class="number">153</span>, <span class="number">87</span>]</span><br><span class="line">plaintext = RC4_decrypt(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(plaintext.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reverse </tag>
            
            <tag> åŠ¨è°ƒ </tag>
            
            <tag> åè°ƒè¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP-[2024.12CISCNåˆèµ›]fffffhash</title>
      <link href="/2024/12/22/2025CISCN%E5%88%9D%E8%B5%9B-fffffhash/"/>
      <url>/2024/12/22/2025CISCN%E5%88%9D%E8%B5%9B-fffffhash/</url>
      
        <content type="html"><![CDATA[<h1 id="fffffhash">fffffhash</h1><h2 id="wpåˆç¨¿">12.16wpåˆç¨¿</h2><h3 id="é¢˜ç›®ä»£ç ">é¢˜ç›®ä»£ç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">giaogiao</span>(<span class="params">hex_string</span>):</span><br><span class="line">base_num = <span class="number">0x6c62272e07bb014262b821756295c58d</span></span><br><span class="line">x = <span class="number">0x0000000001000000000000000000013b</span></span><br><span class="line">MOD = <span class="number">2</span>**<span class="number">128</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> hex_string:</span><br><span class="line">base_num = (base_num * x) &amp; (MOD - <span class="number">1</span>) </span><br><span class="line">base_num ^= i</span><br><span class="line"><span class="keyword">return</span> base_num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">giao=<span class="number">201431453607244229943761366749810895688</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;1geiwoligiaogiao&quot;</span>)</span><br><span class="line">hex_string = <span class="built_in">int</span>(<span class="built_in">input</span>(),<span class="number">16</span>)</span><br><span class="line">s = long_to_bytes(hex_string)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> giaogiao(s) == giao:</span><br><span class="line"><span class="built_in">print</span>(os.getenv(<span class="string">&#x27;FLAG&#x27;</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;error&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="æ€è·¯">æ€è·¯</h3><p>è¿™é¢˜æ˜¯ä¸€ä¸ªè‡ªå†™çš„fnvå“ˆå¸Œï¼Œå­˜åœ¨é—®é¢˜ï¼Œå…¶å®å’Œ<ahref="https://github.com/DownUnderCTF/Challenges_2023_Public/tree/main/crypto/fnv">DUCTF2023fnv</a>æ˜¯ä¸€æ ·çš„</p><p>å› ä¸ºä¸çš„æ•° <span class="math inline">\(MOD-1\)</span> æ˜¯ <spanclass="math inline">\(2^{128}-1\)</span>ï¼Œæ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å…¨1çš„æ•°ï¼Œæ‰€ä»¥å°±ç›¸å½“äº<span class="math inline">\(\bmod MOD\)</span>ï¼Œè€Œå¼‚æˆ–çš„æ•° <spanclass="math inline">\(i\)</span> å¤„äº <spanclass="math inline">\(0-255\)</span>ä¹‹é—´ï¼Œç›¸æ¯”ä¹‹ä¸‹æ˜¯ä¸€ä¸ªç›¸å½“å°çš„æ•°ï¼Œäºæ˜¯è€ƒè™‘é€ æ ¼è§„çº¦</p><p>æŠŠå“ˆå¸Œçš„è¿‡ç¨‹ç¿»è¯‘ä¸€ä¸‹å¤§è‡´å°±æ˜¯ <span class="math display">\[\begin{gathered}n_{1}\equiv xn_0+b_0\bmod MOD\\n_{2}\equiv xn_1+b_1\bmod MOD\\n_3\equiv xn_2+b_2\bmod MOD\\\vdots \\n_{16}\equiv xn_{15}+b_{15}\bmod MOD\end{gathered}\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(n_i\)</span>ä»£è¡¨æ¯æ¬¡çš„<code>base_num</code>ï¼Œ<spanclass="math inline">\(+b_i\)</span> ç›¸å½“äºæ¯æ¬¡çš„å¼‚æˆ–æ•° <spanclass="math inline">\(i\)</span> ï¼Œè‡³äºä¸ºä»€ä¹ˆæ˜¯16ä¸ªç­‰å¼ï¼ŒçŒœçš„å§ï¼Œå› ä¸º<span class="math inline">\(128/8=16\)</span></p><p>äºæ˜¯å¯ä»¥å¾—åˆ° <span class="math display">\[\begin{aligned}giao=n_{16}&amp;\equiv xn_{15}+b_{15}\bmod MOD\\&amp;\equiv x(xn_{14}+b_{14})+b_{15}\bmod MOD\\&amp;\equiv x^2n_{14}+b_{14}x+b_{15}\bmod MOD\\&amp;\equiv \dots\\&amp;\equiv n_0x^{16}+b_0x^{15}+b_1x^{14}+\dots+b_{15}x^0\bmod MOD\end{aligned}\]</span> äºæ˜¯å¯ä»¥æ„é€ æ ¼ <span class="math display">\[\begin{pmatrix}b_{15} &amp; b_{14} &amp; \dots &amp; b_0 &amp; 1 &amp; 1 &amp; k\end{pmatrix}\begin{pmatrix}1&amp;&amp;&amp;&amp;&amp;&amp;x^0\\&amp;1&amp;&amp;&amp;&amp;&amp;x^1\\&amp;&amp;\ddots&amp;&amp;&amp;&amp;\vdots\\&amp;&amp;&amp;1&amp;&amp;&amp;x^{15}\\&amp;&amp;&amp;&amp;1&amp;&amp;n_0x^{16}\\&amp;&amp;&amp;&amp;&amp;1&amp;-giao\\&amp;&amp;&amp;&amp;&amp;&amp;MOD\end{pmatrix}=\begin{pmatrix}b_{15} &amp; b_{14} &amp; \dots &amp; b_0 &amp; 1 &amp; 1 &amp; 0\end{pmatrix}\]</span> è„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">base_num = <span class="number">0x6c62272e07bb014262b821756295c58d</span></span><br><span class="line">x = <span class="number">0x0000000001000000000000000000013b</span></span><br><span class="line">MOD = <span class="number">2</span>**<span class="number">128</span></span><br><span class="line">giao=<span class="number">201431453607244229943761366749810895688</span></span><br><span class="line">h0=base_num</span><br><span class="line">n=<span class="number">16</span></span><br><span class="line"></span><br><span class="line">M = Matrix(ZZ,n+<span class="number">3</span>,n+<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    M[i,i]=<span class="number">1</span></span><br><span class="line">    M[i,-<span class="number">1</span>]=x^i</span><br><span class="line">M[-<span class="number">3</span>,-<span class="number">1</span>]=h0*(x^n)</span><br><span class="line">M[-<span class="number">3</span>,-<span class="number">3</span>]=<span class="number">1</span></span><br><span class="line">M[-<span class="number">2</span>,-<span class="number">1</span>]=-giao</span><br><span class="line">M[-<span class="number">2</span>,-<span class="number">2</span>]=<span class="number">1</span></span><br><span class="line">M[-<span class="number">1</span>,-<span class="number">1</span>]=MOD</span><br><span class="line">LM=M.LLL()</span><br><span class="line">res=LM[<span class="number">1</span>]</span><br><span class="line">res=res[:-<span class="number">3</span>][::-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="comment"># (-2, -1, 1, -8, 5, 4, 9, 0, -1, -3, 6, -2, 6, -5, -5, 1)</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œè§„å‡ºæ¥ä¹‹åå¾—ç”¨ç¬¬2è¡Œçš„ç»“æœï¼Œå› ä¸ºç¬¬ä¸€è¡ŒåŸºæœ¬å…¨æ˜¯0ï¼Œæ˜¾ç„¶ä¸æ˜¯é¢„æœŸçš„<span class="math inline">\(b_i\)</span>ï¼Œè€Œä¸”ç¬¬äºŒè¡Œçš„æœ«å°¾æ‰æ˜¯æ­£ç¡®çš„<span class="math inline">\(1\quad1 \quad0\)</span></p><p><img src="image-20241220215339956.png" /></p><p>ç°åœ¨å¾—åˆ°äº† <spanclass="math inline">\(b_i\)</span>ï¼Œæ¥ä¸‹æ¥éœ€è¦å¯»æ‰¾å¼‚æˆ–çš„æ—¶å€™ç”¨çš„ <spanclass="math inline">\(i\)</span>ï¼ŒäºŒè€…å¯¹äº<code>base_num</code>çš„å½±å“æ˜¯ç­‰æ•ˆçš„ï¼Œç”±æ­¤å¯ä»¥é€å­—èŠ‚åœ¨<span class="math inline">\(0-255\)</span> ä¹‹é—´çˆ†ç ´</p><p>ç”±ä¹‹å‰çš„æ¨å¯¼ <span class="math display">\[\begin{gathered}n_{1}\equiv xn_0+b_0\bmod MOD\\n_{2}\equiv xn_1+b_1\bmod MOD\\n_3\equiv xn_2+b_2\bmod MOD\\\vdots \\n_{16}\equiv xn_{15}+b_{15}\bmod MOD\end{gathered}\]</span> å¯ä»¥çŸ¥é“æ¯æ¬¡ <span class="math inline">\(+b_i\)</span> æ˜¯åœ¨<span class="math inline">\(xn_i\)</span>çš„åŸºç¡€ä¸Šï¼Œæ‰€ä»¥éœ€è¦åœ¨æ¯æ¬¡å¾ªç¯æ—¶åšçˆ†ç ´ï¼Œå¾—åˆ°æ­£ç¡®çš„ç»“æœ <spanclass="math inline">\(b_i\)</span> åï¼Œæ‰èƒ½ç»§ç»­çˆ†ç ´ä¸‹ä¸€ä¸ª <spanclass="math inline">\(b_{i+1}\)</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">flag=[]</span><br><span class="line">target=base_num</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    target*=x</span><br><span class="line">    target%=MOD</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xff</span>):</span><br><span class="line">        <span class="keyword">if</span> (target^^j==target+res[i]):</span><br><span class="line">            flag.append(j)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    target^^=j</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(flag).<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment"># 020101081b04390001051a020a3d0f0f</span></span><br></pre></td></tr></table></figure><h2 id="åšåŸé¢˜">12.20åšåŸé¢˜</h2><p>åŸé¢˜é“¾æ¥<ahref="https://github.com/DownUnderCTF/Challenges_2023_Public/tree/main/crypto/fnv">DUCTF2023fnv</a></p><h3 id="é¢˜ç›®ä»£ç -1">é¢˜ç›®ä»£ç </h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fnv1</span>(<span class="params">s</span>):</span><br><span class="line">h = <span class="number">0xcbf29ce484222325</span></span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> s:</span><br><span class="line">h *= <span class="number">0x00000100000001b3</span></span><br><span class="line">h &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line">h ^= b</span><br><span class="line"><span class="keyword">return</span> h</span><br><span class="line"></span><br><span class="line">TARGET = <span class="number">0x1337133713371337</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Welcome to FNV!&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Please enter a string in hex that hashes to 0x<span class="subst">&#123;TARGET:016x&#125;</span>:&quot;</span>)</span><br><span class="line">s = <span class="built_in">bytearray</span>.fromhex(<span class="built_in">input</span>())</span><br><span class="line"><span class="keyword">if</span> fnv1(s) == TARGET:</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(fnv1(s)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Well done!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(os.getenv(<span class="string">&#x27;FLAG&#x27;</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(fnv1(s)))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Try again... :(&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="æœ€åˆæ€è·¯">æœ€åˆæ€è·¯</h3><p>ç”¨ä¸€æ ·çš„æ€è·¯æ„é€ æ ¼å¦‚ä¸‹ <span class="math display">\[\begin{pmatrix}b_{9} &amp; b_{8} &amp; \dots &amp; b_0 &amp; 1 &amp; 1 &amp; k\end{pmatrix}\begin{pmatrix}1&amp;&amp;&amp;&amp;&amp;&amp;x^0\\&amp;1&amp;&amp;&amp;&amp;&amp;x^1\\&amp;&amp;\ddots&amp;&amp;&amp;&amp;\vdots\\&amp;&amp;&amp;1&amp;&amp;&amp;x^{9}\\&amp;&amp;&amp;&amp;1&amp;&amp;h_0x^{10}\\&amp;&amp;&amp;&amp;&amp;1&amp;-TARGET\\&amp;&amp;&amp;&amp;&amp;&amp;MOD\end{pmatrix}=\begin{pmatrix}b_{9} &amp; b_{8} &amp; \dots &amp; b_0 &amp; 1 &amp; 1 &amp; 0\end{pmatrix}\]</span> ä½†å¯æƒœçš„æ˜¯è¿™é¢˜è¿™æ ·æ„é€ çš„è¯è§„ä¸å‡ºæ¥</p><p>è¿™ä¸ªæ—¶å€™å›å¤´å»çœ‹å›½èµ›é‚£é“é¢˜ï¼Œå…¶å®æœ‰ç‚¹é—®é¢˜ï¼Œå½“æ—¶åšçš„æ—¶å€™ç›´æ¥å°±è§„å‡ºæ¥äº†ï¼Œå°±æ²¡ç»†ç®—ï¼Œç°åœ¨é©¬åç‚®ç®—ä¸€ä¸‹èŒƒæ•°ï¼Œå‘ç°ç¡®å®æœ‰ç‚¹é—®é¢˜</p><p>æ ¼åŸºçš„æ¨¡é•¿å¦‚æœæ¯ä¸ª <span class="math inline">\(b_i\)</span>éƒ½æŒ‰æœ€é•¿çš„ç®—ï¼Œä¸º <spanclass="math inline">\(\sqrt{16*2^{8*2}+2}\)</span>ï¼Œå¤§æ¦‚æ˜¯10ä½ï¼Œè€Œ<spanclass="math inline">\(\sqrt{n}det(L)^{\frac{1}{n}}\)</span> ä¸º <spanclass="math inline">\(\sqrt{19}\times2^{128/19}\)</span>ï¼Œå¤§æ¦‚æ˜¯9ä½ï¼Œå…¶å®æ˜¯ä¸å¤Ÿå¤§çš„</p><p>é‚£ä¸ºä»€ä¹ˆèƒ½è§„å‡ºæ¥å‘¢ï¼Ÿ</p><p>åŸå› å°±æ˜¯ <span class="math inline">\(b_i\)</span>çš„ä½æ•°å…¶å®æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œä»è§„å‡ºæ¥çš„ç»“æœæ¥çœ‹ï¼Œ<spanclass="math inline">\(b_i\)</span>å…¨æ˜¯ä¸ªä½æ•°ï¼Œæ‰€ä»¥å…¶å®æ ¼åŸºçš„æ¨¡é•¿å¾ˆå°ï¼Œæ»¡è¶³èƒ½æ ¼å‡ºæ¥çš„æ¡ä»¶</p><p>æ‰€ä»¥è§£å†³è¿™é“é¢˜çš„å…³é”®ï¼Œæ˜¯ä¸æ˜¯åœ¨äºé…å¹³ï¼Ÿ</p><h3 id="ä»¿ç…§å®˜æ–¹exp">ä»¿ç…§å®˜æ–¹exp</h3><p>äºæ˜¯æˆ‘å»æ‰¾äº†å½“æ—¶è¿™é“é¢˜çš„wpï¼Œç”±äºæ˜¯å›½å¤–çš„æ¯”èµ›ï¼Œç½‘ä¸Šèƒ½æ‰¾åˆ°çš„wpå¾ˆå°‘ï¼Œç”¨æ ¼æ¥åšçš„å°±æ‰¾åˆ°å®˜æ–¹expä¸€ä»½ï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">TARGET = <span class="number">0x1337133713371337</span></span><br><span class="line">h0 = <span class="number">0xcbf29ce484222325</span></span><br><span class="line">p = <span class="number">0x00000100000001b3</span></span><br><span class="line">MOD = <span class="number">2</span>^<span class="number">64</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">10</span></span><br><span class="line">M = Matrix.column([p^(n - i - <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)] + [-(TARGET - h0*p^n), MOD])</span><br><span class="line">M = M.augment(identity_matrix(n+<span class="number">1</span>).stack(vector([<span class="number">0</span>] * (n+<span class="number">1</span>))))</span><br><span class="line">Q = Matrix.diagonal([<span class="number">2</span>^<span class="number">128</span>] + [<span class="number">2</span>^<span class="number">4</span>] * n + [<span class="number">2</span>^<span class="number">8</span>])</span><br><span class="line">M *= Q</span><br><span class="line">M = M.BKZ()</span><br><span class="line">M /= Q</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">if</span> r[<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">abs</span>(r[-<span class="number">1</span>]) == <span class="number">1</span>:</span><br><span class="line">        r *= r[-<span class="number">1</span>]</span><br><span class="line">        good = r[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(good)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">inp = []</span><br><span class="line">y = <span class="built_in">int</span>(h0*p)</span><br><span class="line">t = (h0*p^n + good[<span class="number">0</span>] * p^(n-<span class="number">1</span>)) % MOD</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        y_ = (<span class="built_in">int</span>(y) ^^ <span class="built_in">int</span>(x)) * p^(n-i-<span class="number">1</span>) % MOD</span><br><span class="line">        <span class="keyword">if</span> y_ == t:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;good&#x27;</span>, i, x)</span><br><span class="line">            inp.append(x)</span><br><span class="line">            <span class="keyword">if</span> i &lt; n-<span class="number">1</span>:</span><br><span class="line">                t = (t + good[i+<span class="number">1</span>] * p^(n-i-<span class="number">2</span>)) % MOD</span><br><span class="line">                y = ((<span class="built_in">int</span>(y) ^^ <span class="built_in">int</span>(x)) * p) % MOD</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;bad&#x27;</span>, i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(inp).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure><p>è¿™ä»½wpçš„æ ¼æ„é€ å¦‚ä¸‹ <span class="math display">\[\begin{pmatrix}b_0&amp;b_1&amp;\dots&amp;b_9&amp;1&amp;k\end{pmatrix}\begin{pmatrix}x^9&amp;1&amp;&amp;&amp;&amp;&amp;&amp;\\x^8&amp;&amp;1&amp;&amp;&amp;&amp;&amp;\\\vdots&amp;&amp;&amp;\ddots&amp;&amp;&amp;&amp;\\x^1&amp;&amp;&amp;&amp;1&amp;&amp;&amp;\\x^0&amp;&amp;&amp;&amp;&amp;1&amp;&amp;\\-TARGET+h_0x^{10}&amp;&amp;&amp;&amp;&amp;&amp;1&amp;\\MOD&amp;&amp;&amp;&amp;&amp;&amp;&amp;0\end{pmatrix}=\begin{pmatrix}0&amp;b_0&amp;b_1&amp;\dots&amp;b_9&amp;1&amp;0\end{pmatrix}\]</span></p><p>ç„¶åä¹˜äº†ä¸€ä¸ªå¯¹è§’çŸ©é˜µåšé…å¹³</p><p><span class="math display">\[\begin{pmatrix}2^{128}&amp;&amp;&amp;&amp;&amp;&amp;\\&amp;2^4&amp;&amp;&amp;&amp;\\&amp;&amp;2^4&amp;&amp;&amp;\\&amp;&amp;&amp;\ddots&amp;&amp;\\&amp;&amp;&amp;&amp;2^4&amp;\\&amp;&amp;&amp;&amp;&amp;2^8\end{pmatrix}\]</span></p><p>ä¹Ÿå°±æ˜¯ <span class="math display">\[\begin{pmatrix}b_0&amp;b_1&amp;\dots&amp;b_9&amp;1&amp;k\end{pmatrix}\begin{pmatrix}2^{128}*x^9&amp;2^4&amp;&amp;&amp;&amp;&amp;&amp;\\2^{128}*x^8&amp;&amp;2^4&amp;&amp;&amp;&amp;&amp;\\\vdots&amp;&amp;&amp;\ddots&amp;&amp;&amp;&amp;\\2^{128}*x^1&amp;&amp;&amp;&amp;2^4&amp;&amp;&amp;\\2^{128}*x^0&amp;&amp;&amp;&amp;&amp;2^4&amp;&amp;\\2^{128}*(-TARGET+h_0x^{10})&amp;&amp;&amp;&amp;&amp;&amp;2^8&amp;\\2^{128}*MOD&amp;&amp;&amp;&amp;&amp;&amp;&amp;0\end{pmatrix}=\begin{pmatrix}0&amp;2^4*b_0&amp;2^4*b_1&amp;\dots&amp;2^4*b_9&amp;2^8&amp;0\end{pmatrix}\]</span> æˆ‘ç›´æ¥æŒ‰ç…§è¿™ä¸ªæ ¼çš„é…å¹³æ–¹æ³•ï¼Œç»™æˆ‘ä¹‹å‰æ„é€ çš„æ ¼åšé…å¹³å¦‚ä¸‹ <spanclass="math display">\[\begin{pmatrix}b_{9} &amp; b_{8} &amp; \dots &amp; b_0 &amp; 1 &amp; 1 &amp; k\end{pmatrix}\begin{pmatrix}2^4&amp;&amp;&amp;&amp;&amp;&amp;2^{128}*x^0\\&amp;2^4&amp;&amp;&amp;&amp;&amp;2^{128}*x^1\\&amp;&amp;\ddots&amp;&amp;&amp;&amp;\vdots\\&amp;&amp;&amp;2^4&amp;&amp;&amp;2^{128}*x^{9}\\&amp;&amp;&amp;&amp;2^8&amp;&amp;2^{128}*h_0x^{10}\\&amp;&amp;&amp;&amp;&amp;2^8&amp;2^{128}*(-TARGET)\\&amp;&amp;&amp;&amp;&amp;&amp;2^{128}*MOD\end{pmatrix}=\begin{pmatrix}2^4*b_{9} &amp; 2^4*b_{8} &amp; \dots &amp; 2^4*b_0 &amp; 2^8 &amp; 2^8&amp; 0\end{pmatrix}\]</span> é—æ†¾çš„æ˜¯ï¼Œè¿˜æ˜¯è§„ä¸å‡ºæ¥...</p><h2 id="é¢†æ‚Ÿé…å¹³">12.21é¢†æ‚Ÿé…å¹³</h2><p>åœ¨ä¸åšCryptoçš„å­¦é•¿äº¤æµä¹‹åï¼Œä»”ç»†è§‚å¯Ÿå®˜ç½‘expæ„é€ æ ¼ä¸é…å¹³æ–¹å¼ï¼Œç»ˆäºå‘ç°é—®é¢˜ï¼Œå¯¹æ ¼çš„æ„é€ ä¸é…å¹³æœ‰äº†æ–°çš„é¢†æ‚Ÿ</p><h3 id="å‡å°æ ¼çš„ç»´æ•°è§„çº¦å‡ºæ¥">å‡å°æ ¼çš„ç»´æ•°è§„çº¦å‡ºæ¥</h3><p>è§‚å¯Ÿå‘ç°ï¼Œæˆ‘çš„æ„é€ ä¸å®˜æ–¹expä¸­çš„åŒºåˆ«åœ¨äºï¼Œæˆ‘çš„æ˜¯13x13çš„ï¼Œè€Œå®ƒçš„æ˜¯12x12çš„ï¼Œæˆ‘æŠŠæˆ‘çš„æ ¼æ”¹æˆ12x12çš„ä¹‹åï¼Œå†æŒ‰ç…§å®˜æ–¹expä¸­çš„é…å¹³æ–¹å¼æ¥é…å¹³å¹¶å¹³è¡¡èŒƒæ•°ï¼Œå°±è§„çº¦å‡ºæ¥äº†ï¼Œè‡³äºä¸ºä»€ä¹ˆæ”¹å°å°±è¡Œäº†ï¼Œä¹‹åä¼šè¯´ï¼Œå…ˆçœ‹çœ‹é…å¹³çš„åŸç†</p><h3 id="ä¸ºä»€ä¹ˆè¦ä¹˜ç³»æ•°-212824...2428">ä¸ºä»€ä¹ˆè¦ä¹˜ç³»æ•° <spanclass="math inline">\(2^{128},2^4,...,2^4,2^8\)</span> ?</h3><p>è¿™ä¸ LLL æ ¼åŸºè§„çº¦ç®—æ³•çš„åŸç†æœ‰å…³ï¼Œå› ä¸º LLLè§„çº¦å‡ºæ¥çš„æ ¼åŸºå‘é‡æ¯ä¸ªåˆ†é‡ä¼šè¶‹äºç­‰å¤§æ­£äº¤ï¼Œæ‰€ä»¥é™¤äº†æœ€åä¸€ä¸ªåˆ†é‡å›ºå®šæ˜¯0ï¼Œå‰é¢çš„æ ¼åŸºåº”è¯¥è®©å…¶å°½é‡ç­‰å¤§ï¼Œæ‰€ä»¥æ‰è¦é…å¹³æˆ<span class="math display">\[\begin{pmatrix}2^4*b_{9} &amp; 2^4*b_{8} &amp; \dots &amp; 2^4*b_0 &amp; 2^8 &amp; 0\end{pmatrix}\]</span> æ‰€ä»¥å…¶å®å°±æ˜¯ <span class="math display">\[\begin{pmatrix}b_{9} &amp; b_{8} &amp; \dots &amp; b_0 &amp; 2^5 &amp; 0\end{pmatrix}\]</span>è¿™æ ·è§„çº¦å‡ºæ¥çš„æ•ˆæœä¸€æ ·ï¼Œè¿™æ ·çš„è¯è°ƒæ•´çš„å‚æ•°å°‘ä¸€ç‚¹ï¼Œä¸å¦¨ç§°è¿™ä¸ªå‚æ•°ä¸ºé…å¹³ç³»æ•°ï¼Œæ¥ä¸‹æ¥è®¨è®ºé…å¹³ç³»æ•°çš„é€‰å–</p><h3 id="è°ƒæ•´é…å¹³ç³»æ•°">è°ƒæ•´é…å¹³ç³»æ•°</h3><h4 id="æœ€ä½³é…å¹³ç³»æ•°">æœ€ä½³é…å¹³ç³»æ•°</h4><p>æœ€ä½³é…å¹³ç³»æ•°æ˜¯ <span class="math inline">\(2^5\)</span>ï¼Œè‡³äºä¸ºä»€ä¹ˆï¼Œé©¬åç‚®æ¥è¯´æ˜¯ <span class="math inline">\(b_i\)</span>åˆ†å¸ƒåœ¨ <span class="math inline">\(2^5\)</span>é™„è¿‘çš„æ–¹å·®æœ€å°ï¼Œå¦‚æœä¸çŸ¥é“ç»“æœçš„å‰æä¸‹åº”è¯¥æ˜¯æ…¢æ…¢å°è¯•å‡ºæ¥çš„</p><p>è§„çº¦å‡ºæ¥çš„ç»“æœå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[ -<span class="number">5</span>  <span class="number">41</span> -<span class="number">11</span> -<span class="number">10</span> -<span class="number">34</span>  <span class="number">18</span>   <span class="number">5</span>  -<span class="number">7</span>  <span class="number">15</span> -<span class="number">40</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">43</span>  <span class="number">17</span>   <span class="number">6</span> -<span class="number">56</span>  <span class="number">36</span> -<span class="number">13</span> -<span class="number">30</span>   <span class="number">5</span> -<span class="number">32</span>  <span class="number">12</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[  <span class="number">9</span> -<span class="number">24</span> -<span class="number">24</span>  <span class="number">43</span>   <span class="number">2</span> -<span class="number">27</span> -<span class="number">25</span>  <span class="number">37</span>  <span class="number">59</span>  <span class="number">20</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">14</span>  -<span class="number">9</span> -<span class="number">67</span>  <span class="number">10</span>  <span class="number">36</span> -<span class="number">12</span>   <span class="number">9</span>   <span class="number">1</span>   <span class="number">9</span>  <span class="number">13</span> -<span class="number">32</span>   <span class="number">0</span>] &lt;-</span><br><span class="line">[-<span class="number">18</span>  <span class="number">24</span>   <span class="number">3</span> -<span class="number">53</span> -<span class="number">12</span> -<span class="number">17</span> -<span class="number">13</span>  -<span class="number">7</span>  <span class="number">32</span>   <span class="number">9</span>  <span class="number">64</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">12</span>  -<span class="number">4</span>  -<span class="number">2</span>  <span class="number">13</span>  <span class="number">16</span> -<span class="number">18</span>  <span class="number">58</span>  <span class="number">55</span>  <span class="number">44</span>  <span class="number">10</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[ -<span class="number">9</span>  <span class="number">17</span>  <span class="number">38</span>  <span class="number">19</span> -<span class="number">50</span>   <span class="number">9</span>  <span class="number">35</span>  -<span class="number">6</span>  <span class="number">58</span>  <span class="number">19</span> -<span class="number">32</span>   <span class="number">0</span>] &lt;-</span><br><span class="line">[ -<span class="number">9</span> -<span class="number">50</span> -<span class="number">22</span> -<span class="number">34</span>  -<span class="number">3</span>  <span class="number">29</span> -<span class="number">14</span> -<span class="number">10</span>  -<span class="number">7</span> -<span class="number">50</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">32</span> -<span class="number">34</span> -<span class="number">11</span> -<span class="number">47</span>   <span class="number">5</span> -<span class="number">32</span>  <span class="number">43</span>  -<span class="number">2</span> -<span class="number">10</span> -<span class="number">12</span> -<span class="number">32</span>   <span class="number">0</span>] &lt;-</span><br><span class="line">[-<span class="number">19</span> -<span class="number">59</span>   <span class="number">5</span>  <span class="number">42</span> -<span class="number">50</span>  -<span class="number">8</span>  -<span class="number">1</span>  -<span class="number">8</span> -<span class="number">42</span> -<span class="number">22</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">19</span> -<span class="number">48</span> -<span class="number">17</span> -<span class="number">13</span> -<span class="number">13</span>  <span class="number">41</span> -<span class="number">21</span>  <span class="number">45</span>  <span class="number">28</span>  <span class="number">49</span>  <span class="number">32</span>   <span class="number">0</span>] &lt;-</span><br></pre></td></tr></table></figure><p>æ ¹æ®å€’æ•°ç¬¬äºŒåˆ—ä¸º <spanclass="math inline">\(\pm2^5\)</span>ï¼Œå¯ä»¥çœ‹åˆ°æœ‰å››ç»„è§£ï¼Œä½†å…¶å®åªæœ‰ä»¥ä¸‹ä¸‰ç»„è§£æ˜¯æ­£ç¡®çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment"># [-19, -58, 6, -35, -9, 50, -19, -38, -17, 9]</span></span><br><span class="line"><span class="comment"># 13ce3a25097efd663119</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="comment"># [12, 10, 2, -43, 32, -5, 47, 11, 34, -32]</span></span><br><span class="line"><span class="comment"># 340a0237200751376660</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="comment"># [-13, -9, -1, -9, 12, -36, -10, 67, 9, 14]</span></span><br><span class="line"><span class="comment"># 0d1b013bfc241ac5191e</span></span><br></pre></td></tr></table></figure><p>è§„å‡ºæ¥çš„å‰©ä¸‹ä¸€ç»„è§£æ˜¯é”™çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># [49, 28, 45, -21, 41, -13, -13, -17, -48, 19]</span></span><br><span class="line"><span class="comment"># 3c1d1f7513d015</span></span><br></pre></td></tr></table></figure><h4 id="ç¼©å°é…å¹³ç³»æ•°">ç¼©å°é…å¹³ç³»æ•°</h4><p>é…å¹³ç³»æ•°ä¸º <span class="math inline">\(2^4\)</span>æ—¶è§„çº¦å‡ºæ¥çš„ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[ -<span class="number">5</span>  <span class="number">41</span> -<span class="number">11</span> -<span class="number">10</span> -<span class="number">34</span>  <span class="number">18</span>   <span class="number">5</span>  -<span class="number">7</span>  <span class="number">15</span> -<span class="number">40</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">14</span>  -<span class="number">9</span> -<span class="number">67</span>  <span class="number">10</span>  <span class="number">36</span> -<span class="number">12</span>   <span class="number">9</span>   <span class="number">1</span>   <span class="number">9</span>  <span class="number">13</span> -<span class="number">16</span>   <span class="number">0</span>] &lt;-</span><br><span class="line">[  <span class="number">7</span> -<span class="number">19</span> -<span class="number">35</span> -<span class="number">20</span>  <span class="number">20</span>  -<span class="number">7</span>  <span class="number">46</span> -<span class="number">41</span>  -<span class="number">1</span>  <span class="number">30</span>  <span class="number">16</span>   <span class="number">0</span>] &lt;-</span><br><span class="line">[-<span class="number">18</span>  <span class="number">24</span>   <span class="number">3</span> -<span class="number">53</span> -<span class="number">12</span> -<span class="number">17</span> -<span class="number">13</span>  -<span class="number">7</span>  <span class="number">32</span>   <span class="number">9</span>  <span class="number">32</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">34</span>  <span class="number">10</span>  <span class="number">41</span>  <span class="number">16</span>  -<span class="number">2</span>  <span class="number">13</span>  <span class="number">18</span>   <span class="number">6</span>  -<span class="number">6</span>  <span class="number">22</span> -<span class="number">48</span>   <span class="number">0</span>] </span><br><span class="line">[ <span class="number">30</span> -<span class="number">34</span>   <span class="number">8</span>  <span class="number">13</span> -<span class="number">14</span> -<span class="number">22</span>  <span class="number">12</span>  -<span class="number">5</span>  <span class="number">49</span>  <span class="number">37</span>  <span class="number">32</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">11</span> -<span class="number">12</span>  <span class="number">27</span> -<span class="number">16</span>  <span class="number">30</span> -<span class="number">15</span>  <span class="number">14</span>  <span class="number">60</span> -<span class="number">23</span> -<span class="number">22</span>  <span class="number">32</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">25</span> -<span class="number">15</span>  <span class="number">24</span> -<span class="number">27</span> -<span class="number">15</span> -<span class="number">25</span>  -<span class="number">3</span>  <span class="number">39</span>  -<span class="number">9</span> -<span class="number">42</span> -<span class="number">32</span>   <span class="number">0</span>]</span><br><span class="line">[ -<span class="number">9</span> -<span class="number">50</span> -<span class="number">22</span> -<span class="number">34</span>  -<span class="number">3</span>  <span class="number">29</span> -<span class="number">14</span> -<span class="number">10</span>  -<span class="number">7</span> -<span class="number">50</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">37</span> -<span class="number">35</span>   <span class="number">8</span> -<span class="number">11</span> -<span class="number">62</span> -<span class="number">25</span> -<span class="number">14</span> -<span class="number">15</span> -<span class="number">10</span> -<span class="number">13</span>  <span class="number">32</span>   <span class="number">0</span>]</span><br><span class="line">[  <span class="number">0</span>  <span class="number">58</span> -<span class="number">49</span> -<span class="number">22</span> -<span class="number">10</span>  <span class="number">45</span>  <span class="number">32</span>  <span class="number">12</span>   <span class="number">0</span>  <span class="number">52</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>æœ‰ä¸¤ç»„è§£ï¼Œéƒ½æ˜¯å¯¹çš„</p><p>é…å¹³ç³»æ•°ä¸º <span class="math inline">\(2^3\)</span>æ—¶è§„çº¦å‡ºæ¥çš„ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[-<span class="number">34</span>  <span class="number">10</span>  <span class="number">41</span>  <span class="number">16</span>  -<span class="number">2</span>  <span class="number">13</span>  <span class="number">18</span>   <span class="number">6</span>  -<span class="number">6</span>  <span class="number">22</span> -<span class="number">24</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">14</span>  -<span class="number">3</span>  -<span class="number">3</span> -<span class="number">11</span> -<span class="number">45</span> -<span class="number">10</span> -<span class="number">17</span> -<span class="number">21</span>  <span class="number">14</span> -<span class="number">20</span> -<span class="number">32</span>   <span class="number">0</span>]</span><br><span class="line">[ -<span class="number">5</span>  <span class="number">41</span> -<span class="number">11</span> -<span class="number">10</span> -<span class="number">34</span>  <span class="number">18</span>   <span class="number">5</span>  -<span class="number">7</span>  <span class="number">15</span> -<span class="number">40</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">14</span>  -<span class="number">9</span> -<span class="number">67</span>  <span class="number">10</span>  <span class="number">36</span> -<span class="number">12</span>   <span class="number">9</span>   <span class="number">1</span>   <span class="number">9</span>  <span class="number">13</span>  -<span class="number">8</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">23</span> -<span class="number">14</span>  -<span class="number">2</span>  -<span class="number">1</span>  <span class="number">19</span> -<span class="number">24</span>  <span class="number">24</span>  <span class="number">46</span>  -<span class="number">6</span>  -<span class="number">7</span> -<span class="number">48</span>   <span class="number">0</span>]</span><br><span class="line">[  <span class="number">7</span> -<span class="number">19</span> -<span class="number">35</span> -<span class="number">20</span>  <span class="number">20</span>  -<span class="number">7</span>  <span class="number">46</span> -<span class="number">41</span>  -<span class="number">1</span>  <span class="number">30</span>   <span class="number">8</span>   <span class="number">0</span>] &lt;-</span><br><span class="line">[ <span class="number">11</span>  <span class="number">10</span>   <span class="number">0</span>  <span class="number">14</span>  -<span class="number">3</span>   <span class="number">6</span>  <span class="number">34</span>   <span class="number">9</span>  <span class="number">50</span>  <span class="number">17</span>  <span class="number">48</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">18</span>  <span class="number">24</span>   <span class="number">3</span> -<span class="number">53</span> -<span class="number">12</span> -<span class="number">17</span> -<span class="number">13</span>  -<span class="number">7</span>  <span class="number">32</span>   <span class="number">9</span>  <span class="number">16</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">43</span> -<span class="number">40</span>  <span class="number">19</span> -<span class="number">18</span>  -<span class="number">5</span>  <span class="number">42</span>   <span class="number">4</span>  -<span class="number">4</span> -<span class="number">13</span> -<span class="number">28</span> -<span class="number">24</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">51</span> -<span class="number">32</span>  <span class="number">11</span>   <span class="number">0</span> -<span class="number">17</span> -<span class="number">15</span>   <span class="number">3</span>   <span class="number">6</span> -<span class="number">24</span>   <span class="number">7</span>  <span class="number">48</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">53</span>  <span class="number">16</span> -<span class="number">12</span> -<span class="number">38</span> -<span class="number">10</span>  <span class="number">26</span>   <span class="number">0</span>  <span class="number">12</span> -<span class="number">18</span>  <span class="number">57</span>  <span class="number">32</span>   <span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åªå‰©ä¸€ç»„æ­£ç¡®çš„è§£äº†ï¼Œå†å¾€ä¸‹ç¼©å°ï¼Œç”¨ <spanclass="math inline">\(2^2\)</span> é…å¹³å·²ç»è§„ä¸å‡ºæ¥äº†</p><h4 id="å¢å¤§é…å¹³ç³»æ•°åŒæ—¶å‡ºç°äº†æ–°è§£">å¢å¤§é…å¹³ç³»æ•°ï¼ˆåŒæ—¶å‡ºç°äº†æ–°è§£ï¼‰</h4><p>ä½†æ˜¯ï¼Œåœ¨ä» <span class="math inline">\(2^5\)</span>å¾€ä¸Šå¢å¤§çš„æ—¶å€™å‡ºç°äº†å¦ä¸€ç»„è§£</p><p>é…å¹³ç³»æ•°ä¸º <span class="math inline">\(2^6\)</span>æ—¶è§„çº¦å‡ºæ¥çš„ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[ -<span class="number">5</span>  <span class="number">41</span> -<span class="number">11</span> -<span class="number">10</span> -<span class="number">34</span>  <span class="number">18</span>   <span class="number">5</span>  -<span class="number">7</span>  <span class="number">15</span> -<span class="number">40</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">43</span>  <span class="number">17</span>   <span class="number">6</span> -<span class="number">56</span>  <span class="number">36</span> -<span class="number">13</span> -<span class="number">30</span>   <span class="number">5</span> -<span class="number">32</span>  <span class="number">12</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[  <span class="number">9</span> -<span class="number">24</span> -<span class="number">24</span>  <span class="number">43</span>   <span class="number">2</span> -<span class="number">27</span> -<span class="number">25</span>  <span class="number">37</span>  <span class="number">59</span>  <span class="number">20</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">12</span>  -<span class="number">4</span>  -<span class="number">2</span>  <span class="number">13</span>  <span class="number">16</span> -<span class="number">18</span>  <span class="number">58</span>  <span class="number">55</span>  <span class="number">44</span>  <span class="number">10</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[ -<span class="number">9</span> -<span class="number">50</span> -<span class="number">22</span> -<span class="number">34</span>  -<span class="number">3</span>  <span class="number">29</span> -<span class="number">14</span> -<span class="number">10</span>  -<span class="number">7</span> -<span class="number">50</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">19</span> -<span class="number">59</span>   <span class="number">5</span>  <span class="number">42</span> -<span class="number">50</span>  -<span class="number">8</span>  -<span class="number">1</span>  -<span class="number">8</span> -<span class="number">42</span> -<span class="number">22</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[  <span class="number">0</span>  <span class="number">58</span> -<span class="number">49</span> -<span class="number">22</span> -<span class="number">10</span>  <span class="number">45</span>  <span class="number">32</span>  <span class="number">12</span>   <span class="number">0</span>  <span class="number">52</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">67</span>  <span class="number">13</span> -<span class="number">15</span> -<span class="number">49</span> -<span class="number">55</span>  <span class="number">16</span> -<span class="number">17</span>  -<span class="number">9</span>  -<span class="number">4</span>  <span class="number">37</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">14</span>  -<span class="number">9</span> -<span class="number">67</span>  <span class="number">10</span>  <span class="number">36</span> -<span class="number">12</span>   <span class="number">9</span>   <span class="number">1</span>   <span class="number">9</span>  <span class="number">13</span> -<span class="number">64</span>   <span class="number">0</span>] &lt;-</span><br><span class="line">[  <span class="number">7</span> -<span class="number">19</span> -<span class="number">35</span> -<span class="number">20</span>  <span class="number">20</span>  -<span class="number">7</span>  <span class="number">46</span> -<span class="number">41</span>  -<span class="number">1</span>  <span class="number">30</span>  <span class="number">64</span>   <span class="number">0</span>] &lt;-</span><br><span class="line">[ -<span class="number">9</span>  <span class="number">17</span>  <span class="number">38</span>  <span class="number">19</span> -<span class="number">50</span>   <span class="number">9</span>  <span class="number">35</span>  -<span class="number">6</span>  <span class="number">58</span>  <span class="number">19</span> -<span class="number">64</span>   <span class="number">0</span>] &lt;-</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å€’æ•°ç¬¬äºŒè¡Œå‡ºç°äº†æ–°çš„è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span></span><br><span class="line"><span class="comment"># [30, -1, -41, 46, -7, 20, -20, -35, -19, 7]</span></span><br><span class="line"><span class="comment"># 22017b720f2c6c253307</span></span><br></pre></td></tr></table></figure><p>é…å¹³ç³»æ•°ä¸º <span class="math inline">\(2^7\)</span>æ—¶è§„çº¦å‡ºæ¥çš„ç»“æœ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[ -<span class="number">5</span>  <span class="number">41</span> -<span class="number">11</span> -<span class="number">10</span> -<span class="number">34</span>  <span class="number">18</span>   <span class="number">5</span>  -<span class="number">7</span>  <span class="number">15</span> -<span class="number">40</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">43</span>  <span class="number">17</span>   <span class="number">6</span> -<span class="number">56</span>  <span class="number">36</span> -<span class="number">13</span> -<span class="number">30</span>   <span class="number">5</span> -<span class="number">32</span>  <span class="number">12</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[  <span class="number">9</span> -<span class="number">24</span> -<span class="number">24</span>  <span class="number">43</span>   <span class="number">2</span> -<span class="number">27</span> -<span class="number">25</span>  <span class="number">37</span>  <span class="number">59</span>  <span class="number">20</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">12</span>  -<span class="number">4</span>  -<span class="number">2</span>  <span class="number">13</span>  <span class="number">16</span> -<span class="number">18</span>  <span class="number">58</span>  <span class="number">55</span>  <span class="number">44</span>  <span class="number">10</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[ -<span class="number">9</span> -<span class="number">50</span> -<span class="number">22</span> -<span class="number">34</span>  -<span class="number">3</span>  <span class="number">29</span> -<span class="number">14</span> -<span class="number">10</span>  -<span class="number">7</span> -<span class="number">50</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">19</span> -<span class="number">59</span>   <span class="number">5</span>  <span class="number">42</span> -<span class="number">50</span>  -<span class="number">8</span>  -<span class="number">1</span>  -<span class="number">8</span> -<span class="number">42</span> -<span class="number">22</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[  <span class="number">0</span>  <span class="number">58</span> -<span class="number">49</span> -<span class="number">22</span> -<span class="number">10</span>  <span class="number">45</span>  <span class="number">32</span>  <span class="number">12</span>   <span class="number">0</span>  <span class="number">52</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">67</span>  <span class="number">13</span> -<span class="number">15</span> -<span class="number">49</span> -<span class="number">55</span>  <span class="number">16</span> -<span class="number">17</span>  -<span class="number">9</span>  -<span class="number">4</span>  <span class="number">37</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[-<span class="number">24</span>  -<span class="number">5</span> -<span class="number">13</span> -<span class="number">27</span>  -<span class="number">8</span> -<span class="number">20</span> -<span class="number">32</span> -<span class="number">60</span>  <span class="number">40</span>  <span class="number">71</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[ <span class="number">45</span>  <span class="number">40</span> -<span class="number">38</span> -<span class="number">42</span>  <span class="number">24</span> -<span class="number">52</span>  <span class="number">27</span>   <span class="number">7</span> -<span class="number">46</span> -<span class="number">21</span>   <span class="number">0</span>   <span class="number">0</span>]</span><br><span class="line">[  <span class="number">7</span> -<span class="number">19</span> -<span class="number">35</span> -<span class="number">20</span>  <span class="number">20</span>  -<span class="number">7</span>  <span class="number">46</span> -<span class="number">41</span>  -<span class="number">1</span>  <span class="number">30</span> <span class="number">128</span>   <span class="number">0</span>] &lt;-</span><br></pre></td></tr></table></figure><p>è¿˜å‰©ä¸€ä¸ªè¿™ä¸ªæ–°è§£</p><p>ä¸€ç›´åˆ° <span class="math inline">\(2^{63}\)</span>éƒ½æ˜¯å¯ä»¥è§„çº¦å‡ºæ¥è¿™ä¸ªè§£çš„ï¼Œè€Œè¿™ä¸ªä¸Šç•Œä¸å¹³è¡¡èŒƒæ•°ä¹˜çš„ç³»æ•°æœ‰å…³ï¼Œå¢å¤§é…å¹³ç³»æ•°ï¼Œå…¶å®å¢å¤§çš„æ˜¯æ ¼åŸºçš„æ¨¡é•¿ï¼Œè€Œå¹³è¡¡èŒƒæ•°å°±æ˜¯ä¸ºäº†è®©å¦‚æœå¢å¤§å¤ªå¤šå¯¼è‡´ä¸æ»¡è¶³Hermiteå®šç†ï¼Œä¹Ÿå°±è§„çº¦ä¸å‡ºæ¥äº†</p><p>ä¸Šé¢å°è¯•çš„è¿‡ç¨‹ä¸­ï¼Œä¹˜çš„éƒ½æ˜¯ <span class="math inline">\(MOD\)</span>ï¼Œæ‰€ä»¥è¿™ä¸ªä¸Šç•Œå°±åœ¨ <span class="math inline">\(2^{64}\)</span>é™„è¿‘ï¼Œå¦‚æœæ”¹æˆä¹˜ä»¥ <spanclass="math inline">\(2^{20}\)</span>ï¼Œé…å¹³ç³»æ•°çš„ä¸Šç•Œå°±å˜æˆäº† <spanclass="math inline">\(2^{19}\)</span></p><h2 id="é¢†æ‚Ÿæ ¼çš„æ„é€ ">12.22é¢†æ‚Ÿæ ¼çš„æ„é€ </h2><p>ç°åœ¨åªå‰©ä¸‹æœ€åä¸€ä¸ªé—®é¢˜äº†</p><blockquote><p>ä¸ºä»€ä¹ˆæˆ‘ä¹‹å‰çš„13x13çš„æ ¼å°±è§„çº¦ä¸å‡ºæ¥ï¼ŒæŠŠ <spanclass="math inline">\(-TARGERT\)</span> å’Œ <spanclass="math inline">\(h_0x^{10}\)</span>æ”¾åœ¨ä¸€èµ·å˜æˆ12x12çš„æ ¼å°±èƒ½è§„çº¦å‡ºæ¥ï¼Ÿ</p></blockquote><p>å…¶å®è¿™ä¸ªæˆ‘è¿˜ä¸æ˜¯éå¸¸æ¸…æ¥šï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç‚¹ç»™äº†æˆ‘ä¸€ç‚¹å¯å‘</p><p><img src="image-20241222125039062.png" /></p><p>è¿™æ˜¯åˆ«çš„å¸ˆå‚…çš„<ahref="https://blog.csdn.net/XiongSiqi_blog/article/details/144494152">wp</a>ï¼Œä»–çš„æ„é€ æ–¹æ³•å’Œæˆ‘ä¸€æ ·ï¼Œä¹Ÿå°±æ˜¯exp1ï¼ŒåŒæ—¶ä»–è¿˜ç”¨äº†DUCTFåŸé¢˜é‚£ä¸ªæ€è·¯åšäº†ï¼Œä¹Ÿå°±æ˜¯exp2</p><p>å¯ä»¥çœ‹åˆ°ï¼Œç”¨13ç»´çš„æ ¼èƒ½è§„çº¦å‡ºæ¥ä¸€ä¸ªè§£ï¼Œä½†ç”¨12ç»´çš„æ ¼å°±èƒ½è§„çº¦å‡ºæ¥ä¸¤ä¸ªè§£ï¼Œå¤§æ¦‚å¯ä»¥çŒœæµ‹æ„é€ çš„æ ¼çš„ç»´æ•°ä¸æœ€åè§„çº¦å‡ºæ¥çš„ç»“æœæœ‰å…³</p><blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨é€ æ ¼æ—¶ï¼Œåº”å½“åœ¨åŒ…å«ç›®æ ‡è§£çš„æƒ…å†µä¸‹ä½¿å¾—æ ¼å°½é‡çš„å°</p></blockquote><p>ç›®å‰æˆ‘æ‚Ÿé“çš„ç¨‹åº¦ä¹Ÿå°±åˆ°è¿™äº†ï¼Œå†å¤šæ²‰æ·€å§</p><p>è¿˜æœ‰å°±æ˜¯ï¼Œæ³¨æ„å¾—å¹³è¡¡èŒƒæ•°ï¼Œå¦‚æœæœ€åä¸€åˆ—ä¸ä¹˜è‡³å°‘ <spanclass="math inline">\(2^{10}\)</span>å¤§å°çš„æ•°çš„è¯ï¼Œæœ€åèƒ½è§„å‡ºæ¥çš„æ•°é‡ä¼šå‡å°‘ï¼Œç²¾åº¦ï¼ˆæœ€åå‡ ä½ï¼‰ä¹Ÿä¼šå‡ºé—®é¢˜</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> æ ¼åŸºè§„çº¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP-[2024.12CISCNåˆèµ›]rsand</title>
      <link href="/2024/12/15/2025CISCN%E5%88%9D%E8%B5%9B-rsand/"/>
      <url>/2024/12/15/2025CISCN%E5%88%9D%E8%B5%9B-rsand/</url>
      
        <content type="html"><![CDATA[<h1 id="rsand">rsand</h1><p>ç¬¬ä¸€æ®µæƒ³å¤æ‚äº†...æ— è¯­...</p><p>ç”±ä¸¤ä¸ªhint <span class="math display">\[\begin{cases}x_1p+y_1q=h_1\\x_2p+y_2q=h_2\end{cases}\]</span> æ¶ˆå» <span class="math inline">\(p\)</span> å¾—åˆ° <spanclass="math display">\[(x_2y_1-x_1y_2)q=x_2hint_1-x_1hint_2\]</span> å› ä¸º <span class="math inline">\(x_1\)</span> å’Œ <spanclass="math inline">\(x_2\)</span>çš„ä½æ•°å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥çˆ†ç ´ç­‰å¼å³è¾¹ï¼Œä¸ <spanclass="math inline">\(n\)</span> çš„æœ€å¤§å…¬å› æ•°ä¸º <spanclass="math inline">\(q\)</span></p><p>expå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">15362411588902771813202478635066445941567868219581080563115075898286474259882954338389793970699719911440130093205665853149410649953666749040198875967674392222163203507355594406743187111917695130252508256218749978621308541602497724665219449744861537283780518527254216366922466302326499402578109162330236444246061693469594478198741804520250626169244657971542999522991366630193919018630909161404721555664080170638132633626413255410410137099959334489280964350052541921478423372394540832436892310584104528058862537859512612948202958012151863722620647893665739096431795849153054455097180239006325840211260579467505866213321</span></span><br><span class="line">c = <span class="number">11002534477657652912372810848926482391887092190932469703165894690536229876745380661840257117009642277835336802865534980565178417018115086283494566571591522074247199913911415717085915100575473598649881133900396287499714340304262409043666909170720737038101830037153191272567843715155840570872019827741812315121448500605071700446687466870430406768450579933501297054990457726974127775349625204465934169150186539616296542755004869578536990613527055300928552638596456866596750833563115593781526966755165582546123990308808800667406917385312002041186603020503841256329991750190455878250894582571115111718135613960552099796906</span></span><br><span class="line">hint1 = <span class="number">2039159895585947475068088143527275690469909689185999604715451064124585853630752695470054673165419252527995240269327198412911807393416868235368504436584431412703134163959877202830050029989666528799391256150468576467273354859421767605446501398147668264017311245664408370173372269180865579591613828331745440553844035856076454341552544551052879486</span></span><br><span class="line">hint2 = <span class="number">6170476515613158918019570212115499947887402741180020964652659349816460675494790538630642858309783692527180075685596707268292572208320861367215001657838600707154243013775820727645118716675494532280326540990164077009804842182349494755380713591859893639814050512143156159959577957276848467778079473027018795376680418523444184725355227808205707370866889222282260917819411661336280572584451528321234887370803975647102920033004478195544414068866619365914629166753794432</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">hint1+=<span class="number">0x114</span></span><br><span class="line">hint2+=<span class="number">0x514</span></span><br><span class="line"><span class="keyword">for</span> x1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">11</span>):</span><br><span class="line">    <span class="keyword">for</span> x2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">11</span>):</span><br><span class="line">        res=x2*hint1-x1*hint2</span><br><span class="line">        <span class="keyword">if</span> gcd(res,n)&gt;<span class="number">1</span>:</span><br><span class="line">            q=gcd(res,n)</span><br><span class="line">            p=n//q</span><br><span class="line">            <span class="keyword">if</span> p!=<span class="number">1</span>:</span><br><span class="line">                phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">                d=<span class="built_in">pow</span>(e,-<span class="number">1</span>,phi)</span><br><span class="line">                m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ®µæç¤º <span class="math display">\[hint=(514p-114q)^{n-p-q}\bmod n\]</span> å³ <span class="math display">\[hint\equiv(514p-114q)^{\varphi(n)-1}\bmod n\]</span> ç”±è´¹é©¬å°å®šç† <span class="math display">\[(514p-114q)^{\varphi(n)}\equiv1 \bmod n\]</span> åˆ™ <span class="math display">\[hint\equiv(514p-114q)^{-1}\bmod n\]</span> å³ <span class="math display">\[514p-114q\equiv hint^{-1}\bmod n\]</span> è§£æ–¹ç¨‹å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line"></span><br><span class="line">n = <span class="number">14613502360939407863364589690812693501576922015366807002210962584460047350845537764142210352130233032135473294184344072762436542434785585224020831394084565036716418109919829033258196217882864669635415609075818243971882912549353576386629515720087100016370772011955973283744723438549870916347709178589685193909321524165748288924202669548997517884387638918344738115457689717826344603929580127755701760308381010681916266274710602238395858963186594803904347234435058557970115334425105855525301386358186797915365594182735744972183207024004366005265160795393027146790753599490397272129760611365574650461896794485251729339917</span></span><br><span class="line">c = <span class="number">1844299912672016932426822018833591085972208214783086872799988395704845279022708684226230192763503364790682896395124939765874012896515678571101394384566426713336825986122985858527735235893804112680673539457392905480276483747257452448710122851740312060422274512680127131210147225237259230461111904664003292861437196651263996367017511863966042537545885725061709851975490202090882311310946885913288853818824443330638704672526383498619649083972724846675126742542408080719532231101926732115530039151296805345109979024130657946665108954753958579773073032661897027538002118347463185013469149637882883237217493993357422403232</span></span><br><span class="line">hint = <span class="number">13881623050018793449740724432472477579431028423415489113042909440292945176076047853295489683282566216707368640412032428065710793944727730364882781802686441001675541059762893646159952263021674742992116858706764042023688870351813641289345431554332438056975389690221360841234949127345504351560719482921978464850482655935841596020088119189343494640190529315960401842837394588319749239763935273823187981223500526826390486325704018528146085661848118036219964549751708955060489798414604842478314300870914329120804301300258551132812139046559458174322633995586180526756105707630647105997143636109998519361514738555163378927000</span></span><br><span class="line"></span><br><span class="line">res=<span class="built_in">pow</span>(hint,-<span class="number">1</span>,n)</span><br><span class="line">p = Symbol(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = Symbol(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">p, q = solve([p*q-n, <span class="number">514</span>*p-<span class="number">114</span>*q-res], [p, q])[<span class="number">1</span>]</span><br><span class="line">p = <span class="built_in">int</span>(p)</span><br><span class="line">q = <span class="built_in">int</span>(q)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d=<span class="built_in">pow</span>(e,-<span class="number">1</span>,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag2=long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP-[2024.11å¼ºç½‘åˆèµ›]apbq</title>
      <link href="/2024/11/27/2024%E5%BC%BA%E7%BD%91%E5%88%9D%E8%B5%9B-apbq/"/>
      <url>/2024/11/27/2024%E5%BC%BA%E7%BD%91%E5%88%9D%E8%B5%9B-apbq/</url>
      
        <content type="html"><![CDATA[<h1 id="apbq">apbq</h1><p>ä¸‰æ®µ RSA ï¼Œç¬¬ä¸€æ®µç®€å•ï¼Œç¬¬äºŒæ®µåŸé¢˜ï¼Œç¬¬ä¸‰æ®µçº¯çº¯nt</p><h2 id="ç¬¬ä¸€æ®µ">ç¬¬ä¸€æ®µ</h2><p>ç¬¬ä¸€æ®µæ˜¯ä¸€ä¸ªå·²çŸ¥ <span class="math inline">\(p+q\)</span> çš„ RSAï¼Œå¾ˆç®€å•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p_plus_q = ...</span><br><span class="line">n = ...</span><br><span class="line">e = ...</span><br><span class="line">c = ...</span><br><span class="line"></span><br><span class="line">phi = n-p_plus_q+<span class="number">1</span></span><br><span class="line">d = <span class="built_in">pow</span>(e,-<span class="number">1</span>,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">flag1 = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"><span class="comment"># flag&#123;yOu_can_</span></span><br></pre></td></tr></table></figure><h2 id="ç¬¬äºŒæ®µ">ç¬¬äºŒæ®µ</h2><p>ç¬¬äºŒæ®µæ˜¯ <ahref="https://github.com/DownUnderCTF/Challenges_2023_Public">DownUnderCTF2023</a> åŸé¢˜ï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹å­¦ä¹ è¿‡ç¨‹</p><h3 id="apbq-rsa-i">apbq rsa i</h3><p>åŸé¢˜æ˜¯ apbq rsa ii ï¼Œæ˜¯åœ¨ apbq rsa i çš„åŸºç¡€ä¸Š</p><p>apbq rsa i é¢˜ç›®å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">hints = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    a, b = randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">12</span>), randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">312</span>)</span><br><span class="line">    hints.append(a * p + b * q)</span><br><span class="line"></span><br><span class="line">FLAG = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read().strip()</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(FLAG), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hints = &#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç»™äº†ä¸¤ä¸ªç­‰å¼ <span class="math display">\[\begin{cases}h_1=a_1p+b_1q\\h_2=a_2p+b_2q\end{cases}\]</span> æ¶ˆå»<span class="math inline">\(p\)</span> <spanclass="math display">\[a_2h_1-a_1h_2=(a_2b_1-a_1b_2)q\]</span> äºæ˜¯ <span class="math inline">\(a_2h_1-a_1h_2\)</span> æ˜¯<span class="math inline">\(q\)</span> çš„å€æ•°ï¼Œäºæ˜¯ <spanclass="math inline">\(q\)</span> æ˜¯ <spanclass="math inline">\(a_2h_1-a_1h_2\)</span> å’Œ <spanclass="math inline">\(n\)</span> çš„ <spanclass="math inline">\(gcd\)</span>ï¼Œè€Œa1å’Œa2çš„ä½æ•°å¾ˆå°ï¼Œäºæ˜¯å¯ä»¥çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = ...</span><br><span class="line">c = ...</span><br><span class="line">hints = [...]</span><br><span class="line"><span class="comment"># å‚æ•°è§åŸé¢˜</span></span><br><span class="line">h1 = hints[<span class="number">0</span>]</span><br><span class="line">h2 = hints[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> a1, a2 <span class="keyword">in</span> product(<span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>), repeat=<span class="number">2</span>):<span class="comment"># ç›¸å½“äºproduct(range(2**12), range(2**12))</span></span><br><span class="line">    q = gcd(a2 * h1 - a1 * h2, n)</span><br><span class="line">    <span class="keyword">if</span> q != <span class="number">1</span> <span class="keyword">and</span> q &lt; n:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;q found:&quot;</span>,q)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">p = n // q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = <span class="built_in">pow</span>(e,-<span class="number">1</span>,phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># DUCTF&#123;gcd_1s_a_g00d_alg0r1thm_f0r_th3_t00lbox&#125;</span></span><br></pre></td></tr></table></figure><h3 id="apbq-rsa-ii">apbq rsa ii</h3><p>æ¥ä¸‹æ¥æ˜¯ apbq rsa ii ï¼Œé¢˜ç›®å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">hints = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    a, b = randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">312</span>), randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">312</span>)</span><br><span class="line">    hints.append(a * p + b * q)</span><br><span class="line"></span><br><span class="line">FLAG = <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read().strip()</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(FLAG), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hints = &#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p>å’Œä¸Šä¸€é“å·®ä¸å¤šï¼ŒåŒºåˆ«åœ¨äºå¤šäº†ä¸€ä¸ªæç¤ºï¼ŒåŒæ—¶açš„ä½æ•°å˜å¤§äº†ï¼Œç°åœ¨å’Œbä¸€æ ·</p><p>2024.11.7 å®åœ¨çœ‹ä¸æ‡‚ï¼Œåªèƒ½å…ˆæŠŠå¤§ä½¬æ–‡ç« å…ˆç•™ä¸‹æ¥</p><p><ahref="https://blog.maple3142.net/2023/09/03/downunderctf-2023-writeups/#apbq-rsa-ii">DownUnderCTF2023 Writeups</a></p><p><ahref="https://tangcuxiaojikuai.xyz/post/df3f7032.html#more">2024-å¼ºç½‘æ¯-wp-crypto</a></p><h3 id="åˆæ­¥æ¨å¯¼">åˆæ­¥æ¨å¯¼</h3><p>å’Œä¸Šä¸€é¢˜å·®ä¸å¤šçš„æ¨å¯¼ï¼Œç”±ä¸‰ä¸ªç­‰å¼å¯ä»¥æ¶ˆå» <spanclass="math inline">\(p\)</span> å’Œ <spanclass="math inline">\(q\)</span> ä¸¤ä¸ªå˜é‡ <span class="math display">\[a_1a_3b_2h_1-a_1a_2b_3h_1-a_1a_3b_1h_2+a_1^2b_3h_2+a_1a_2b_1h_3-a_1^2b_2h_3=0\]</span> æå–å…¬å› å­ <span class="math inline">\(a_1\)</span> <spanclass="math display">\[(a_3b_2-a_2b_3)h_1+(a_1b_3-a_3b_1)h_2+(a_2b_1-a_1b_2)h_3=0\]</span> äºæ˜¯æ„é€ æ ¼ <span class="math display">\[\begin{pmatrix}a_3b_2-a_2b_3 &amp; a_1b_3-a_3b_1 &amp; a_2b_1-a_1b_2\end{pmatrix}\begin{pmatrix}    h_1 &amp; 1 &amp; 0 &amp;0 \\\\   h_2 &amp; 0 &amp; 1 &amp; 0 \\\\    h_3 &amp; 0 &amp; 0 &amp; 1\end{pmatrix}=\begin{pmatrix}0 &amp; a_3b_2-a_2b_3 &amp; a_1b_3-a_3b_1 &amp; a_2b_1-a_1b_2\end{pmatrix}\]</span> åšä¸€ä¸‹èŒƒæ•°å¹³è¡¡ï¼ŒéªŒè¯Hermiteå®šç†</p><p><img src="20240515192753-2b356060-12ae-1.png" /></p><p><span class="math display">\[||v||=\sqrt{0^2+(a_3b_2-a_2b_3)^2+(a_1b_3-a_3b_1)^2+(a_2b_1-a_1b_2)^2}\]</span> çº¦ä¸º <span class="math inline">\(312*2=624\)</span> ä½</p><p>éæ–¹é˜µçš„è¡Œåˆ—å¼è§ç¬”è®°å¦ä¸€ç¯‡ç¬”è®° <ahref="F:\Work\notes\acquisition\Lattice.md">Lattice</a> <spanclass="math display">\[det(L)=\sqrt{1+\sum_{i = 0}^{n}\alpha_i^2}=\sqrt{1+h_1^2+h_2^2+h_3^2}\]</span> çº¦ä¸º <span class="math inline">\(h_1\)</span> çš„ä½æ•°ï¼Œ<spanclass="math inline">\(1336\)</span> ä½ï¼Œæ‰€ä»¥ <spanclass="math inline">\(\sqrt {n}det(L)^\frac{1}{n}\)</span> çº¦ä¸º <spanclass="math inline">\(1336/4\approx334\)</span>ä½ï¼Œä¸æ»¡è¶³æ¡ä»¶ï¼Œäºæ˜¯ç¬¬ä¸€åˆ—ä¹˜ <spanclass="math inline">\(n\)</span>ï¼ˆé¢˜ç›®ç»™çš„ <spanclass="math inline">\(n\)</span>ï¼Œä¸æ˜¯ç»´æ•°ï¼‰</p><p>ä¹˜å®Œä¹‹åï¼Œ<span class="math inline">\(||v||\)</span> è¿˜æ˜¯ <spanclass="math inline">\(624\)</span> ä½ï¼Œ<span class="math inline">\(\sqrt{n}det(L)^\frac{1}{n}\)</span> å¢å¤§åˆ° <spanclass="math inline">\((1336+2048)/4=846\)</span> ä½ï¼Œæ»¡è¶³è¦æ±‚</p><h3 id="ç³»æ•°è°ƒæ•´">ç³»æ•°è°ƒæ•´</h3><p>å–æ ¼å‡ºæ¥çš„ç¬¬ä¸€ä¸ªè¡Œå‘é‡ï¼Œå°±æ˜¯æˆ‘ä»¬è¦çš„ <span class="math display">\[\begin{pmatrix}0 &amp; a_3b_2-a_2b_3 &amp; a_1b_3-a_3b_1 &amp;a_2b_1-a_1b_2 \end{pmatrix}\]</span> ä½†çœ‹å…¶å®ƒå¸ˆå‚…çš„åšå®¢ï¼Œè¿˜æœ‰æ­£è´Ÿå·éœ€è¦è°ƒæ•´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">_, t, u, v = L[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># therefore this should hold</span></span><br><span class="line"><span class="comment"># assert abs(a3*b2 - a2*b3) == abs(t)</span></span><br><span class="line"><span class="comment"># assert abs(a3*b1 - a1*b3) == abs(u)</span></span><br><span class="line"><span class="comment"># assert abs(a2*b1 - a1*b2) == abs(v)</span></span><br><span class="line">a1s, a2s, a3s, b1s, b2s, b3s = QQ[<span class="string">&quot;a1,a2,a3,b1,b2,b3&quot;</span>].gens()</span><br><span class="line"><span class="keyword">for</span> sign <span class="keyword">in</span> itertools.product((-<span class="number">1</span>,<span class="number">1</span>), repeat=<span class="number">3</span>):</span><br><span class="line">    I = ideal(</span><br><span class="line">        [</span><br><span class="line">            a3s * b2s - a2s * b3s + sign[<span class="number">0</span>] * t,</span><br><span class="line">            a3s * b1s - a1s * b3s + sign[<span class="number">1</span>] * u,</span><br><span class="line">            a2s * b1s - a1s * b2s + sign[<span class="number">2</span>] * v,</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> I.dimension() != -<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(sign)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;dim&quot;</span>, I.dimension())</span><br></pre></td></tr></table></figure><h3 id="groebner-basis">groebner basis</h3><p>ç°åœ¨å¾—åˆ°äº†ç†æƒ³ <span class="math display">\[(a3s * b2s - a2s * b3s - t, a3s * b1s - a1s * b3s + u, a2s * b1s - a1s *b2s - v)\]</span> åš groebner_basis...</p><p>é¢é¢ï¼Œä»€ä¹ˆæ˜¯ groebner_basisï¼Ÿ</p><p>å…ˆå‚è€ƒä»¥ä¸‹å‡ ç¯‡æ–‡ç« ï¼Œå­¦ä¹ äº†ä¸€ä¸‹groebner basis</p><p>https://www.cnblogs.com/ZimaBlue/articles/16927952.html</p><p>https://zhuanlan.zhihu.com/p/262906557</p><p>groebner basiså®šä¹‰å³</p><p><img src="image-20241108000700917.png" /></p><p>å…¶ä¸­ï¼Œ<code>S-polynomial</code>å‡½æ•°çš„å®šä¹‰ä¸º</p><p><img src="image-20241108002154475.png" /></p><p>å³ groebner basisï¼ˆæœ¬èº«æ˜¯ä¸€ä¸ªç”Ÿæˆå…ƒç»„ï¼‰ä¸­çš„ç”Ÿæˆå…ƒå‡æ»¡è¶³ï¼šå¯¹ä»»æ„ä¸¤ä¸ªç”Ÿæˆå…ƒï¼ŒäºŒè€…é¦–é¡¹çš„æœ€å°å…¬å€é¡¹é™¤ä»¥å„è‡ªçš„é¦–é¡¹åä¹˜ä»¥è‡ªå·±æœ¬èº«ï¼Œå¾—åˆ°çš„é¡¹ç›¸å‡ï¼Œä¹Ÿå°±æ˜¯<code>S-polynomial</code>å‡½æ•°çš„ç»“æœï¼Œèƒ½å¤Ÿæ•´é™¤groebner basis è‡ªå·±</p><p>æˆ‘è‡ªå·±çš„è®¤è¯†æ˜¯ï¼š</p><p>é€šè¿‡åš groebner basisï¼Œå¯ä»¥å°†å¤æ‚çš„ç­‰å¼æŒ‰ç…§å˜é‡è¿›è¡Œå‰¥ç¦»ï¼Œå¾—åˆ°æ›´â€œå¹²å‡€â€çš„å…³ç³»</p><p>åœ¨æœ¬é¢˜ä¸­ï¼Œå¯¹ç†æƒ³ I åš groebner basisåï¼Œå¯ä»¥å¾—åˆ°ä¸‰ä¸ªæ›´ç®€å•çš„ç­‰å¼ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªç­‰å¼æ˜¯ä¸€ä¸ª <spanclass="math inline">\(k_1a_1+k_2a_2+k_3a_3=0\)</span>çš„ç®€å•ç­‰å¼ï¼Œç¬¬ä¸‰ä¸ªç­‰å¼æ˜¯ä¸€ä¸ª <spanclass="math inline">\(k_1b_1+k_2b_2+k_3b_3=0\)</span> çš„ç®€å•ç­‰å¼</p><p><img src="image-20241108004324576.png" /></p><h3 id="åç»­">åç»­</h3><p>æ¥ä¸‹æ¥ï¼Œç”¨è¿™ä¸¤ä¸ªç­‰å¼ï¼Œæˆ‘ä»¬å†LLLè§„ä¸€æ¬¡å³å¯ <spanclass="math display">\[\begin{pmatrix} a_1 &amp; a_2 &amp;a_3 \end{pmatrix}\begin{pmatrix}    k_1 &amp; 1 &amp; 0 &amp;0 \\\\   k_2 &amp; 0 &amp; 1&amp; 0 \\\\    k_3 &amp; 0 &amp; 0 &amp; 1\end{pmatrix} =\begin{pmatrix}0 &amp; a_1 &amp; a_2 &amp; a_3\end{pmatrix}\]</span> å¯¹<span class="math inline">\(b_1ã€b_2ã€b_3\)</span>ä¹ŸåŒç†</p><p>è¿™ä¸ªæ ¼æ»¡è¶³Hermiteå®šç†ï¼Œèƒ½ç›´æ¥è§„å‡ºæ¥ç»“æœï¼Œç”¨è§„å‡ºæ¥çš„ <spanclass="math inline">\(a_1ã€a_2å’Œa_3\)</span> ï¼Œæ¥ä¸‹æ¥ç”¨ apbq rsa içš„æ€è·¯è§£å³å¯</p><p>2024.11.13åŸwpéƒ¨åˆ†å¦‚ä¸‹ï¼Œå…¶ä¸­çš„çº¿æ€§ç»„åˆæˆ‘æ²¡ç†è§£æ˜¯å¹²å•¥çš„ï¼Œç»„åˆçš„ç³»æ•°èŒƒå›´ä¹Ÿä¸çŸ¥é“æ€ä¹ˆå®šçš„ï¼Œåæ­£æˆ‘è§„å‡ºæ¥çš„ç»“æœå¯ä»¥ç›´æ¥ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">xs = []</span><br><span class="line"><span class="keyword">for</span> c1, c2 <span class="keyword">in</span> product((-<span class="number">2</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>), repeat=<span class="number">2</span>):</span><br><span class="line">v = c1 * v1 + c2 * v2</span><br><span class="line">    _, x1, x2, x3 = v</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>([<span class="number">0</span> &lt;= x &lt;= <span class="number">2</span>**<span class="number">312</span> <span class="keyword">for</span> x <span class="keyword">in</span> (x1, x2, x3)]):</span><br><span class="line">    xs.append((x1, x2, x3))</span><br><span class="line"><span class="comment"># we don&#x27;t know which one is correct pair of (a1, a2, a3) and (b1, b2, b3)</span></span><br><span class="line"><span class="comment"># just try all combinations</span></span><br><span class="line"><span class="keyword">for</span> g1, g2 <span class="keyword">in</span> combinations(xs, <span class="number">2</span>):</span><br><span class="line">a1r, a2r, a3r = g1</span><br><span class="line">b1r, b2r, b3r = g2</span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œæˆ‘è¿˜åšäº†éªŒè¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> c1, c2 <span class="keyword">in</span> itertools.product((<span class="number">0</span>, <span class="number">1</span>), repeat=<span class="number">2</span>):</span><br><span class="line">    v = c1 * v1 + c2 * v2</span><br><span class="line">    _, x1, x2, x3 = v</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;c1: <span class="subst">&#123;c1&#125;</span>, c2:<span class="subst">&#123;c2&#125;</span>, v:<span class="subst">&#123;v&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>([<span class="number">0</span> &lt;= x &lt;= <span class="number">2</span>**<span class="number">312</span> <span class="keyword">for</span> x <span class="keyword">in</span> (x1, x2, x3)]):</span><br><span class="line">        xs.append((x1, x2, x3))</span><br><span class="line"><span class="comment"># we don&#x27;t know which one is correct pair of (a1, a2, a3) and (b1, b2, b3)</span></span><br><span class="line"><span class="comment"># just try all combinations</span></span><br><span class="line"><span class="keyword">for</span> g1, g2 <span class="keyword">in</span> itertools.combinations(xs, <span class="number">2</span>):</span><br><span class="line">a1r, a2r, a3r = g1</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;g1:&quot;</span>,g1)</span><br><span class="line">b1r, b2r, b3r = g2</span><br></pre></td></tr></table></figure><p>å¯ä»¥æ ¹æ®ä¸‹é¢çš„æ‰“å°è°ƒè¯•ä¿¡æ¯çŸ¥é“ï¼Œéå†å‡ºæ¥çš„ç»“æœï¼Œç³»æ•°å…¶å®å°±æ˜¯1å’Œ0ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥ç”¨è§„å‡ºæ¥çš„ç»“æœ</p><p><img src="image-20241113175839401.png" /></p><p>æˆ‘è‡ªå·±è°ƒæ•´è¿‡çš„expå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = ...</span><br><span class="line">c = ...</span><br><span class="line">hints = [...]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># assert a2 * h1 - a1 * h2 == (a2 * b1 - a1 * b2) * q</span></span><br><span class="line"><span class="comment"># assert a3 * h1 - a1 * h3 == (a3 * b1 - a1 * b3) * q</span></span><br><span class="line"><span class="comment"># assert (a3 * b1 - a1 * b3) * (a2 * h1 - a1 * h2) == (a2 * b1 - a1 * b2) * (a3 * h1 - a1 * h3)</span></span><br><span class="line"><span class="comment"># so: a1*a3*b2*h1 - a1*a2*b3*h1 - a1*a3*b1*h2 + a1^2*b3*h2 + a1*a2*b1*h3 - a1^2*b2*h3 == 0</span></span><br><span class="line"><span class="comment"># we try to use LLL to find them</span></span><br><span class="line"></span><br><span class="line">h1, h2, h3 = hints</span><br><span class="line">L = matrix(hints).T.augment(matrix.identity(<span class="number">3</span>))</span><br><span class="line">L[:, <span class="number">0</span>] *= n</span><br><span class="line">L = L.LLL()</span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> L:</span><br><span class="line">    <span class="built_in">print</span>(v)</span><br><span class="line">    <span class="built_in">print</span>([<span class="built_in">int</span>(x).bit_length() <span class="keyword">for</span> x <span class="keyword">in</span> v])</span><br><span class="line"></span><br><span class="line"><span class="comment"># the expected vector is (a1*a3*b1-a1*a2*b3, -a1*a3*b1+a1**2*b3, a1*a2*b1-a1**2*b2)</span></span><br><span class="line"><span class="comment"># but we can see that a1 divides all of them</span></span><br><span class="line"><span class="comment"># assuming gcd(gcd((a1*a3*b2-a1*a2*b3), (-a1*a3*b1+a1**2*b3)), (a1*a2*b1-a1**2*b2)) == 1 here</span></span><br><span class="line"><span class="comment"># the shortest vector should be (a3*b2-a2*b3, -a3*b1+a1*b3, a2*b1-a1*b2)</span></span><br><span class="line"></span><br><span class="line">_, t, u, v = L[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># therefore this should hold</span></span><br><span class="line"><span class="comment"># assert abs(a3*b2 - a2*b3) == abs(t)</span></span><br><span class="line"><span class="comment"># assert abs(a3*b1 - a1*b3) == abs(u)</span></span><br><span class="line"><span class="comment"># assert abs(a2*b1 - a1*b2) == abs(v)</span></span><br><span class="line">a1s, a2s, a3s, b1s, b2s, b3s = QQ[<span class="string">&quot;a1,a2,a3,b1,b2,b3&quot;</span>].gens()</span><br><span class="line"><span class="keyword">for</span> sign <span class="keyword">in</span> itertools.product((-<span class="number">1</span>,<span class="number">1</span>), repeat=<span class="number">3</span>):</span><br><span class="line">    I = ideal(</span><br><span class="line">        [</span><br><span class="line">            a3s * b2s - a2s * b3s + sign[<span class="number">0</span>] * t,</span><br><span class="line">            a3s * b1s - a1s * b3s + sign[<span class="number">1</span>] * u,</span><br><span class="line">            a2s * b1s - a1s * b2s + sign[<span class="number">2</span>] * v,</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">if</span> I.dimension() != -<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(sign)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;dim&quot;</span>, I.dimension())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;groebner_basis&quot;</span>,I.groebner_basis())</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">step2</span>(<span class="params">f</span>):</span><br><span class="line">            <span class="comment"># this f is in the form of k1*a1+k2*a2+k3*a3==0</span></span><br><span class="line">            <span class="comment"># for some reason, k1*b1+k2*b2+k3*b3==0 also holds</span></span><br><span class="line">            <span class="comment"># use LLL to find it</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">40</span>)</span><br><span class="line">            <span class="built_in">print</span>(f)</span><br><span class="line">            L = matrix(f.coefficients()).T.augment(matrix.identity(<span class="number">3</span>))</span><br><span class="line">            L[:, <span class="number">0</span>] *= n</span><br><span class="line">            L = L.LLL()</span><br><span class="line">            <span class="built_in">print</span>(L[<span class="number">0</span>])</span><br><span class="line">            <span class="built_in">print</span>(L[<span class="number">1</span>])</span><br><span class="line">            _ , a1r, a2r, a3r = L[<span class="number">0</span>]</span><br><span class="line">            q = gcd(a2r * h1 - a1r * h2, n)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> &lt; q &lt; n:</span><br><span class="line">                p = n // q</span><br><span class="line">                e = <span class="number">0x10001</span></span><br><span class="line">                d = inverse_mod(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">                m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">                flag = <span class="built_in">int</span>(m).to_bytes(<span class="number">1024</span>, <span class="string">&quot;big&quot;</span>).strip(<span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                exit()</span><br><span class="line"></span><br><span class="line">        step2(I.groebner_basis()[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># DUCTF&#123;0rtho_l4tt1c3_1s_a_fun_and_gr34t_t3chn1que_f0r_the_t00lbox!&#125;</span></span><br></pre></td></tr></table></figure><p>åŸexpæœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼Œä¸€ä¸ªæ˜¯ä¸‹é¢è¿™ä¸ªè°ƒè¯•æ‰“å°çš„åœ°æ–¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> L:</span><br><span class="line">    <span class="built_in">print</span>(v)</span><br><span class="line">    <span class="built_in">print</span>([x.bit_length() <span class="keyword">for</span> x <span class="keyword">in</span> v])</span><br></pre></td></tr></table></figure><p>è¦æ”¹æˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> L:</span><br><span class="line">    <span class="built_in">print</span>(v)</span><br><span class="line">    <span class="built_in">print</span>([<span class="built_in">int</span>(x).bit_length() <span class="keyword">for</span> x <span class="keyword">in</span> v])</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¯ç”¨<code>product</code>å‡½æ•°éå†çš„æ—¶å€™ä¼šæŠ¥é”™<code>'int' object is not iterable sage</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> sign <span class="keyword">in</span> product((-<span class="number">1</span>,<span class="number">1</span>), repeat=<span class="number">3</span>):</span><br><span class="line">    I = ideal(</span><br><span class="line">        [</span><br><span class="line">            a3s * b2s - a2s * b3s + sign[<span class="number">0</span>] * t,</span><br><span class="line">            a3s * b1s - a1s * b3s + sign[<span class="number">1</span>] * u,</span><br><span class="line">            a2s * b1s - a1s * b2s + sign[<span class="number">2</span>] * v,</span><br><span class="line">        ]</span><br><span class="line">    )</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªé—®é¢˜å›°æ‰°æˆ‘æŒºä¹…çš„ï¼Œæˆ‘æŠŠæ•°æ®ç±»å‹æ¢æ¥æ¢å»éƒ½ä¸å¯¹ï¼Œåæ¥æŸ¥çœ‹äº†<code>product</code>çš„ç±»å‹ï¼Œä¹Ÿæ˜¯<code>function</code>ï¼Œä½†ä¸‡ä¸‡æ²¡æƒ³åˆ°åŸæ¥è¿™é‡Œçš„<code>function</code>ä¸æ˜¯é¢„æœŸçš„<code>function</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;function symbolic_prod at <span class="number">0x7f2ea9d2f8b0</span>&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>product</code>å‡½æ•°å·²ç»å˜æˆäº†<code>symbolic_prod</code>ï¼Œè€Œè¿™æ˜¯ä¸€ä¸ªsageé‡Œçš„å‡½æ•°</p><p><img src="image-20241107003546061.png" /></p><p>å› ä¸ºè¿™é‡Œæœ¬æ„æ˜¯ä½¿ç”¨pythoné‡Œçš„<code>product</code>å‡½æ•°ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªsageè„šæœ¬ï¼Œåœ¨sageç¯å¢ƒé‡Œè·‘çš„æ—¶å€™ï¼Œä¼šä½¿ç”¨sageé‡Œé¢çš„åŒåå‡½æ•°ï¼Œæ‰€ä»¥ä¼šæŠ¥å‚æ•°é”™è¯¯</p><p><img src="image-20241107001855660.png" /></p><p>è§£å†³åŠæ³•å¾ˆç®€å•ï¼Œåœ¨å¯¼å…¥<code>product</code>å‡½æ•°çš„æ—¶å€™æ¢ä¸ªåå­—å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product <span class="keyword">as</span> it_product</span><br></pre></td></tr></table></figure><p>ç„¶ååé¢åœ¨ä½¿ç”¨<code>product</code>çš„åœ°æ–¹ä¿®æ”¹ä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> sign <span class="keyword">in</span> it_product((-<span class="number">1</span>,<span class="number">1</span>), repeat=<span class="number">3</span>):</span><br></pre></td></tr></table></figure><p>æˆ–è€…æ˜¯æŒ‡å®šä¸€ä¸‹ä½¿ç”¨çš„æ˜¯<code>itertools</code>åº“ä¸­çš„<code>product</code>å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> sign <span class="keyword">in</span> itertools.product((-<span class="number">1</span>,<span class="number">1</span>), repeat=<span class="number">3</span>):</span><br></pre></td></tr></table></figure><p>è¿™æ ·çš„è¯å¯¼å…¥çš„æ—¶å€™å°±è¦æ”¹æˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br></pre></td></tr></table></figure><h3 id="å¦ä¸€ç‰ˆ-exp">å¦ä¸€ç‰ˆ exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># n, c, hints</span></span><br><span class="line"><span class="built_in">exec</span>(<span class="built_in">open</span>(<span class="string">&#x27;../src/output.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line">V = hints</span><br><span class="line">k = <span class="number">2</span>^<span class="number">800</span></span><br><span class="line">M = Matrix.column([k * v <span class="keyword">for</span> v <span class="keyword">in</span> V]).augment(Matrix.identity(<span class="built_in">len</span>(V)))</span><br><span class="line">B = [b[<span class="number">1</span>:] <span class="keyword">for</span> b <span class="keyword">in</span> M.LLL()]</span><br><span class="line">M = (k * Matrix(B[:<span class="built_in">len</span>(V)-<span class="number">2</span>])).T.augment(Matrix.identity(<span class="built_in">len</span>(V)))</span><br><span class="line">B = [b[-<span class="built_in">len</span>(V):] <span class="keyword">for</span> b <span class="keyword">in</span> M.LLL() <span class="keyword">if</span> <span class="built_in">set</span>(b[:<span class="built_in">len</span>(V)-<span class="number">2</span>]) == &#123;<span class="number">0</span>&#125;]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s, t <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">4</span>), repeat=<span class="number">2</span>):</span><br><span class="line">    T = s*B[<span class="number">0</span>] + t*B[<span class="number">1</span>]</span><br><span class="line">    a1, a2, a3 = T</span><br><span class="line">    kq = gcd(a1 * hints[<span class="number">1</span>] - a2 * hints[<span class="number">0</span>], n)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> &lt; kq &lt; n:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;find!&#x27;</span>, kq, s, t)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>, <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> kq % i == <span class="number">0</span>:</span><br><span class="line">        kq //= i</span><br><span class="line">q = <span class="built_in">int</span>(kq)</span><br><span class="line">p = <span class="built_in">int</span>(n // kq)</span><br><span class="line">d = <span class="built_in">pow</span>(<span class="number">0x10001</span>, -<span class="number">1</span>, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>å…¶å®æ€è·¯å·®ä¸å¤šï¼Œè¿™æ®µé‡Œé¢çš„çº¿æ€§ç»„åˆä¹Ÿå¯ä»¥å»æ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">n = ...</span><br><span class="line">c = ...</span><br><span class="line">hints = [...]</span><br><span class="line"></span><br><span class="line">V = hints</span><br><span class="line">k = <span class="number">2</span>^<span class="number">800</span></span><br><span class="line"></span><br><span class="line">M = Matrix.column([k * v <span class="keyword">for</span> v <span class="keyword">in</span> V]).augment(Matrix.identity(<span class="built_in">len</span>(V)))</span><br><span class="line"><span class="built_in">print</span>(M.LLL())</span><br><span class="line">B = [b[<span class="number">1</span>:] <span class="keyword">for</span> b <span class="keyword">in</span> M.LLL()]</span><br><span class="line">M = (k * Matrix(B[:<span class="built_in">len</span>(V)-<span class="number">2</span>])).T.augment(Matrix.identity(<span class="built_in">len</span>(V)))</span><br><span class="line"><span class="built_in">print</span>(M.LLL())</span><br><span class="line">B = [b[<span class="number">1</span>:] <span class="keyword">for</span> b <span class="keyword">in</span> M.LLL() <span class="keyword">if</span> <span class="built_in">set</span>(b[:<span class="number">1</span>]) == &#123;<span class="number">0</span>&#125;]</span><br><span class="line"><span class="built_in">print</span>(B)</span><br><span class="line"></span><br><span class="line">a1, a2, a3 = B[<span class="number">0</span>]</span><br><span class="line">kq = gcd(a1 * hints[<span class="number">1</span>] - a2 * hints[<span class="number">0</span>], n)</span><br><span class="line"><span class="keyword">if</span> <span class="number">1</span> &lt; kq &lt; n:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;find!&#x27;</span>, kq)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>, <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> kq % i == <span class="number">0</span>:</span><br><span class="line">        kq //= i</span><br><span class="line">q = <span class="built_in">int</span>(kq)</span><br><span class="line">p = <span class="built_in">int</span>(n // kq)</span><br><span class="line">d = <span class="built_in">pow</span>(<span class="number">0x10001</span>, -<span class="number">1</span>, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m)).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="å›åˆ°è¿™é“é¢˜ç›®">å›åˆ°è¿™é“é¢˜ç›®</h3><p>è¿™é“é¢˜å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯3ç»„å˜æˆäº†100ç»„</p><p>1ã€2ä¸ä»»ä¸€å…¶å®ƒç­‰å¼è”ç«‹å¾—åˆ° <span class="math display">\[(a_ib_2-a_2b_i)h_1+(a_1b_i-a_ib_1)h_2+(a_2b_1-a_1b_2)h_i=0\]</span> æ„é€ æ ¼å¦‚ä¸‹ <span class="math display">\[\begin{pmatrix}a_2b_1-a_1b_2 &amp; a_3b_2-a_2b_3 &amp; a_1b_3-a_3b_1 &amp;a_4b_2-a_2b_4 &amp; a_1b_4-a_4b_1 &amp; \dots &amp;a_{100}b_2-a_2b_{100} &amp; a_1b_{100}-a_{100}b_1\end{pmatrix}\begin{pmatrix}1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0&amp; h_3 &amp; h_4 &amp; h_5 &amp; \dots &amp; h_{100}\\\\0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0&amp; h_1 &amp; 0 &amp; 0 &amp; \dots &amp; 0\\\\0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0&amp; h_2 &amp; 0 &amp; 0 &amp; \dots &amp; 0\\\\0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0&amp; 0 &amp; h_1 &amp; 0 &amp; \dots &amp; 0\\\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; 0&amp; 0 &amp; h_2 &amp; 0 &amp; \dots &amp; 0\\\\\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots&amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp;\vdots &amp; \vdots &amp; \vdots\\\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 1 &amp; 0&amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; h_1\\\\0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 1&amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; h_2\end{pmatrix}=\begin{pmatrix}a_2b_1-a_1b_2 &amp; a_3b_2-a_2b_3 &amp; a_1b_3-a_3b_1 &amp;a_4b_2-a_2b_4 &amp; a_1b_4-a_4b_1 &amp; \dots &amp;a_{100}b_2-a_2b_{100} &amp; a_1b_{100}-a_{100}b_1 &amp; 0 &amp; \dots&amp; 0\end{pmatrix}\]</span></p><p>å¹³è¡¡èŒƒæ•°å’Œä¹‹å‰ä¸€æ ·ï¼Œè§„å‡ºæ¥ä¹‹åï¼Œå°±å’Œé‚£ä¸ªé¢˜ä¸€æ ·äº†</p><p><ahref="https://tangcuxiaojikuai.xyz/post/df3f7032.html#more">å¤§ä½¬çš„exp</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#stage2</span></span><br><span class="line"><span class="keyword">from</span> re <span class="keyword">import</span> findall</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> check_output</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flatter</span>(<span class="params">M</span>):</span><br><span class="line">    <span class="comment"># compile https://github.com/keeganryan/flatter and put it in $PATH</span></span><br><span class="line">    z = <span class="string">&quot;[[&quot;</span> + <span class="string">&quot;]\n[&quot;</span>.join(<span class="string">&quot; &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, row)) <span class="keyword">for</span> row <span class="keyword">in</span> M) + <span class="string">&quot;]]&quot;</span></span><br><span class="line">    ret = check_output([<span class="string">&quot;flatter&quot;</span>], <span class="built_in">input</span>=z.encode())</span><br><span class="line">    <span class="keyword">return</span> matrix(M.nrows(), M.ncols(), <span class="built_in">map</span>(<span class="built_in">int</span>, findall(<span class="string">b&quot;-?\\d+&quot;</span>, ret)))</span><br><span class="line"></span><br><span class="line">hint2 =</span><br><span class="line">n2, e2 = (<span class="number">73566307488763122580179867626252642940955298748752818919017828624963832700766915409125057515624347299603944790342215380220728964393071261454143348878369192979087090394858108255421841966688982884778999786076287493231499536762158941790933738200959195185310223268630105090119593363464568858268074382723204344819</span>, <span class="number">65537</span>)</span><br><span class="line">enc2 = <span class="number">30332590230153809507216298771130058954523332140754441956121305005101434036857592445870499808003492282406658682811671092885592290410570348283122359319554197485624784590315564056341976355615543224373344781813890901916269854242660708815123152440620383035798542275833361820196294814385622613621016771854846491244</span></span><br><span class="line"></span><br><span class="line">h = hint2</span><br><span class="line">nums = <span class="number">98</span></span><br><span class="line">L = Matrix(ZZ, <span class="number">1</span>+nums*<span class="number">2</span>, <span class="number">1</span>+nums*<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>+nums*<span class="number">2</span>):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nums):</span><br><span class="line">    L[<span class="number">0</span>,<span class="number">1</span>+nums*<span class="number">2</span>+i] = h[i+<span class="number">2</span>]</span><br><span class="line">    L[<span class="number">2</span>*i+<span class="number">1</span>,<span class="number">1</span>+nums*<span class="number">2</span>+i] = h[<span class="number">0</span>]</span><br><span class="line">    L[<span class="number">2</span>*i+<span class="number">2</span>,<span class="number">1</span>+nums*<span class="number">2</span>+i] = h[<span class="number">1</span>]</span><br><span class="line">L[:,-nums:] *= <span class="number">2</span>^<span class="number">512</span></span><br><span class="line">L = flatter(L)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åé¢å’Œapbq rsa iiçš„ä¸€æ ·</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç”¨çš„æ˜¯<ahref="https://github.com/keeganryan/flatter">flatter</a>æ¥åšæ ¼åŸºè§„çº¦ï¼Œä¼šæ›´å¿«ä¸€ç‚¹ï¼Œç”¨æ™®é€šçš„LLLä¹Ÿå¯ä»¥çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">L[:,-nums:] *= <span class="number">2</span>^<span class="number">512</span></span><br><span class="line">L = L.LLL()</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„ï¼Œè¿™æ®µexpé‡Œstep2éƒ¨åˆ†ä¹Ÿå¯ä»¥åƒä¹‹å‰è¯´çš„ä¸€æ ·ï¼Œçº¿æ€§ç»„åˆéƒ¨åˆ†ä¹Ÿå¯ä»¥å»æ‰</p><h3 id="è¿™é“é¢˜çš„å¦ä¸€ç§è§£æ³•æ­£äº¤æ ¼">è¿™é“é¢˜çš„å¦ä¸€ç§è§£æ³•â€”â€”æ­£äº¤æ ¼</h3><p>å…¶å®å¦‚æœç›´æ¥é¡ºç€ apbq rsa ii çš„æ€è·¯æ¥ï¼Œåº”è¯¥å¯ä»¥å¾—åˆ°ä¸‹é¢è¿™ä¸ªç­‰å¼</p>ï¼ˆ<span class="math inline">\(h_1\sim h_{100}\)</span>æ”¾åœ¨ç¬¬ä¸€åˆ—å’Œæœ€åä¸€åˆ—ä¸€æ ·) <span class="math display">\[\begin{pmatrix}a_3b_2-a_2b_3 &amp; a_1b_3-a_3b_1 &amp; a_2b_1-a_1b_2 &amp;0 &amp; 0&amp;\dots &amp; 0 \\\\a_4b_2-a_2b_4 &amp; a_1b_4-a_4b_1 &amp;0 &amp; a_2b_1-a_1b_2 &amp; 0&amp;\dots &amp; 0\\\\\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots&amp;\vdots\\\\a_{100}b_2-a_2b_{100} &amp; a_1b_{100}-a_{100}b_1 &amp;0 &amp;\dots&amp;\dots &amp;\dots &amp; a_2b_1-a_1b_2\end{pmatrix}\begin{pmatrix}1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; h_1\\\\0 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; h_2\\\\0 &amp; 0 &amp; 1 &amp; \dots &amp; 0 &amp; h_3\\\\\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots\\\\0 &amp; 0 &amp; 0 &amp; \dots &amp; 1 &amp; h_{100}\end{pmatrix}=\begin{pmatrix}a_3b_2-a_2b_3 &amp; a_1b_3-a_3b_1 &amp; a_2b_1-a_1b_2 &amp; 0 &amp; 0&amp; \dots &amp; 0 &amp; 0\\\\a_4b_2-a_2b_4 &amp; a_1b_4-a_4b_1 &amp;0 &amp; a_2b_1-a_1b_2 &amp; 0&amp; \dots &amp; 0 &amp; 0\\\\\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots&amp; \vdots &amp; \vdots\\\\a_{100}b_2-a_2b_{100} &amp; a_1b_{100}-a_{100}b_1 &amp;0 &amp;\dots&amp;\dots &amp;\dots &amp; a_2b_1-a_1b_2 &amp; 0\end{pmatrix}\]</span>ç”±äºæ ¼çš„å­¦ä¹ ä¸æ˜¯å¾ˆç³»ç»Ÿï¼Œæˆ‘é”™è¯¯åœ°ä»¥ä¸ºè¿™ä¸ªæ˜¯ä¸Šä¸€ç§æ„é€ æ ¼çš„æ–¹å¼ï¼Œç›´æ¥è®¤ä¸ºå¯¹$$<span class="math display">\[\begin{pmatrix}1 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; h_1 \\\\0 &amp; 1 &amp; 0 &amp; \dots &amp; 0 &amp; h_2\\\\\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp;\vdots\\\\0 &amp; 0 &amp; 0 &amp; \dots &amp; 1 &amp; h_{100}\end{pmatrix}\]</span><span class="math display">\[æ ¼åŸºè§„çº¦åçš„ç»“æœï¼Œç¬¬ä¸€ä¸ªè¡Œå‘é‡å°±æ˜¯\]</span><span class="math display">\[\begin{pmatrix}a_3b_2-a_2b_3 &amp; a_1b_3-a_3b_1 &amp; a_2b_1-a_1b_2 &amp; 0 &amp; 0&amp; \dots &amp; 0 &amp; 0\end{pmatrix}\]</span><p>$$ å®é™…ä¸Šä¸æ˜¯è¿™æ ·çš„ï¼Œè¿™ä¸ªç­‰å¼æ˜¯ç”¨æ¥åšæ­£äº¤æ ¼çš„</p><h4 id="æ­£äº¤æ ¼å­¦ä¹ ">æ­£äº¤æ ¼å­¦ä¹ </h4><p>å¼ºçƒˆæ¨èçš„å¤§ä½¬ï¼Œä¸€ç›´åœ¨æŒç»­æ›´æ–°</p><p><ahref="https://tangcuxiaojikuai.xyz/post/187210a7.html">Cryptoè¶£é¢˜-æ›²çº¿</a></p><h4 id="å³æ ¸å­¦ä¹ ">å³æ ¸å­¦ä¹ </h4><h5 id="å³æ ¸çš„å®šä¹‰">å³æ ¸çš„å®šä¹‰</h5><p>å¯¹äºçŸ©é˜µ <span class="math inline">\(M\)</span>ï¼ˆå½¢çŠ¶ä¸º <spanclass="math inline">\(m \times n\)</span>ï¼‰ï¼Œå³æ ¸æ˜¯æ‰€æœ‰ä½¿å¾— <spanclass="math inline">\(M \cdot \mathbf{v} = 0\)</span> çš„å‘é‡ <spanclass="math inline">\(\mathbf{v}\)</span> çš„é›†åˆï¼Œå³ <spanclass="math display">\[\text{Ker}(M) = \{\mathbf{v} \in \mathbb{R}^n \ | \ M \cdot \mathbf{v} =\mathbf{0} \}\]</span> å³æ ¸æ˜¯ä¸€ä¸ªå‘é‡ç©ºé—´ï¼Œå› æ­¤å®ƒæœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p><ul><li>å®ƒçš„ç»´åº¦ç§°ä¸ºå³æ ¸çš„ç»´æ•°ï¼Œç”±ç»´æ•°å®šç†ï¼ˆRank-Nullity Theoremï¼‰ ç¡®å®š</li><li>å³æ ¸ç©ºé—´çš„åŸºæ˜¯ä¸€ç»„çº¿æ€§æ— å…³çš„å‘é‡ï¼Œå¯ä»¥ç”Ÿæˆæ•´ä¸ªå³æ ¸ç©ºé—´</li></ul><p>è¦çŸ¥é“æ»¡è¶³æ¡ä»¶ <span class="math inline">\(M \cdot \mathbf{v} =\mathbf{0}\)</span> çš„åˆ—å‘é‡æœ‰å¤šå°‘ä¸ªï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šå³æ ¸ï¼ˆnullspaceï¼‰å‘é‡ç©ºé—´çš„ç»´æ•°ï¼Œå³å³æ ¸çš„ç»´åº¦ï¼ˆnullityï¼‰</p><h5 id="ç§©-é›¶åŒ–ç»´æ•°å®šç†">ç§©-é›¶åŒ–ç»´æ•°å®šç†</h5><p>çº¿æ€§ä»£æ•°ä¸­çš„ <strong>Rank-Nullity Theorem</strong>æä¾›äº†ç›´æ¥çš„ç­”æ¡ˆã€‚å¯¹äºä¸€ä¸ª <span class="math inline">\(m \timesn\)</span> çš„çŸ©é˜µ <span class="math inline">\(M\)</span>ï¼Œæœ‰ä»¥ä¸‹å…³ç³»<span class="math display">\[\text{rank}(M) + \text{nullity}(M) = n\]</span> å…¶ä¸­</p><ul><li><span class="math inline">\(\text{rank}(M)\)</span>ï¼šçŸ©é˜µ <spanclass="math inline">\(M\)</span> çš„ç§©ï¼Œè¡¨ç¤º <spanclass="math inline">\(M\)</span>çš„è¡Œå‘é‡ç©ºé—´çš„ç»´æ•°ï¼ˆæˆ–åˆ—å‘é‡ç©ºé—´çš„ç»´æ•°ï¼‰</li><li><spanclass="math inline">\(\text{nullity}(M)\)</span>ï¼šçŸ©é˜µå³æ ¸çš„ç»´æ•°ï¼ˆnullspace çš„ç»´æ•°ï¼‰</li><li><span class="math inline">\(n\)</span>ï¼šçŸ©é˜µåˆ—çš„æ€»æ•°</li></ul><p>ç»“è®º</p><ul><li>å³æ ¸çš„ç»´æ•°ï¼ˆnullityï¼‰å†³å®šäº†æ»¡è¶³ <span class="math inline">\(M \cdot\mathbf{v} = \mathbf{0}\)</span> çš„ç‹¬ç«‹åˆ—å‘é‡çš„æ•°é‡</li><li>è‹¥ nullity æ˜¯ <span class="math inline">\(k\)</span>ï¼Œåˆ™å³æ ¸ç©ºé—´æœ‰<span class="math inline">\(k\)</span>ä¸ªçº¿æ€§æ— å…³çš„åŸºå‘é‡ï¼Œæ»¡è¶³æ¡ä»¶çš„åˆ—å‘é‡æ•°é‡æ˜¯æ— ç©·å¤šçš„ï¼Œå› ä¸ºè¿™äº›åŸºå‘é‡å¯ä»¥ä»»æ„çº¿æ€§ç»„åˆ</li></ul><h5 id="å³æ ¸çŸ©é˜µ">å³æ ¸çŸ©é˜µ</h5><p>å³æ ¸çŸ©é˜µæŒ‡çš„æ˜¯çŸ©é˜µçš„å³é›¶ç©ºé—´çš„ä¸€ç§è¡¨ç¤ºæ–¹å¼ï¼Œå³é›¶ç©ºé—´æ˜¯æŒ‡æ‰€æœ‰ä½¿å¾—çŸ©é˜µä¸å…¶å³è¾¹ä¹˜ç§¯ç»“æœä¸ºé›¶å‘é‡çš„å‘é‡çš„é›†åˆã€‚å³æ ¸ç©ºé—´çš„åŸºå¯ä»¥ä½¿ç”¨sagemathä¸­çš„<code>right_kernel().basis()</code>å‡½æ•°æ±‚å‡º</p><h5 id="ä¾‹é¢˜">ä¾‹é¢˜</h5><p><ahref="https://www.cnblogs.com/L00kback/p/17573063.html">2023å·…å³°æå®¢Crypto Rosita</a></p><p><ahref="https://blog.csdn.net/qq_41626232/article/details/131861414?spm=1001.2014.3001.5501">å·…å³°æå®¢2023Crypto Rosita</a></p><h4 id="å›åˆ°æœ¬é¢˜">å›åˆ°æœ¬é¢˜</h4><p>æŒ‰ç…§å¤§ä½¬åšå®¢ä¸­çš„æ€è·¯åˆ†æè¿™é“é¢˜ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰ <spanclass="math display">\[a_ip+b_iq=h_i\]</span> å³ <span class="math display">\[\begin{pmatrix}a_i &amp; b_i\end{pmatrix}\begin{pmatrix}p\\\\q\end{pmatrix}=\mathbf{h_i}\]</span> å°†100ä¸ªç­‰å¼æ‹¼æ¥èµ·æ¥ <span class="math display">\[AB_{100\times2}\begin{pmatrix}p\\\\q\end{pmatrix}=H_{100\times1}\]</span> ç›®æ ‡æ˜¯æ±‚çŸ­åˆ—å‘é‡ <span class="math inline">\(A\)</span> ä¸<span class="math inline">\(B\)</span>ï¼Œè€ƒè™‘ <spanclass="math inline">\(AB\)</span> çŸ©é˜µçš„æ­£äº¤çŸ©é˜µï¼Œä¸å¦¨ä»¤ä¸º <spanclass="math inline">\(M\)</span>ï¼Œæœ‰ <span class="math display">\[M_{k\times100} \cdot AB_{100\times2}=\mathbf{0}_{k\times2}\]</span> é‚£ä¹ˆ <span class="math display">\[M_{k\times100} \cdot AB_{100\times2} \cdot\begin{pmatrix}p\\\\q\end{pmatrix}=\mathbf{0}_{k\times1}\]</span> ä¹Ÿå°±æ˜¯ <span class="math display">\[M_{k\times100} \cdot H_{100\times1}=\mathbf{0}_{k\times1}\]</span> å› ä¸ºæˆ‘ä»¬å·²çŸ¥çš„æ˜¯ <spanclass="math inline">\(H\)</span>ï¼Œæ‰€ä»¥è¦å¾€ <spanclass="math inline">\(H\)</span> ä¸Šæ¨å¯¼</p><p>å¾—åˆ°è¿™ä¸ªå…³ç³»ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“</p><ul><li><span class="math inline">\(M\)</span> ä¸ <spanclass="math inline">\(H\)</span> æ­£äº¤</li><li><span class="math inline">\(AB\)</span> çš„ä¸¤åˆ—å‡åœ¨ <spanclass="math inline">\(M\)</span> çš„å³æ ¸ç©ºé—´ä¸­</li><li><span class="math inline">\(AB\)</span> çš„ä¸¤åˆ—å‡æ˜¯ <spanclass="math inline">\(M\)</span> çš„å³æ ¸ç©ºé—´ä¸­çš„ä¸€ä¸ªçŸ­å‘é‡</li></ul><p>äºæ˜¯æˆ‘ä»¬è¦åšçš„å°±æ˜¯</p><ul><li>æ±‚ <span class="math inline">\(H\)</span> çš„ æ­£äº¤çŸ©é˜µ <spanclass="math inline">\(M\)</span></li><li>å¯¹ <span class="math inline">\(M\)</span>çš„å³æ ¸ç©ºé—´åšæ ¼åŸºè§„çº¦å¾—åˆ°æœ€çŸ­åˆ—</li></ul><p>æ‰¾åˆ° <span class="math inline">\(M\)</span> æ‰€æ„é€ çš„æ ¼æ˜¯å›ºå®šçš„ï¼Œä¸º<span class="math display">\[\begin{pmatrix}E_{100\times100} &amp; H_{100\times1}\\\\0 &amp; p\end{pmatrix}\]</span> å…¶ä¸­ï¼Œ <span class="math inline">\(E\)</span>æ˜¯å•ä½çŸ©é˜µï¼Œ<span class="math inline">\(H\)</span>æ˜¯å·²çŸ¥æ¡ä»¶çš„åˆ—å‘é‡ï¼Œ<span class="math inline">\(p\)</span>æ˜¯æ›²çº¿çš„é˜¶</p><p>æ„é€ åŸç†å¦‚ä¸‹ <span class="math display">\[\begin{pmatrix}M_{k\times100} &amp; t\end{pmatrix}\begin{pmatrix}E_{100\times100} &amp; H_{100\times1}\\\\0 &amp; p\end{pmatrix}=\begin{pmatrix}M_{k\times100} &amp; 0\end{pmatrix}\]</span> å¯¹æ„é€ å‡ºæ¥çš„æ ¼åšæ ¼åŸºè§„çº¦ï¼Œå°±èƒ½å¾—åˆ° <spanclass="math display">\[\begin{pmatrix}M_{k\times100} &amp; \mathbf{0}\\\\\mathbf{0} &amp; p\end{pmatrix}\]</span> ä¸ºä»€ä¹ˆæ„é€ çš„æ ¼è¦å¤šä¸€è¡Œ <spanclass="math inline">\((\mathbf{0},p)\)</span> ?</p><p>è¿™é‡Œè§„çº¦å‡ºçš„çŸ©é˜µï¼Œåªè¦è¡Œå‘é‡çš„æœ€åä¸€ä¸ªå…ƒç´ ä¸º <spanclass="math inline">\(0\)</span>ï¼Œå°±å¯ä»¥ä½œä¸ºä¸€è¡ŒåŠ å…¥åˆ° <spanclass="math inline">\(M\)</span>ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¯¹æ ¼çš„æœ€åä¸€åˆ—é…ä¸Šä¸€ä¸ªå¤§ç³»æ•°ï¼Œä»è€Œä¿è¯è§„çº¦å‡º <spanclass="math inline">\(0\)</span></p><p>æ˜¯çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è§„å‡ºæ¥çš„çŸ©é˜µï¼Œç†æƒ³æƒ…å†µä¸‹æœ€åä¸€åˆ—éƒ½ä¼šè¢«è§„çº¦æˆ <spanclass="math inline">\(0\)</span>ï¼Œä»£è¡¨äº†è¢«æ­£äº¤åŒ–ï¼Œä½†ä¸ä¸€å®šå…¨éƒ¨ä¼šè¢«è§„çº¦æˆ<span class="math inline">\(0\)</span>ï¼Œæ‰€ä»¥éœ€è¦ç­›é€‰ä¸€ä¸‹</p><blockquote><p>ä½†æ˜¯ï¼Œè¿™é‡Œå…¶å®å¯ä»¥ç›´æ¥å–è§„å‡ºæ¥çš„å‰ <spanclass="math inline">\(98\)</span> è¡Œï¼Œå› ä¸ºè§„å‡ºæ¥çŸ©é˜µçš„ç§©ä¸€å®šä¸º <spanclass="math inline">\(98\)</span>ï¼Œæ ¹æ®ä¸Šé¢çš„ç§©-é›¶åŒ–ç»´æ•°å®šç†å¯ä»¥çŸ¥é“ï¼›åŒæ—¶ï¼Œä¸€å®šæ˜¯å‰<span class="math inline">\(98\)</span>è¡Œä¸ºæ­£äº¤æˆåŠŸçš„ï¼Œè¿™ä¸ªæš‚æ—¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">M = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> L:</span><br><span class="line">    <span class="keyword">if</span>(i[-<span class="number">1</span>] == <span class="number">0</span>):</span><br><span class="line">        M.append(i[:-<span class="number">1</span>])</span><br><span class="line">M = Matrix(ZZ,M)</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å¯¹ <span class="math inline">\(M\)</span>çš„å³æ ¸ç©ºé—´ä¸­å†åšæ ¼åŸºè§„çº¦å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Ker = M.right_kernel().basis()</span><br><span class="line">Ker = Matrix(ZZ, Ker)</span><br><span class="line">AB = Ker.LLL()</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè§„å‡ºæ¥çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>å®é™…ä¸Šæ‰¾åˆ°çš„æ˜¯ <span class="math inline">\(B\)</span> å’Œä¸ <spanclass="math inline">\(B\)</span> çº¦å‡è¿‡çš„ <spanclass="math inline">\(A\)</span>ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ <spanclass="math inline">\(B\)</span> å¯ä»¥ï¼Œä½†æ˜¯ <spanclass="math inline">\(A\)</span> æ˜¯éœ€è¦è®¡ç®—çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">B = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">abs</span>, AB[<span class="number">1</span>]))</span><br><span class="line">A = [i+j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(AB[<span class="number">0</span>], B)]</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±å’Œä¹‹å‰ä¸€æ ·äº†ï¼Œæ±‚ <span class="math inline">\(GCD\)</span>å³å¯</p><h4 id="æ­£äº¤æ ¼çš„å¦ä¸€ä»½exp">æ­£äº¤æ ¼çš„å¦ä¸€ä»½exp</h4><p>æ¥è‡ª<a href="https://blog.s1um4i.com/2024-QWBCTF/">2024 å¼ºç½‘æ¯éƒ¨åˆ†é¢˜è§£</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">clist = [...]</span><br><span class="line">n, e = (<span class="number">73566307488763122580179867626252642940955298748752818919017828624963832700766915409125057515624347299603944790342215380220728964393071261454143348878369192979087090394858108255421841966688982884778999786076287493231499536762158941790933738200959195185310223268630105090119593363464568858268074382723204344819</span>, <span class="number">65537</span>)</span><br><span class="line">c = <span class="number">30332590230153809507216298771130058954523332140754441956121305005101434036857592445870499808003492282406658682811671092885592290410570348283122359319554197485624784590315564056341976355615543224373344781813890901916269854242660708815123152440620383035798542275833361820196294814385622613621016771854846491244</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gao_ortho</span>(<span class="params">c, N</span>):</span><br><span class="line">    n = <span class="number">100</span></span><br><span class="line">    C = matrix(ZZ, n, <span class="number">1</span>, c)</span><br><span class="line">    C = block_matrix([[identity_matrix(n), C]])</span><br><span class="line">    C = C.LLL()</span><br><span class="line">    C1 = C[:-<span class="number">2</span>, :-<span class="number">1</span>]</span><br><span class="line">    C1 = C1.T.left_kernel().matrix()</span><br><span class="line">    C1 = C1.LLL()</span><br><span class="line">    a0 = C1[<span class="number">0</span>]</span><br><span class="line">    a1 = C1[<span class="number">1</span>]</span><br><span class="line">    c_ = vector(ZZ, c)</span><br><span class="line">    res = C1.solve_left(c_)</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> res:</span><br><span class="line">        <span class="keyword">if</span> N % p == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> p, N // p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;GG&quot;</span>)</span><br><span class="line"></span><br><span class="line">p, q = gao_ortho(clist, n)</span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><p>æœ‰ç©ºå†ç ”ç©¶å§</p><h3 id="p.s.">P.S.</h3><p>è¿™é“é¢˜å…¶å® <span class="math inline">\(4\)</span> ç»„å€¼å°±èƒ½è§£</p><p><code>exp2_apbq.sage</code>é‡Œæ”¹æˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">h = hint2[:<span class="number">4</span>]</span><br><span class="line">nums = <span class="number">2</span></span><br></pre></td></tr></table></figure><p>æˆ–<code>exp22_apbq.sage</code>é‡Œæ”¹æˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">V = hints[:<span class="number">4</span>]</span><br><span class="line">k = <span class="number">2</span>^<span class="number">800</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯<code>exp222_apbq.sage</code>é‡Œè‡³å°‘éœ€è¦ <spanclass="math inline">\(5\)</span> ç»„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint2 = hint2[:<span class="number">5</span>]</span><br></pre></td></tr></table></figure><h2 id="ç¬¬ä¸‰æ®µ">ç¬¬ä¸‰æ®µ</h2><h3 id="é¢˜è§£">é¢˜è§£</h3><p>ç¬¬ä¸‰æ®µæ˜¯æœ€ntçš„...</p><p><img src="1.png" /></p><p>ç”¨çš„æ˜¯ç¬¬äºŒæ®µçš„å…¬ç§é’¥</p><h3 id="æ­£è§£">æ­£è§£</h3><p>ä½†æ˜¯è¿™ä¸ªé¢˜ä¹Ÿæ˜¯å¯ä»¥è§£çš„</p><p>ç»™çš„æ¡ä»¶æ˜¯ <span class="math display">\[c_1=ap+q\\c_2=p+bq\]</span> å¯ä»¥æ„é€ æ¨¡ <span class="math inline">\(n\)</span> ç­‰å¼ <spanclass="math display">\[(c_1-q)(c_2-p)=0 \bmod n\]</span> å±•å¼€æœ‰ <span class="math display">\[c_1c_2-c_1p-c_2q=0 \bmod n\]</span> å³ <span class="math display">\[c_1p+c_2q-c_1c_2+kn=0\]</span> æ„é€ æ ¼å¦‚ä¸‹ <span class="math display">\[\begin{pmatrix}p &amp; q &amp; 1 &amp; k\end{pmatrix}\begin{pmatrix}1 &amp; 0 &amp; 0 &amp; c_1\\\\0 &amp; 1 &amp; 0 &amp; c_2\\\\0 &amp; 0 &amp; 1 &amp; -c_1c_2\\\\0 &amp; 0 &amp; 0 &amp; n\end{pmatrix}=\begin{pmatrix}p &amp; q &amp; 1 &amp; 0\end{pmatrix}\]</span> ä½†è¿™ä¸ªæ ¼æ˜¯åšä¸å‡ºæ¥çš„ï¼Œæ­£ç¡®çš„æ ¼æ„é€ å¦‚ä¸‹</p><p><span class="math display">\[\begin{pmatrix}p_h &amp; q_h &amp; 1 &amp; k\end{pmatrix}\begin{pmatrix}1 &amp; 0 &amp; 0 &amp; 2^{brute}\cdot c_1\\\\0 &amp; 1 &amp; 0 &amp; 2^{brute}\cdot c_2\\\\0 &amp; 0 &amp; 2^{512-brute} &amp; c_1i+c_2j-c_1c_2\\\\0 &amp; 0 &amp; 0 &amp; n\end{pmatrix}=\begin{pmatrix}p_h &amp; q_h &amp; 2^{512-brute} &amp; 0\end{pmatrix}\]</span></p><h4 id="ä¸ºä»€ä¹ˆè¦ç”¨-p_h-q_h-è€Œä¸æ˜¯-p-q">ä¸ºä»€ä¹ˆè¦ç”¨ <spanclass="math inline">\(p_h\ q_h\)</span> è€Œä¸æ˜¯ <spanclass="math inline">\(p\ q\)</span> ?</h4><p><span class="math inline">\(p\)</span> å’Œ <spanclass="math inline">\(q\)</span>å‡çº¦ä¸º512ä½ï¼Œæ¯”è¾ƒæ¥è¿‘LLLå¯ä»¥è§„çº¦å‡ºæ¥çš„èŒƒå›´ï¼Œä½†ç¨å¾®é•¿äº†ä¸€ç‚¹ï¼Œéœ€è¦ç¼©çŸ­ä¸€ç‚¹</p><p><span class="math display">\[c_1c_2-c_1(2^{brute}p_h+i)-c_2(2^{brute}q_h+j)=0 \bmod n\]</span></p><p><span class="math display">\[2^{brute}c_1p_h+2^{brute}c_2q_h+c_1i+c_2j-c_1c_2+kn=0\]</span></p><h4 id="ä¸ºä»€ä¹ˆè¦ç”¨-2512-brute-è€Œä¸æ˜¯-1">ä¸ºä»€ä¹ˆè¦ç”¨ <spanclass="math inline">\(2^{512-brute}\)</span> è€Œä¸æ˜¯ <spanclass="math inline">\(1\)</span> ï¼Ÿ</h4><p>å› ä¸ºè§„çº¦å‡ºæ¥çš„å‘é‡ä¼šè¶‹äºç­‰é•¿æ­£äº¤ï¼Œæ‰€ä»¥å¦‚æœç”¨ä¸€å¼€å§‹çš„å‘é‡ <spanclass="math display">\[\begin{pmatrix}p &amp; q &amp; 1 &amp; 0\end{pmatrix}\]</span> på’Œqçš„ä½æ•°ä¼šè¢«â€œæ‹–ç´¯â€ï¼Œå˜æˆå¤§æ¦‚ <spanclass="math inline">\(512*2/3=341\)</span> ä½</p><p>æ‰€ä»¥é…ä¸€ä¸ªä½æ•°ä¸€æ ·çš„åšå¹³è¡¡ï¼Œç»è¿‡æµ‹è¯•ï¼ŒæŒ‡æ•°å– <spanclass="math inline">\(508-511\)</span> éƒ½èƒ½è§„å‡ºæ¥</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> æ ¼åŸºè§„çº¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WP-[2024.7æ˜¥ç§‹æ¯]ezzzecc</title>
      <link href="/2024/07/28/2024%E6%98%A5%E7%A7%8B%E6%9D%AF-ezzzecc/"/>
      <url>/2024/07/28/2024%E6%98%A5%E7%A7%8B%E6%9D%AF-ezzzecc/</url>
      
        <content type="html"><![CDATA[<h1 id="ezzzecc">ezzzecc</h1><p>å’Œ[HGAME 2022week4]ECCå·®ä¸å¤šçš„ä¸€é“é¢˜ï¼Œå¤šäº†ä¸¤ä¸ªç‚¹ï¼Œä¸€ä¸ªæ˜¯pçš„è§£å¯†ï¼Œä¸€ä¸ªæ˜¯kçš„è·å–</p><p>å…ˆæ˜¯pçš„è§£å¯†ï¼Œæ˜¯ä¸€ä¸ªbase62+å¤šæ¬¡base64+å¤šæ¬¡ROT47ï¼ŒçœŸæ˜¯é€†å¤©...</p><p>åŸæ¥</p><p><code>koZP3YQAklARRNrmYfjxoKIAXegOcG4jMOmKb08uESOkCCn72d6UM2NWgefYPEMq4EJ1M0jKaqt02Guo5Ubccjqg4QZaaHbScREx38UMLQKwG0LcDd8VFX1zkobc1ZQn4L3DhKQrgJZI55todgOdJuHN532bxScAvOF26gJyQclPtRHn3M6SHrRCEXzzmszd68PJlLB6HaabrRrCW9ZoAYSZetM5jDBtNCJLpR0CBZUUk3Oeh2MZQu2vk8DZ1QqNG49hlxGfawp1FXvAZPdMwixzkhEQnbCDcOKzYyT6BZF2Dfd940tazl7HNOswuIpLsqXQ2h56guGngMeYfMXEZV09fsB3TE0N934CLF8TbZnzFzEkOe8TPTK2mWPVSrgmbsGHnxgYWhaRQWg3yosgDfrEa5qfVl9De41PVtTw024gltovypMXK5XMhuhogs0EMN7hkLapLn6lMj</code></p><p>base62ä¹‹å</p><p><code>VmpKNFUxTXlVWGRsU0VKcFRXcFdUVmxXVWtOa01VMTZZVE5rYWsxSVVURlpha2t4VXpKR1ZWVnVVbFJOVlRWaFdUSjBkMDVYVFhsTlZYaHNWa1ZLTmxVeU5YTk5NbEpXWlVoQ2EwMHhXazFWVkVrMVpXeE5lbUpJY0d0U1dFSlZWMnBPUTFSV1ZYaGlTRlpWVWxVMGVsa3hWalJXUlRGSVRWVjBWazB3TlRaV1JXUnlUVWRKZDJSSVFrOVRSVXBNVmxST2EyUXhVa2RVYm5CcVZsaG9SVlpzWkRSVVJsVjZWRzVhVkUxdGMzZFpla0l3VGxacmVsUnJkRlpOYldjeA==</code></p><p>å¤šæ¬¡base64ä¹‹å</p><p><code>e2p.*'*-)+-,+*'&amp;.&amp;)&amp;+'+&amp;+-,',..,.(*,++-%()-&amp;',,*--&amp;%+,..(*.)%,)-+*,%%)+(*.,+',%(r</code></p><p>ROT47ä¹‹åå¾—åˆ°p</p><p><code>p=&#123;95258468765219141626168727997935766803481277588106799359407486570046359762703&#125;</code></p><p>ç„¶åæ˜¯ç§é’¥kçš„è·å–ï¼Œç”±äºè¿™é¢˜ç»™äº†ç§é’¥kæ˜¯18ä½çš„ï¼Œæ‰€ä»¥å¯ä»¥çˆ†ç ´å¾—åˆ°kï¼ˆæ‰€ä»¥å…¶å®é‚£ä¸ªkå°äº1000000çš„æ¡ä»¶æ²¡ä»€ä¹ˆç”¨...</p><p>çˆ†ç ´kçš„sageä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p = 95258468765219141626168727997935766803481277588106799359407486570046359762703</span><br><span class="line">a = 87425770561190618633288232353256495656281438408946725202136726983601884085917</span><br><span class="line">b = 107879772066707091306779801409109036008421651378615140327877558014536331974777</span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">K = (49293150360761418309411209621405185437426003792008480206387047056777011104939, 43598371886286324285673726736628847559547403221353820773139325027318579443479)</span><br><span class="line">G = (34031022567935512558184471533035716554557378321289293120392294258731566673565, 74331715224220154299708533566163247663094029276428146274456519014761122295496)</span><br><span class="line">for k in range(2^17, 2^19):</span><br><span class="line">    if K == k*G:</span><br><span class="line">        print(k)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure><p>å¾—åˆ°kä¸º166909</p><p>å¾—åˆ°ç§é’¥kï¼Œç”±é¢˜æœ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c1 = m + r * K</span><br><span class="line">c2 = r * G</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæœ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m = c1 - k * c2</span><br></pre></td></tr></table></figure><p>æ±‚è§£çš„sageä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import libnum</span><br><span class="line"></span><br><span class="line">p = 95258468765219141626168727997935766803481277588106799359407486570046359762703</span><br><span class="line">a = 87425770561190618633288232353256495656281438408946725202136726983601884085917</span><br><span class="line">b = 107879772066707091306779801409109036008421651378615140327877558014536331974777</span><br><span class="line">k = 166909</span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">c1 = E(3315847183153421424358678117707706758962521458183324187760613108746362414091, 61422809633368910312843316855658127170184420570309973276760547643460231548014)</span><br><span class="line">c2 = E(12838481482175070256758359669437500951915904121998959094172291545942862161864, 60841550842604234546787351747017749679783606696419878692095419214989669624971)</span><br><span class="line">m = c1 - k * c2</span><br><span class="line">cipher_left = 75142205156781095042041227504637709079517729950375899059488581605798510465939</span><br><span class="line">cipher_right = 61560856815190247060747741878070276409743228362585436028144398174723191051815</span><br><span class="line">print(libnum.n2s(int(cipher_left//m[0])))</span><br><span class="line">print(libnum.n2s(int(cipher_right//m[1])))</span><br></pre></td></tr></table></figure><h2 id="å¦ä¸€ç§æ±‚pçš„æ–¹æ³•">å¦ä¸€ç§æ±‚pçš„æ–¹æ³•</h2><p>å·²çŸ¥4ä¸ªæ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ï¼š<code>K</code>ã€<code>G</code>ã€<code>c1</code>ã€<code>c2</code>ï¼Œæ¯ä¸ªç‚¹éƒ½æ»¡è¶³<code>x**3+a*x+b-y**2=kp</code>ï¼Œæ•…å¯ä»¥é€šè¿‡æ±‚gcdæ¥å¾—åˆ°pï¼Œè€Œä¸”å®é™…ä¸Šåªç”¨ä¸¤ä¸ªç‚¹å°±å¯ä»¥å¾—åˆ°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">a = <span class="number">87425770561190618633288232353256495656281438408946725202136726983601884085917</span></span><br><span class="line">b = <span class="number">107879772066707091306779801409109036008421651378615140327877558014536331974777</span></span><br><span class="line">K = (<span class="number">49293150360761418309411209621405185437426003792008480206387047056777011104939</span>, <span class="number">43598371886286324285673726736628847559547403221353820773139325027318579443479</span>)</span><br><span class="line">G = (<span class="number">34031022567935512558184471533035716554557378321289293120392294258731566673565</span>, <span class="number">74331715224220154299708533566163247663094029276428146274456519014761122295496</span>)</span><br><span class="line">l = K[<span class="number">0</span>] ** <span class="number">3</span> + a * K[<span class="number">0</span>] + b - K[<span class="number">1</span>] ** <span class="number">2</span></span><br><span class="line">w = G[<span class="number">0</span>] ** <span class="number">3</span> + a * G[<span class="number">0</span>] + b - G[<span class="number">1</span>] ** <span class="number">2</span></span><br><span class="line">p = gmpy2.gcd(l, w)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure><h2 id="å¦å¤–ä¸€ç§çˆ†ç ´kçš„æ–¹æ³•">å¦å¤–ä¸€ç§çˆ†ç ´kçš„æ–¹æ³•</h2><p>ä¸Šé¢çˆ†ç ´kçš„æ–¹æ³•æ˜¯ç”¨Kå’ŒGç®—å‡ºkçš„å…·ä½“å€¼ï¼Œå…¶å®å¯ä»¥ç›´æ¥çˆ†ç ´ï¼Œä¸ç”¨å…³å¿ƒå®ƒçš„å…·ä½“å€¼ï¼Œæˆ‘ä»¬å…³å¿ƒçš„æ˜¯è§£å‡ºçš„æ˜æ–‡å­—ç¬¦ä¸²ä¸­æ˜¯å¦æœ‰<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">from tqdm import tqdm</span><br><span class="line"></span><br><span class="line">a = 87425770561190618633288232353256495656281438408946725202136726983601884085917</span><br><span class="line">b = 107879772066707091306779801409109036008421651378615140327877558014536331974777</span><br><span class="line">K = (49293150360761418309411209621405185437426003792008480206387047056777011104939, 43598371886286324285673726736628847559547403221353820773139325027318579443479)</span><br><span class="line">G = (34031022567935512558184471533035716554557378321289293120392294258731566673565, 74331715224220154299708533566163247663094029276428146274456519014761122295496)</span><br><span class="line"></span><br><span class="line">KK = K[0]^3 + K[0]*a + b - K[1]^2 </span><br><span class="line">GG = G[0]^3 + G[0]*a + b - G[1]^2</span><br><span class="line">p = gmpy2.gcd(KK, GG)</span><br><span class="line">print(p)</span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">c1 = (3315847183153421424358678117707706758962521458183324187760613108746362414091, 61422809633368910312843316855658127170184420570309973276760547643460231548014)</span><br><span class="line">c2 = (12838481482175070256758359669437500951915904121998959094172291545942862161864, 60841550842604234546787351747017749679783606696419878692095419214989669624971)</span><br><span class="line">cipher_left = 75142205156781095042041227504637709079517729950375899059488581605798510465939</span><br><span class="line">cipher_right = 61560856815190247060747741878070276409743228362585436028144398174723191051815</span><br><span class="line"></span><br><span class="line">c1 = E(c1)</span><br><span class="line">c2 = E(c2)</span><br><span class="line"></span><br><span class="line">for k in tqdm(range(2^17, 2^18)):</span><br><span class="line">    m = c1 - c2*k</span><br><span class="line">    flag1 = long_to_bytes(int(cipher_left // m[0]))</span><br><span class="line">    flag2 = long_to_bytes(int(cipher_right // m[1]))</span><br><span class="line">    flag = flag1 + flag2</span><br><span class="line">    if b&#x27;flag&#x27; in flag:</span><br><span class="line">        print(flag)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> crypto </tag>
            
            <tag> ecc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Frida-Hook</title>
      <link href="/2024/07/04/Frida-Hook/"/>
      <url>/2024/07/04/Frida-Hook/</url>
      
        <content type="html"><![CDATA[<h1 id="frida-hook">Frida-Hook</h1><h2 id="fridaæ¦‚å¿µ">Fridaæ¦‚å¿µ</h2><p>Fridaæ˜¯ä¸€æ¬¾å¼€æºçš„åŠ¨æ€æ’æ¡©å·¥å…·ï¼Œå¯ä»¥æ’å…¥ä¸€äº›ä»£ç åˆ°åŸç”ŸAppçš„å†…å­˜ç©ºé—´å»åŠ¨æ€åœ°ç›‘è§†å’Œä¿®æ”¹å…¶è¡Œä¸ºï¼Œæ”¯æŒWindowsã€Macã€Linuxã€Androidæˆ–è€…iOSï¼Œä»å®‰å“å±‚é¢æ¥è®²ï¼Œå¯ä»¥å®ç°<code>Java</code>å±‚å’Œ<code>Native</code>å±‚<code>Hook</code>æ“ä½œ</p><p>æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒçŸ¥åçš„é€†å‘æ¡†æ¶ï¼ŒXposed</p><blockquote><p>Xposedç›´æ¥ç¼–å†™Javaä»£ç ï¼ŒJavaå±‚hookæ–¹ä¾¿ï¼Œå¯æ‰“åŒ…æ¨¡å—æŒä¹…åŒ–hookï¼Œç¼ºç‚¹æ˜¯ç¯å¢ƒé…ç½®ç¹çï¼Œå…¼å®¹æ€§è¾ƒå·®ï¼Œéš¾ä»¥Hookåº•å±‚ä»£ç </p><p>Fridaé…ç½®ç®€å•ï¼Œå…é‡å¯hookã€‚æ”¯æŒJavaå±‚å’ŒNativeå±‚çš„hookæ“ä½œï¼Œç¼ºç‚¹æ˜¯æŒä¹…åŒ–hookç›¸å¯¹éº»çƒ¦</p></blockquote><h2 id="fridaæ¡†æ¶æ­å»º">Fridaæ¡†æ¶æ­å»º</h2><p>fridaæ¡†æ¶æ­å»ºåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šå®¢æˆ·ç«¯ç¯å¢ƒå’ŒæœåŠ¡ç«¯ç¯å¢ƒ</p><h3 id="å®¢æˆ·ç«¯">å®¢æˆ·ç«¯</h3><p>åœ¨å®¢æˆ·ç«¯æˆ‘ä»¬å¯ä»¥ç¼–å†™Pythonä»£ç ï¼Œç”¨äºè¿æ¥è¿œç¨‹è®¾å¤‡ï¼Œæäº¤è¦æ³¨å…¥çš„ä»£ç åˆ°è¿œç¨‹ï¼Œæ¥å—æœåŠ¡ç«¯çš„å‘æ¥çš„æ¶ˆæ¯ç­‰ï¼Œä¸€èˆ¬ä¸ºPCç«¯</p><h4 id="å®¢æˆ·ç«¯ç¯å¢ƒé…ç½®">å®¢æˆ·ç«¯ç¯å¢ƒé…ç½®ï¼š</h4><p><code>pip install frida</code></p><p><code>pip install frida-tools</code></p><blockquote><p>å‡ ç‚¹è¯´æ˜ï¼š</p><p>ï¼ˆ1ï¼‰é€šè¿‡pipå®‰è£…çš„fridaæ˜¯å¯ä»¥è·Ÿpythonç»‘å®šçš„ï¼›å¦å¤–fridaç°åœ¨ä¹Ÿå·²ç»æœ‰äº†è·ŸnodeJsç»‘å®šçš„ç‰ˆæœ¬ï¼Œ å› æ­¤ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡ npmè¿›è¡Œå®‰è£…</p><p>ï¼ˆ2ï¼‰frida-toolsæ¨¡å—æä¾›cliå‘½ä»¤ï¼Œå’Œfrida-serveråšäº¤äº’</p></blockquote><h3 id="æœåŠ¡ç«¯">æœåŠ¡ç«¯</h3><p>åœ¨æœåŠ¡ç«¯ï¼Œæˆ‘ä»¬éœ€è¦ç”¨Javascriptä»£ç æ³¨å…¥åˆ°ç›®æ ‡è¿›ç¨‹ï¼Œæ“ä½œå†…å­˜æ•°æ®ï¼Œç»™å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯ç­‰æ“ä½œã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®¢æˆ·ç«¯ç†è§£æˆæ§åˆ¶ç«¯ï¼ŒæœåŠ¡ç«¯ç†è§£æˆè¢«æ§ç«¯ï¼Œä¸€èˆ¬ä¸ºAndroidè®¾å¤‡ç«¯</p><h4 id="æœåŠ¡ç«¯ç¯å¢ƒé…ç½®">æœåŠ¡ç«¯ç¯å¢ƒé…ç½®ï¼š</h4><p><a href="https://github.com/frida/frida/releases">ä¸‹è½½fridaserver</a>ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„fridaæœåŠ¡ç«¯ï¼Œä¹Ÿå°±æ˜¯Androidè®¾å¤‡CPUçš„å‹å·ï¼Œå¯ä»¥ç”¨adbæŸ¥çœ‹</p><blockquote><p>adbï¼ˆAndroid Debug Bridgeï¼‰æ˜¯androidsdké‡Œçš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨è¿™ä¸ªå·¥å…·å¯ä»¥ç›´æ¥æ“ä½œç®¡ç†androidæ¨¡æ‹Ÿå™¨æˆ–è€…çœŸå®çš„andriodè®¾å¤‡ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œçª—å£ï¼Œç”¨äºé€šè¿‡ç”µè„‘ç«¯ä¸æ¨¡æ‹Ÿå™¨æˆ–è€…çœŸå®Androidè®¾å¤‡äº¤äº’ã€‚hookéœ€è¦æå‰é…å¥½adbçš„ç¯å¢ƒ</p></blockquote><p>adbæŸ¥çœ‹æ‰‹æœºCPUå‹å·</p><p><code>adb shell getprop ro.product.cpu.abi</code></p><p>ä¸‹è½½å¯¹åº”çš„æœåŠ¡ç«¯ï¼Œè§£å‹</p><p><img src="image-20240620191053433.png" /></p><p>å°†è§£å‹åçš„æœåŠ¡ç«¯æ¨åˆ°æ‰‹æœºçš„/data/local/tmpç›®å½•</p><p><code>adb push frida-server-16.3.3-android-x86_64 /data/local/tmp</code></p><blockquote><p>å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼š</p><p><strong>remote secure_mkdirs failed: Permissiondenied</strong>ï¼šå³æƒé™ä¸è¶³ï¼Œå…ˆ<code>adb root</code>ä»¥rootèº«ä»½å¯åŠ¨adbï¼Œå†æ¨å³å¯</p></blockquote><p>å°†Androidè®¾å¤‡ä¸Šçš„frida-serveræ·»åŠ æ‰§è¡Œæƒï¼Œå¹¶è¿è¡Œè¯¥ç¨‹åº(éœ€è¦rootæƒé™)</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br><span class="line"><span class="built_in">cd</span> /data/local/tmp</span><br><span class="line">su</span><br><span class="line"><span class="built_in">chmod</span> 777 frida-server-16.3.3-android-x86_64</span><br></pre></td></tr></table></figure><blockquote><p>å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼š</p><p><strong>suæ—¶Permissiondenied</strong>ï¼šæ— rootæƒé™ï¼Œéœ€è¦æœåŠ¡ç«¯ï¼Œä¹Ÿå°±æ˜¯Androidè®¾å¤‡ï¼Œä¸€èˆ¬ä¸ºæ¨¡æ‹Ÿå™¨æˆ–çœŸæœºï¼Œæ‰“å¼€rootæƒé™</p><p><img src="image-20240620195637134.png" /></p><p>å¦å¤–ï¼Œä¾‹å¦‚é¢å…·Magiskç­‰è½¯ä»¶å¯èƒ½ä¹Ÿä¼šå½±å“</p></blockquote><p>æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡æ¨¡æ‹Ÿå™¨ç›´æ¥å¾€æœåŠ¡ç«¯ä¼ å…¥serverå¹¶èµ‹äºˆæƒé™</p><h3 id="hookå…·ä½“æ­¥éª¤">Hookå…·ä½“æ­¥éª¤</h3><p>æœåŠ¡ç«¯å¯åŠ¨serveræœåŠ¡ï¼Œè¿˜æ˜¯é€šè¿‡adbè¿›å…¥æœåŠ¡ç«¯å¯åŠ¨frida-server</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br><span class="line"><span class="built_in">cd</span> /data/local/tmp</span><br><span class="line">su</span><br><span class="line">./frida-server-16.3.3-android-x86_64</span><br></pre></td></tr></table></figure><p>åŒæ—¶å¯ä»¥æ‰“å¼€fridaæ—¥å¿—æ•è·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logcat | grep <span class="string">&quot;D.zj2595&quot;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨å®¢æˆ·ç«¯å³å¯å¯åŠ¨fridaè¿›è¡Œhookï¼Œfridaçš„å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒ<code>frida --help</code></p><h2 id="fridaåŸºç¡€çŸ¥è¯†">FridaåŸºç¡€çŸ¥è¯†</h2><h3 id="fridaçš„6ä¸ªå·¥å…·">fridaçš„6ä¸ªå·¥å…·</h3><blockquote><p>fridaCLIï¼šä¸€ä¸ªäº¤äº’å¼è§£é‡Šå™¨ï¼ˆREPLï¼‰ï¼Œäº¤äº’å½¢å¼ä¸IPythonç±»ä¼¼ï¼Œå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œäº¤äº’</p><p>frida-ps: ç”¨äºåˆ—å‡ºè¿›ç¨‹çš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œfrida-ps -UæŸ¥çœ‹å½“å‰æ‰‹æœºè¿è¡Œçš„è¿›ç¨‹</p><p>frida-trace, frida-discover, frida-ls-devices,frida-killï¼šä¸å¸¸ç”¨ï¼Œè§<ahref="https://frida.re/docs/home/">å®˜æ–¹æ–‡æ¡£</a></p></blockquote><h3 id="æ“ä½œæ¨¡å¼">æ“ä½œæ¨¡å¼</h3><table><colgroup><col style="width: 8%" /><col style="width: 31%" /><col style="width: 31%" /><col style="width: 27%" /></colgroup><thead><tr><th style="text-align: left;">æ“ä½œæ¨¡å¼</th><th style="text-align: left;">æè¿°</th><th style="text-align: left;">ä¼˜ç‚¹</th><th style="text-align: left;">ä¸»è¦ç”¨é€”</th></tr></thead><tbody><tr><td style="text-align: left;">CLIï¼ˆå‘½ä»¤è¡Œï¼‰æ¨¡å¼</td><tdstyle="text-align: left;">é€šè¿‡å‘½ä»¤è¡Œç›´æ¥å°†JavaScriptè„šæœ¬æ³¨å…¥è¿›ç¨‹ä¸­ï¼Œå¯¹è¿›ç¨‹è¿›è¡Œæ“ä½œ</td><td style="text-align: left;">ä¾¿äºç›´æ¥æ³¨å…¥å’Œæ“ä½œ</td><tdstyle="text-align: left;">åœ¨è¾ƒå°è§„æ¨¡çš„æ“ä½œæˆ–è€…éœ€æ±‚æ¯”è¾ƒç®€å•çš„åœºæ™¯ä¸­ä½¿ç”¨</td></tr><tr><td style="text-align: left;">RPCæ¨¡å¼</td><tdstyle="text-align: left;">ä½¿ç”¨Pythonè¿›è¡ŒJavaScriptè„šæœ¬çš„æ³¨å…¥å·¥ä½œï¼Œå®é™…å¯¹è¿›ç¨‹è¿›è¡Œæ“ä½œçš„è¿˜æ˜¯JavaScriptè„šæœ¬ï¼Œå¯ä»¥é€šè¿‡RPCä¼ è¾“ç»™Pythonè„šæœ¬æ¥è¿›è¡Œå¤æ‚æ•°æ®çš„å¤„ç†</td><tdstyle="text-align: left;">åœ¨å¯¹å¤æ‚æ•°æ®çš„å¤„ç†ä¸Šå¯ä»¥é€šè¿‡RPCä¼ è¾“ç»™Pythonè„šæœ¬æ¥è¿›è¡Œï¼Œæœ‰åˆ©äºå‡å°‘è¢«æ³¨å…¥è¿›ç¨‹çš„æ€§èƒ½æŸè€—</td><tdstyle="text-align: left;">åœ¨å¤§è§„æ¨¡è°ƒç”¨ä¸­æ›´åŠ æ™®éï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¤æ‚æ•°æ®å¤„ç†çš„éœ€æ±‚</td></tr></tbody></table><h3 id="æ³¨å…¥æ¨¡å¼ä¸å¯åŠ¨å‘½ä»¤">æ³¨å…¥æ¨¡å¼ä¸å¯åŠ¨å‘½ä»¤:</h3><table><colgroup><col style="width: 4%" /><col style="width: 24%" /><col style="width: 24%" /><col style="width: 24%" /><col style="width: 23%" /></colgroup><thead><tr><th style="text-align: left;">æ³¨å…¥æ¨¡å¼</th><th style="text-align: left;">æè¿°</th><th style="text-align: left;">å‘½ä»¤æˆ–å‚æ•°</th><th style="text-align: left;">ä¼˜ç‚¹</th><th style="text-align: left;">ä¸»è¦ç”¨é€”</th></tr></thead><tbody><tr><td style="text-align: left;">Spawnæ¨¡å¼</td><tdstyle="text-align: left;">å°†å¯åŠ¨Appçš„æƒåˆ©äº¤ç”±Fridaæ¥æ§åˆ¶ï¼Œå³ä½¿ç›®æ ‡Appå·²ç»å¯åŠ¨ï¼Œåœ¨ä½¿ç”¨Fridaæ³¨å…¥ç¨‹åºæ—¶è¿˜æ˜¯ä¼šé‡æ–°å¯åŠ¨App</td><td style="text-align: left;">åœ¨CLIæ¨¡å¼ä¸­ï¼ŒFridaé€šè¿‡åŠ ä¸Š -få‚æ•°æŒ‡å®šåŒ…åä»¥spawnæ¨¡å¼æ“ä½œApp</td><tdstyle="text-align: left;">é€‚åˆäºéœ€è¦åœ¨Appå¯åŠ¨æ—¶å³è¿›è¡Œæ³¨å…¥çš„åœºæ™¯ï¼Œå¯ä»¥åœ¨Appå¯åŠ¨æ—¶å³æ•è·å…¶è¡Œä¸º</td><tdstyle="text-align: left;">å½“éœ€è¦ç›‘æ§Appä»å¯åŠ¨å¼€å§‹çš„æ‰€æœ‰è¡Œä¸ºæ—¶ä½¿ç”¨</td></tr><tr><td style="text-align: left;">Attachæ¨¡å¼</td><tdstyle="text-align: left;">åœ¨ç›®æ ‡Appå·²ç»å¯åŠ¨çš„æƒ…å†µä¸‹ï¼ŒFridaé€šè¿‡ptraceæ³¨å…¥ç¨‹åºä»è€Œæ‰§è¡ŒHookçš„æ“ä½œ</td><td style="text-align: left;">åœ¨CLIæ¨¡å¼ä¸­ï¼Œå¦‚æœä¸æ·»åŠ  -få‚æ•°ï¼Œåˆ™é»˜è®¤ä¼šé€šè¿‡attachæ¨¡å¼æ³¨å…¥App</td><tdstyle="text-align: left;">é€‚åˆäºå·²ç»è¿è¡Œçš„Appï¼Œä¸ä¼šé‡æ–°å¯åŠ¨Appï¼Œå¯¹ç”¨æˆ·ä½“éªŒå½±å“è¾ƒå°</td><tdstyle="text-align: left;">åœ¨Appå·²ç»å¯åŠ¨ï¼Œæˆ–è€…æˆ‘ä»¬åªå…³å¿ƒç‰¹å®šæ—¶åˆ»æˆ–ç‰¹å®šåŠŸèƒ½çš„è¡Œä¸ºæ—¶ä½¿ç”¨</td></tr></tbody></table><p>Spawnæ¨¡å¼</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U -f è¿›ç¨‹å -l hook.js</span><br></pre></td></tr></table></figure><p>Attachæ¨¡å¼</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U è¿›ç¨‹å -l hook.js</span><br></pre></td></tr></table></figure><p>frida-serverè‡ªå®šä¹‰ç«¯å£</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frida-server-16.3.3-android-x86_64 -l 0.0.0.0:6666</span><br></pre></td></tr></table></figure><p>fridaæ—¥å¿—æ•è·</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logcat | grep <span class="string">&quot;D.zj2595&quot;</span>//Dè¡¨ç¤ºè°ƒè¯•çº§åˆ«ï¼Œåé¢æ˜¯è¿‡æ»¤æ ‡ç­¾</span><br></pre></td></tr></table></figure><p>æ¨¡æ‹Ÿå™¨ç«¯å£è½¬å‘</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb connect <span class="number">127</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">1</span>:ç«¯å£å·</span><br></pre></td></tr></table></figure><h3 id="åŸºç¡€è¯­æ³•">åŸºç¡€è¯­æ³•</h3><table><colgroup><col style="width: 47%" /><col style="width: 52%" /></colgroup><thead><tr><th style="text-align: left;">APIåç§°</th><th style="text-align: left;">æè¿°</th></tr></thead><tbody><tr><td style="text-align: left;"><code>Java.use(className)</code></td><tdstyle="text-align: left;">è·å–æŒ‡å®šçš„Javaç±»å¹¶ä½¿å…¶åœ¨JavaScriptä»£ç ä¸­å¯ç”¨ã€‚</td></tr><tr><td style="text-align: left;"><code>Java.perform(callback)</code></td><td style="text-align: left;">ç¡®ä¿å›è°ƒå‡½æ•°åœ¨Javaçš„ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚</td></tr><tr><tdstyle="text-align: left;"><code>Java.choose(className, callbacks)</code></td><td style="text-align: left;">æšä¸¾æŒ‡å®šç±»çš„æ‰€æœ‰å®ä¾‹ã€‚</td></tr><tr><td style="text-align: left;"><code>Java.cast(obj, cls)</code></td><tdstyle="text-align: left;">å°†ä¸€ä¸ªJavaå¯¹è±¡è½¬æ¢æˆå¦ä¸€ä¸ªJavaç±»çš„å®ä¾‹ã€‚</td></tr><tr><tdstyle="text-align: left;"><code>Java.enumerateLoadedClasses(callbacks)</code></td><td style="text-align: left;">æšä¸¾è¿›ç¨‹ä¸­å·²ç»åŠ è½½çš„æ‰€æœ‰Javaç±»ã€‚</td></tr><tr><tdstyle="text-align: left;"><code>Java.enumerateClassLoaders(callbacks)</code></td><td style="text-align: left;">æšä¸¾è¿›ç¨‹ä¸­å­˜åœ¨çš„æ‰€æœ‰Javaç±»åŠ è½½å™¨ã€‚</td></tr><tr><tdstyle="text-align: left;"><code>Java.enumerateMethods(targetClassMethod)</code></td><td style="text-align: left;">æšä¸¾æŒ‡å®šç±»çš„æ‰€æœ‰æ–¹æ³•ã€‚</td></tr></tbody></table><h3 id="æ—¥å¿—è¾“å‡ºè¯­æ³•åŒºåˆ«">æ—¥å¿—è¾“å‡ºè¯­æ³•åŒºåˆ«</h3><table><colgroup><col style="width: 11%" /><col style="width: 40%" /><col style="width: 47%" /></colgroup><thead><tr><th style="text-align: left;">æ—¥å¿—æ–¹æ³•</th><th style="text-align: left;">æè¿°</th><th style="text-align: left;">åŒºåˆ«</th></tr></thead><tbody><tr><td style="text-align: left;"><code>console.log()</code></td><td style="text-align: left;">ä½¿ç”¨JavaScriptç›´æ¥è¿›è¡Œæ—¥å¿—æ‰“å°</td><tdstyle="text-align: left;">å¤šç”¨äºåœ¨CLIæ¨¡å¼ä¸­ï¼Œ<code>console.log()</code>ç›´æ¥è¾“å‡ºåˆ°å‘½ä»¤è¡Œç•Œé¢ï¼Œä½¿ç”¨æˆ·å¯ä»¥å®æ—¶æŸ¥çœ‹ã€‚åœ¨RPCæ¨¡å¼ä¸­ï¼Œ<code>console.log()</code>åŒæ ·è¾“å‡ºåœ¨å‘½ä»¤è¡Œï¼Œä½†å¯èƒ½è¢«Pythonè„šæœ¬çš„è¾“å‡ºå†…å®¹æ©ç›–ã€‚</td></tr><tr><td style="text-align: left;"><code>send()</code></td><tdstyle="text-align: left;">Fridaçš„ä¸“æœ‰æ–¹æ³•ï¼Œç”¨äºå‘é€æ•°æ®æˆ–æ—¥å¿—åˆ°å¤–éƒ¨Pythonè„šæœ¬</td><tdstyle="text-align: left;">å¤šç”¨äºRPCæ¨¡å¼ä¸­ï¼Œå®ƒå…è®¸JavaScriptè„šæœ¬å‘é€æ•°æ®åˆ°Pythonè„šæœ¬ï¼ŒPythonè„šæœ¬å¯ä»¥è¿›ä¸€æ­¥å¤„ç†æˆ–è®°å½•è¿™äº›æ•°æ®ã€‚</td></tr></tbody></table><h3 id="hookæ¡†æ¶æ¨¡æ¿">Hookæ¡†æ¶æ¨¡æ¿</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//è‡ªå®šä¹‰çš„hookå‡½æ•°</span></span><br><span class="line">        <span class="title function_">hookTest1</span>();</span><br><span class="line">    &#125;); </span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setImmediate</span>(main);</span><br></pre></td></tr></table></figure><h2 id="fridaå¸¸ç”¨api">Fridaå¸¸ç”¨API</h2><h3id="hookæ™®é€šæ–¹æ³•æ‰“å°å‚æ•°å’Œä¿®æ”¹è¿”å›å€¼">1.Hookæ™®é€šæ–¹æ³•ã€æ‰“å°å‚æ•°å’Œä¿®æ”¹è¿”å›å€¼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªåä¸ºhookTest1çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest1</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//è·å–ä¸€ä¸ªåä¸º&quot;ç±»å&quot;çš„Javaç±»ï¼Œå¹¶å°†å…¶å®ä¾‹èµ‹å€¼ç»™JavaScriptå˜é‡utils</span></span><br><span class="line">    <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;ç±»å&quot;</span>);</span><br><span class="line">    <span class="comment">//ä¿®æ”¹&quot;ç±»å&quot;çš„&quot;method&quot;æ–¹æ³•çš„å®ç°ã€‚è¿™ä¸ªæ–°çš„å®ç°ä¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼ˆaå’Œbï¼‰</span></span><br><span class="line">    utils.<span class="property">method</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">a, b</span>)&#123;</span><br><span class="line">        <span class="comment">//å°†å‚æ•°aå’Œbçš„å€¼æ”¹ä¸º123å’Œ456ã€‚</span></span><br><span class="line">        a = <span class="number">123</span>;</span><br><span class="line">        b = <span class="number">456</span>;</span><br><span class="line">        <span class="comment">//è°ƒç”¨ä¿®æ”¹è¿‡çš„&quot;method&quot;æ–¹æ³•ï¼Œå¹¶å°†è¿”å›å€¼å­˜å‚¨åœ¨`retval`å˜é‡ä¸­</span></span><br><span class="line">        <span class="keyword">var</span> retval = <span class="variable language_">this</span>.<span class="title function_">method</span>(a, b);</span><br><span class="line">        <span class="comment">//åœ¨æ§åˆ¶å°ä¸Šæ‰“å°å‚æ•°aï¼Œbçš„å€¼ä»¥åŠ&quot;method&quot;æ–¹æ³•çš„è¿”å›å€¼</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, retval);</span><br><span class="line">        <span class="comment">//è¿”å›&quot;method&quot;æ–¹æ³•çš„è¿”å›å€¼</span></span><br><span class="line">        <span class="keyword">return</span> retval;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="hooké‡è½½å‚æ•°">Hooké‡è½½å‚æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .overload()</span></span><br><span class="line"><span class="comment">// .overload(&#x27;è‡ªå®šä¹‰å‚æ•°&#x27;)</span></span><br><span class="line"><span class="comment">// .overload(&#x27;int&#x27;)</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest2</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>);</span><br><span class="line">    <span class="comment">//overloadå®šä¹‰é‡è½½å‡½æ•°ï¼Œæ ¹æ®å‡½æ•°çš„å‚æ•°ç±»å‹å¡«</span></span><br><span class="line">    <span class="comment">//è¿™é‡Œçš„Animalæ˜¯è‡ªå®šä¹‰å‚æ•°ç±»å‹ï¼Œéœ€è¦å»smaliä»£ç é‡Œæ‰¾å®šä¹‰ </span></span><br><span class="line">    utils.<span class="property">Inner</span>.<span class="title function_">overload</span>(<span class="string">&#x27;com.zj.wuaipojie.Demo$Animal&#x27;</span>,<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">aï¼Œb</span>)&#123;</span><br><span class="line">        b = <span class="string">&quot;aaaaaaaaaa&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title class_">Inner</span>(a,b);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="hookæ„é€ å‡½æ•°">Hookæ„é€ å‡½æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest3</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>);</span><br><span class="line">    <span class="comment">//ä¿®æ”¹ç±»çš„æ„é€ å‡½æ•°çš„å®ç°ï¼Œ$initè¡¨ç¤ºæ„é€ å‡½æ•°</span></span><br><span class="line">    utils.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line">        str = <span class="string">&quot;52&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.$init(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="hookå­—æ®µ">Hookå­—æ®µ</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest5</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//é™æ€å­—æ®µçš„ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">var</span> utils = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>);</span><br><span class="line">        <span class="comment">//ä¿®æ”¹ç±»çš„é™æ€å­—æ®µ&quot;flag&quot;çš„å€¼</span></span><br><span class="line">        utils.<span class="property">staticField</span>.<span class="property">value</span> = <span class="string">&quot;æˆ‘æ˜¯è¢«ä¿®æ”¹çš„é™æ€å˜é‡&quot;</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(utils.<span class="property">staticField</span>.<span class="property">value</span>);</span><br><span class="line">        <span class="comment">//éé™æ€å­—æ®µçš„ä¿®æ”¹</span></span><br><span class="line">        <span class="comment">//ä½¿ç”¨`Java.choose()`æšä¸¾ç±»çš„æ‰€æœ‰å®ä¾‹</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">obj</span>)&#123;</span><br><span class="line">                <span class="comment">//ä¿®æ”¹å®ä¾‹çš„éé™æ€å­—æ®µ&quot;_privateInt&quot;çš„å€¼ä¸º&quot;123456&quot;ï¼Œå¹¶ä¿®æ”¹éé™æ€å­—æ®µ&quot;privateInt&quot;çš„å€¼ä¸º9999ã€‚</span></span><br><span class="line">                obj.<span class="property">_privateInt</span>.<span class="property">value</span> = <span class="string">&quot;123456&quot;</span>; <span class="comment">//å­—æ®µåä¸å‡½æ•°åç›¸åŒ å‰é¢åŠ ä¸ªä¸‹åˆ’çº¿</span></span><br><span class="line">                obj.<span class="property">privateInt</span>.<span class="property">value</span> = <span class="number">9999</span>;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="hookå†…éƒ¨ç±»">Hookå†…éƒ¨ç±»</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest6</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//å†…éƒ¨ç±»</span></span><br><span class="line">        <span class="keyword">var</span> innerClass = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo$innerClass&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(innerClass);</span><br><span class="line">        innerClass.<span class="property">$init</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;eeeeeeee&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æšä¸¾æ‰€æœ‰çš„ç±»ä¸ç±»çš„æ‰€æœ‰æ–¹æ³•">æšä¸¾æ‰€æœ‰çš„ç±»ä¸ç±»çš„æ‰€æœ‰æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest7</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//æšä¸¾æ‰€æœ‰çš„ç±»ä¸ç±»çš„æ‰€æœ‰æ–¹æ³•,å¼‚æ­¥æšä¸¾</span></span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">            <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">name,handle</span>)&#123;</span><br><span class="line">                <span class="comment">//è¿‡æ»¤ç±»å</span></span><br><span class="line">                <span class="keyword">if</span>(name.<span class="title function_">indexOf</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>) != -<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(name);</span><br><span class="line">                    <span class="keyword">var</span> clazz = <span class="title class_">Java</span>.<span class="title function_">use</span>(name);</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(clazz);</span><br><span class="line">                    <span class="keyword">var</span> methods = clazz.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(methods);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æšä¸¾æ‰€æœ‰æ–¹æ³•">æšä¸¾æ‰€æœ‰æ–¹æ³•</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hookTest8</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Demo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>);</span><br><span class="line">        <span class="comment">//getDeclaredMethodsæšä¸¾æ‰€æœ‰æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">var</span> methods = <span class="title class_">Demo</span>.<span class="property">class</span>.<span class="title function_">getDeclaredMethods</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>; j &lt; methods.<span class="property">length</span>; j++)&#123;</span><br><span class="line">            <span class="keyword">var</span> methodName = methods[j].<span class="title function_">getName</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(methodName);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> k=<span class="number">0</span>; k&lt;<span class="title class_">Demo</span>[methodName].<span class="property">overloads</span>.<span class="property">length</span>; k++)&#123;</span><br><span class="line">                <span class="title class_">Demo</span>[methodName].<span class="property">overloads</span>[k].<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="variable language_">arguments</span>.<span class="property">length</span>;i++)&#123;</span><br><span class="line">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>[i]);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> <span class="variable language_">this</span>[methodName].<span class="title function_">apply</span>(<span class="variable language_">this</span>,<span class="variable language_">arguments</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸»åŠ¨è°ƒç”¨">ä¸»åŠ¨è°ƒç”¨</h3><p>é™æ€æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">ClassName</span>=<span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>); </span><br><span class="line"><span class="title class_">ClassName</span>.<span class="title function_">privateFunc</span>(<span class="string">&quot;ä¼ å‚&quot;</span>);</span><br></pre></td></tr></table></figure><p>éé™æ€æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ret = <span class="literal">null</span>;</span><br><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.zj.wuaipojie.Demo&quot;</span>,&#123;    <span class="comment">//è¦hookçš„ç±»</span></span><br><span class="line">        <span class="attr">onMatch</span>:<span class="keyword">function</span>(<span class="params">instance</span>)&#123;</span><br><span class="line">            ret=instance.<span class="title function_">privateFunc</span>(<span class="string">&quot;aaaaaaa&quot;</span>); <span class="comment">//è¦hookçš„æ–¹æ³•</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>:<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="comment">//console.log(&quot;result: &quot; + ret);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//return ret;</span></span><br></pre></td></tr></table></figure><p><img src="1854922-20210928094645988-515545896.png" /></p><p><img src="1854922-20210928095039500-1584613007.png" /></p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><p><ahref="https://www.cnblogs.com/andy0816/p/15178704.html">å®‰å“é€†å‘6ï¼Œfridaé€†å‘æ¡†æ¶ä»‹ç»ï¼ŒåŸºç¡€å¼€å‘hookjavaå±‚ï¼Œè¿›é˜¶å¼€å‘hook nativeå±‚ï¼Œhook åŠ å¯†ç±»</a></p><p><ahref="https://www.52pojie.cn/thread-1823118-1-1.html">å®‰å“é€†å‘è¿™æ¡£äº‹ã€‹åä¸‰ã€æ˜¯æ—¶å€™å­¦ä¹ ä¸€ä¸‹Fridaä¸€æŠŠæ¢­äº†(ä¸Š)</a></p><p><ahref="è¯¦è§£Hookæ¡†æ¶fridaï¼Œè®©ä½ åœ¨é€†å‘å·¥ä½œä¸­æ•ˆç‡æˆå€æå‡">è¯¦è§£Hookæ¡†æ¶fridaï¼Œè®©ä½ åœ¨é€†å‘å·¥ä½œä¸­æ•ˆç‡æˆå€æå‡</a></p>]]></content>
      
      
      <categories>
          
          <category> reverseç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hook </tag>
            
            <tag> Frida </tag>
            
            <tag> Android </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¦å·æ‰§è¡Œä¸angr</title>
      <link href="/2024/03/28/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E4%B8%8Eangr/"/>
      <url>/2024/03/28/%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E4%B8%8Eangr/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¬¦å·æ‰§è¡Œä¸angr">ç¬¦å·æ‰§è¡Œä¸<code>angr</code></h1><h2 id="ç¬¦å·æ‰§è¡Œ">ç¬¦å·æ‰§è¡Œ</h2><p>ç¬¦å·æ‰§è¡Œï¼ˆSymbolicExecutionï¼‰æ˜¯ä¸€ç§ç¨‹åºåˆ†ææŠ€æœ¯ï¼Œå¯ä»¥é€šè¿‡é™æ€åˆ†æç¨‹åºæ¥å¾—åˆ°è®©ç‰¹å®šä»£ç åŒºåŸŸæ‰§è¡Œçš„è¾“å…¥ã€‚åŒæ—¶ï¼Œå®ƒæ˜¯ä¸€ç§ç™½ç›’çš„é™æ€åˆ†ææŠ€æœ¯ï¼Œå³åˆ†æç¨‹åºå¯èƒ½çš„è¾“å…¥éœ€è¦èƒ½å¤Ÿè·å–åˆ°ç›®æ ‡æºä»£ç çš„æ”¯æŒã€‚</p><p>ä½¿ç”¨ç¬¦å·æ‰§è¡Œåˆ†æä¸€ä¸ªç¨‹åºæ—¶ï¼Œä¼šä½¿ç”¨ç¬¦å·å€¼ä½œä¸ºè¾“å…¥ï¼Œè€Œéä¸€èˆ¬æ‰§è¡Œç¨‹åºæ—¶ä½¿ç”¨çš„å…·ä½“å€¼ã€‚ç¬”è€…åœ¨å­¦ä¹ çš„æ—¶å€™ï¼Œæ„Ÿè§‰å¯ä»¥ç±»æ¯”æˆæ¦‚ç‡è®ºä¸­çš„ç¦»æ•£éšæœºå˜é‡æˆ–è€…ç¦»æ•£æ•°å­¦ä¸­çš„äº‹ä»¶ã€‚åœ¨è¾¾åˆ°ç›®æ ‡ä»£ç æ—¶ï¼Œåˆ†æå™¨å¯ä»¥å¾—åˆ°ç›¸åº”çš„è·¯å¾„çº¦æŸï¼Œç„¶åé€šè¿‡çº¦æŸæ±‚è§£å™¨æ¥å¾—åˆ°å¯ä»¥è§¦å‘ç›®æ ‡ä»£ç çš„å…·ä½“å€¼ã€‚</p><h2 id="angr"><code>angr</code></h2><h3 id="ç®€ä»‹">ç®€ä»‹</h3><p><code>angr</code>æ˜¯ä¸€ä¸ªå¤šæ¶æ„äºŒè¿›åˆ¶åˆ†æå·¥å…·åŒ…ï¼Œå…·æœ‰æ‰§è¡ŒåŠ¨æ€ç¬¦å·æ‰§è¡Œï¼ˆå¦‚Mayhemã€KLEEç­‰ï¼‰å’Œå¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œå„ç§é™æ€åˆ†æçš„èƒ½åŠ›ï¼Œæ˜¯ç›®å‰æœ€å¥½ç”¨çš„ç¬¦å·æ‰§è¡Œå¼•æ“ä¹‹ä¸€ï¼Œæ˜¯é€†å‘è¾…åŠ©åˆ†æçš„ç¥å™¨ã€‚</p><p>ç¬¦å·æ‰§è¡Œæœ‰ä¸¤ä¸ªåŸºç¡€ï¼šæ‰§è¡Œè·¯å¾„å’Œç¬¦å·ï¼Œä»¥ä¸‹é€šè¿‡è¿™ä¸¤æ–¹é¢æ¥å­¦ä¹ ã€‚</p><p>æ‰§è¡Œè·¯å¾„ï¼šå½“ç¨‹åºè¯»å–æ–‡ä»¶çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°†æ–‡ä»¶è¿›è¡Œç¬¦å·å‘é‡åŒ–å½“ä½œæˆ‘ä»¬çš„è¾“å…¥ã€‚æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª<code>SimFile</code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯ä¸ªæ¨¡æ‹Ÿæ–‡ä»¶ï¼Œç„¶åå°†ç¬¦å·å˜é‡å­˜æ”¾åœ¨æ¨¡æ‹Ÿæ–‡ä»¶ä¸­å¹¶å°†æ¨¡æ‹Ÿæ–‡ä»¶æ’å…¥åˆ°<code>state</code>ä¸­ï¼Œè¿™æ ·åœ¨æ¨¡æ‹Ÿè¿è¡Œæ—¶ï¼Œç¨‹åºå°±ä¼šä»æˆ‘ä»¬æ¨¡æ‹Ÿçš„æ–‡ä»¶ä¸­è¯»å–ç¬¦å·å˜é‡ä½œä¸ºè¾“å…¥çš„å‚æ•°è¿›è¡Œåç»­çš„è¿è¡Œã€‚</p><p>ç¬¦å·ï¼šå½“ç”¨æˆ·è¾“å…¥æ˜¯ä»æ ‡å‡†è¾“å…¥ï¼ˆ<code>stdin</code>ï¼‰ä¸­è·å¾—ï¼Œæ¯”å¦‚ç®€å•è°ƒç”¨<code>scanf</code>å‡½æ•°çš„æ—¶å€™ï¼Œ<code>angr</code>ä¼šè‡ªåŠ¨æ³¨å…¥ç¬¦å·è¿›è¡Œç¬¦å·åŒ–ï¼›ç„¶è€Œï¼Œå½“ç”¨æˆ·è¾“å…¥æ›´å¤æ‚ï¼Œæ¯”å¦‚<code>scanf</code>å‡½æ•°çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²å¾ˆå¤æ‚ï¼Œæˆ–è€…ä»æ–‡ä»¶ã€ç½‘ç»œæˆ–è€…UIä¸­è·å–è¾“å…¥çš„æ—¶å€™ï¼Œ<code>angr</code>åˆ™ä¸ä¼šè‡ªåŠ¨æ³¨å…¥ç¬¦å·ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨åœ¨éœ€è¦çš„åœ°æ–¹è¿›è¡Œæ³¨å…¥ç¬¦å·ã€‚<code>angr</code>ä¸­çš„ç¬¦å·æ˜¯ç”±<code>bitvector</code>ï¼ˆä½å‘é‡ï¼‰è¡¨ç¤ºçš„ï¼Œè¿™ä¸€ç‚¹ä¸<code>z3</code>çº¦æŸæ±‚è§£å™¨ç±»ä¼¼ï¼Œå…¶å®<code>angr</code>ä¸<code>z3</code>åœ¨ç¬”è€…çœ‹æ¥æœ‰å¾ˆå¤šç±»ä¼¼ä¹‹å¤„ï¼Œéƒ½å¯ä»¥è¿›è¡Œçº¦æŸæ¡ä»¶ä¸‹çš„é—®é¢˜æ±‚è§£ã€‚</p><p>Angrå…¶å®å¹¶ä¸æ˜¯çœŸæ­£è¢«è¿è¡Œèµ·æ¥çš„ï¼Œå®ƒå°±å‘ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œä¼šè¯»å–æ¯ä¸€æ¡å‘½ä»¤å¹¶åœ¨è™šæ‹Ÿæœºä¸­æ¨¡æ‹Ÿè¯¥å‘½ä»¤çš„è¡Œä¸ºã€‚æˆ‘ä»¬ç±»æ¯”åˆ°æ›´åŠ å¸¸ç”¨çš„z3 åº“ä¸­ï¼Œæ¯ä¸ªå¯„å­˜å™¨éƒ½å¯ä»¥ç›¸å½“ä¸ z3ä¸­çš„ä¸€ä¸ªå˜é‡ï¼Œåœ¨æ¨¡æ‹Ÿæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œè¿™ä¸ªå˜é‡ä¼šè¢«å»¶ä¼¸ä¸ºä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè€Œå½“æˆ‘ä»¬æˆåŠŸæ‰¾åˆ°äº†ç›®æ ‡åœ°å€ä¹‹åï¼Œé€šè¿‡è¡¨è¾¾å¼å°±å¯ä»¥æ±‚è§£å¯¹åº”çš„åˆå€¼åº”è¯¥æ˜¯ä»€ä¹ˆäº†ã€‚</p><h3 id="å®‰è£…">å®‰è£…</h3><p>è¿™é‡Œæä¾›çš„æ˜¯<code>docoker</code>å®‰è£…æ–¹å¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æ‹‰å–dockeré•œåƒï¼ˆæ³¨æ„åå­—æ˜¯angr/angrï¼‰</span></span><br><span class="line">docker pull angr/angr</span><br><span class="line"><span class="comment">#ä¸¤ç§æ–¹å¼ä¸æœ¬åœ°è¿›è¡Œäº¤äº’ï¼Œä¸€ç§æ˜¯æŠŠæœ¬åœ°çš„ä¸€ä¸ªæ–‡ä»¶å¤¹æ˜ å°„åˆ°å®¹å™¨çš„/angrï¼Œå¦‚ä¸‹</span></span><br><span class="line">docker run -it -v æœ¬åœ°æ–‡ä»¶å¤¹è·¯å¾„:/angr angr/angr</span><br><span class="line"><span class="comment">#å¦ä¸€ç§æ˜¯æŠŠæœ¬åœ°æ–‡ä»¶cpåˆ°å®¹å™¨ä¸­çš„/angrï¼Œå¦‚ä¸‹</span></span><br><span class="line">docker <span class="built_in">cp</span> æœ¬åœ°æ–‡ä»¶è·¯å¾„ å®¹å™¨<span class="built_in">id</span>æˆ–åå­—:/angr</span><br><span class="line"><span class="comment">#åŒç†ï¼Œä¹Ÿå¯ä»¥æŠŠå®¹å™¨/angrä¸‹çš„æ–‡ä»¶cpåˆ°æœ¬åœ°</span></span><br><span class="line">docker <span class="built_in">cp</span> å®¹å™¨<span class="built_in">id</span>æˆ–åå­—:/angr æœ¬åœ°æ–‡ä»¶è·¯å¾„</span><br><span class="line"><span class="comment">#è¿›å…¥å®¹å™¨ç¯å¢ƒ</span></span><br><span class="line">docker <span class="built_in">exec</span> -it å®¹å™¨<span class="built_in">id</span> bash</span><br></pre></td></tr></table></figure><h3 id="åœ¨ctfä¸­çš„åº”ç”¨">åœ¨ctfä¸­çš„åº”ç”¨</h3><h4 id="ç®€å•reé¢˜">ç®€å•reé¢˜</h4><p>ç¬”è€…å­¦ä¹ <code>angr</code>ä¸»è¦æ˜¯åœ¨ctfé€†å‘é¢˜ä¸­åº”ç”¨ï¼Œæ‰€ä»¥ä¹Ÿæ²¡æœ‰æ·±å­¦ï¼Œç®€å•å­¦ä¹ äº†ä¸€ä¸‹æµç¨‹ï¼Œçœ‹äº†å‡ ä½å¤§ä½¬çš„åšå®¢ï¼Œä¸»è¦æŒæ¡æµç¨‹è„šæœ¬</p><p><code>angr</code>çš„ä¸€èˆ¬æµç¨‹ï¼Œä¸€æŠŠæ¢­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">project = angr.Project(path_to_binary, auto_load_libs=<span class="literal">False</span>)    <span class="comment"># åŠ è½½ç¨‹åºï¼Œæ³¨æ„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œä¸æ˜¯æ–‡ä»¶å</span></span><br><span class="line">state = project.factory.entry_state()       <span class="comment"># åˆ›å»ºä¸€ä¸ªçŠ¶æ€,é»˜è®¤ä¸ºç¨‹åºçš„å…¥å£åœ°å€</span></span><br><span class="line">simgr = project.factory.simgr(state)      <span class="comment"># åˆ›å»ºä¸€ä¸ªæ¨¡æ‹Ÿå™¨ç”¨æ¥æ¨¡æ‹Ÿç¨‹åºæ‰§è¡Œ,éå†æ‰€æœ‰è·¯å¾„</span></span><br><span class="line">simgr.explore(find=addr_1,avoid=addr_2)   <span class="comment"># çº¦æŸæ‰§è¡Œçš„æµç¨‹ï¼Œaddr1ä¸ºé¢„æœŸæ‰§è¡Œåœ°å€ï¼Œaddr2ä¸ºé¿å…åœ°å€ï¼ˆavoidä¸ä¸€å®šæœ‰ï¼‰</span></span><br><span class="line"><span class="built_in">print</span>(simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))      <span class="comment">#æ‰“å°ç»“æœ</span></span><br></pre></td></tr></table></figure><h4 id="åollvm">å<code>OLLVM</code></h4><p>ç¬”è€…ä¹Ÿæ˜¯å­¦åˆ°ä¸€åŠæ‰æƒ³åˆ°ï¼Œä¹‹å‰åœ¨å­¦ä¹ <code>OLLVM</code>çš„æ—¶å€™ç”¨çš„åæ··æ·†å·¥å…·<code>deflat</code>å°±æ˜¯åŸºäº<code>angr</code>æ¡†æ¶çš„ï¼Œæ‹è„‘è¢‹ä¸€æƒ³ï¼Œè¿˜çœŸæ˜¯~</p><p>ç¬¦å·æ‰§è¡Œä¸æ˜¯å°±æ˜¯å»é™¤æ§åˆ¶æµå¹³å¦åŒ–çš„ç»ä½³åŠæ³•ä¹‹ä¸€å—ï¼</p><p>åˆ©ç”¨<code>angr</code>ç¬¦å·æ‰§è¡Œå»é™¤æ§åˆ¶æµå¹³å¦åŒ–çš„æ­¥éª¤å¯ä»¥å½’ç»“ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p><ol type="1"><li>é™æ€åˆ†æCFGå¾—åˆ°åºè¨€/å…¥å£å—ï¼ˆPrologueï¼‰ã€ä¸»åˆ†å‘å™¨ï¼ˆMaindispatcherï¼‰ã€å­åˆ†å‘å™¨/æ— ç”¨å—ï¼ˆSub dispatchersï¼‰ã€çœŸå®å—ï¼ˆRelevantblocksï¼‰ã€é¢„åˆ†å‘å™¨ï¼ˆPredispatcherï¼‰å’Œè¿”å›å—ï¼ˆReturnï¼‰</li><li>åˆ©ç”¨ç¬¦å·æ‰§è¡Œæ¢å¤çœŸå®å—çš„å‰åå…³ç³»ï¼Œé‡å»ºæ§åˆ¶æµ</li><li>æ ¹æ®ç¬¬äºŒæ­¥é‡å»ºçš„æ§åˆ¶æµPatchç¨‹åºï¼Œè¾“å‡ºæ¢å¤åçš„å¯æ‰§è¡Œæ–‡ä»¶</li></ol><h4 id="vm"><code>VM</code></h4><p>å¦‚æœ<code>VM</code>é¢˜ç›®çš„ç®—æ³•é€»è¾‘æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥è€ƒè™‘ç›´æ¥ç”¨<code>angr</code>ä¸€æŠŠæ¢­ï¼Œä½†ä¹Ÿä¸æ˜¯å…¨èƒ½çš„ï¼Œå¦‚æœå‡ºé¢˜äººæœ‰æ„è®¾ç½®é™·é˜±ä¾‹å¦‚æ„é€ é™·é˜±å¾ªç¯é€’å½’ã€æœ‰æ„å¤æ‚åŒ–æ§åˆ¶æµå¯èƒ½å¯¼è‡´è·¯å¾„çˆ†ç‚¸ç­‰é—®é¢˜ï¼Œè¶…å‡ºäº†ç¬¦å·æ‰§è¡Œå¯ä»¥è§£å†³çš„èƒ½åŠ›èŒƒå›´ï¼Œè¿™ä¸ªæ—¶å€™è¿˜æ˜¯è€è€å®å®æ‰‹æ“å§~</p><h3 id="æµç¨‹åŸç†ä»‹ç»æ¬çš„ä½¬-çš„åšå®¢åŸæ–‡">*æµç¨‹åŸç†ä»‹ç»(æ¬çš„ä½¬çš„åšå®¢åŸæ–‡)</h3><h4 id="åˆ›å»ºproject">åˆ›å»ºProject</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path_to_binary = <span class="string">&quot;./00_angr_find&quot;</span> </span><br><span class="line">project = angr.Project(path_to_binary, auto_load_libs=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨angrçš„é¦–è¦æ­¥éª¤å°±æ˜¯åˆ›å»ºProjectåŠ è½½äºŒè¿›åˆ¶æ–‡ä»¶ã€‚angrçš„äºŒè¿›åˆ¶è£…è½½ç»„ä»¶æ˜¯CLEï¼Œå®ƒè´Ÿè´£è£…è½½äºŒè¿›åˆ¶å¯¹è±¡ï¼ˆä»¥åŠå®ƒä¾èµ–çš„ä»»ä½•åº“ï¼‰å’ŒæŠŠè¿™ä¸ªå¯¹è±¡ä»¥æ˜“äºæ“ä½œçš„æ–¹å¼äº¤ç»™angrçš„å…¶ä»–ç»„ä»¶ã€‚angrå°†è¿™äº›åŒ…å«åœ¨Projectç±»ä¸­ã€‚ä¸€ä¸ªProjectç±»æ˜¯ä»£è¡¨äº†ä½ çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„å®ä½“ã€‚ä½ ä¸angrçš„å¤§éƒ¨åˆ†æ“ä½œéƒ½ä¼šç»è¿‡å®ƒ</p><p>auto_load_libsè®¾ç½®æ˜¯å¦è‡ªåŠ¨è½½å…¥ä¾èµ–çš„åº“ï¼Œåœ¨åŸºç¡€é¢˜ç›®ä¸­æˆ‘ä»¬ä¸€èˆ¬ä¸éœ€è¦åˆ†æå¼•å…¥çš„åº“æ–‡ä»¶ï¼Œè¿™é‡Œè®¾ç½®ä¸ºå¦</p><blockquote><ul><li>å¦‚æœ<code>auto_load_libs</code>æ˜¯<code>True</code>ï¼ˆé»˜è®¤å€¼ï¼‰ï¼ŒçœŸæ­£çš„åº“å‡½æ•°ä¼šè¢«æ‰§è¡Œã€‚è¿™å¯èƒ½æ­£æ˜¯ä¹Ÿå¯èƒ½ä¸æ˜¯ä½ æƒ³è¦çš„ï¼Œå–å†³äºå…·ä½“çš„å‡½æ•°ã€‚æ¯”å¦‚è¯´ä¸€äº›libcçš„å‡½æ•°åˆ†æèµ·æ¥è¿‡äºå¤æ‚å¹¶ä¸”å¾ˆæœ‰å¯èƒ½å¼•èµ·pathå¯¹å…¶çš„å°è¯•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„stateæ•°é‡çš„çˆ†ç‚¸å¢é•¿</li><li>å¦‚æœ<code>auto_load_libs</code>æ˜¯<code>False</code>ï¼Œä¸”å¤–éƒ¨å‡½æ•°æ˜¯æ— æ³•æ‰¾åˆ°çš„ï¼Œå¹¶ä¸”Projectä¼šå°†å®ƒä»¬å¼•ç”¨åˆ°ä¸€ä¸ªé€šç”¨çš„å«åš<code>ReturnUnconstrained</code>çš„<code>SimProcedure</code>ä¸Šå»ï¼Œå®ƒå°±åƒå®ƒçš„åå­—æ‰€è¯´çš„é‚£æ ·ï¼šå®ƒè¿”å›ä¸€ä¸ªä¸å—çº¦æŸçš„å€¼</li></ul></blockquote><h4 id="è®¾ç½®-state">è®¾ç½® state</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">initial_state = project.factory.entry_state()</span><br></pre></td></tr></table></figure><p>stateä»£è¡¨ç¨‹åºçš„ä¸€ä¸ªå®ä¾‹é•œåƒï¼Œæ¨¡æ‹Ÿæ‰§è¡ŒæŸä¸ªæ—¶åˆ»çš„çŠ¶æ€ï¼Œå°±ç±»ä¼¼äº<strong>å¿«ç…§</strong>ã€‚ä¿å­˜è¿è¡ŒçŠ¶æ€çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚å†…å­˜/å¯„å­˜å™¨ç­‰,æˆ‘ä»¬è¿™é‡Œä½¿ç”¨<code>project.factory.entry_state()</code>å‘Šè¯‰ç¬¦å·æ‰§è¡Œå¼•æ“ä»ç¨‹åºçš„å…¥å£ç‚¹å¼€å§‹ç¬¦å·æ‰§è¡Œï¼Œé™¤äº†ä½¿ç”¨<code>.entry_state()</code>åˆ›å»º state å¯¹è±¡, æˆ‘ä»¬è¿˜å¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨å…¶ä»–æ„é€ å‡½æ•°åˆ›å»º state</p><h4 id="è®¾ç½®-simulation-managers">è®¾ç½® Simulation Managers</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">simulation = project.factory.simgr(initial_state)</span><br></pre></td></tr></table></figure><p>Projectå¯¹è±¡ä»…è¡¨ç¤ºç¨‹åºä¸€å¼€å§‹çš„æ ·å­ï¼Œè€Œåœ¨æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯å¯¹SimStateå¯¹è±¡è¿›è¡Œæ“ä½œï¼Œå®ƒä»£è¡¨ç¨‹åºçš„ä¸€ä¸ªå®ä¾‹é•œåƒï¼Œæ¨¡æ‹Ÿæ‰§è¡ŒæŸä¸ªæ—¶åˆ»çš„çŠ¶æ€</p><p><code>SimState</code>å¯¹è±¡åŒ…å«ç¨‹åºè¿è¡Œæ—¶ä¿¡æ¯ï¼Œå¦‚å†…å­˜/å¯„å­˜å™¨/æ–‡ä»¶ç³»ç»Ÿæ•°æ®ç­‰ã€‚SMï¼ˆSimulationManagersï¼‰æ˜¯angrä¸­æœ€é‡è¦çš„æ§åˆ¶æ¥å£ï¼Œå®ƒä½¿ä½ èƒ½å¤ŸåŒæ—¶æ§åˆ¶ä¸€ç»„çŠ¶æ€(state)çš„ç¬¦å·æ‰§è¡Œï¼Œåº”ç”¨æœç´¢ç­–ç•¥æ¥æ¢ç´¢ç¨‹åºçš„çŠ¶æ€ç©ºé—´ã€‚</p><h4 id="è¿è¡Œæ¢ç´¢æ»¡è¶³è·¯å¾„éœ€è¦çš„å€¼">è¿è¡Œï¼Œæ¢ç´¢æ»¡è¶³è·¯å¾„éœ€è¦çš„å€¼</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print_good_address = <span class="number">0x8048678</span>  </span><br><span class="line">simulation.explore(find=print_good_address)</span><br></pre></td></tr></table></figure><p>ç¬¦å·æ‰§è¡Œæœ€æ™®éçš„æ“ä½œæ˜¯æ‰¾åˆ°èƒ½å¤Ÿåˆ°è¾¾æŸä¸ªåœ°å€çš„çŠ¶æ€ï¼ŒåŒæ—¶ä¸¢å¼ƒå…¶ä»–ä¸èƒ½åˆ°è¾¾è¿™ä¸ªåœ°å€çš„çŠ¶æ€ã€‚SMä¸ºä½¿ç”¨è¿™ç§æ‰§è¡Œæ¨¡å¼æä¾›äº†<code>.explore()</code>æ–¹æ³•</p><p>å½“ä½¿ç”¨<code>find</code>å‚æ•°å¯åŠ¨<code>.explore()</code>æ–¹æ³•æ—¶ï¼Œç¨‹åºå°†ä¼šä¸€ç›´æ‰§è¡Œï¼Œç›´åˆ°å‘ç°äº†ä¸€ä¸ªå’Œ<code>find</code>å‚æ•°æŒ‡å®šçš„æ¡ä»¶ç›¸åŒ¹é…çš„çŠ¶æ€ã€‚<code>find</code>å‚æ•°çš„å†…å®¹å¯ä»¥æ˜¯æƒ³è¦æ‰§è¡Œåˆ°çš„æŸä¸ªåœ°å€ã€æˆ–è€…æƒ³è¦æ‰§è¡Œåˆ°çš„åœ°å€åˆ—è¡¨ã€æˆ–è€…ä¸€ä¸ªè·å–stateä½œä¸ºå‚æ•°å¹¶åˆ¤æ–­è¿™ä¸ªstateæ˜¯å¦æ»¡è¶³æŸäº›æ¡ä»¶çš„å‡½æ•°ã€‚å½“<code>active</code>stashä¸­çš„ä»»æ„çŠ¶æ€å’Œ<code>find</code>ä¸­çš„æ¡ä»¶åŒ¹é…çš„æ—¶å€™ï¼Œå®ƒä»¬å°±ä¼šè¢«æ”¾åˆ°<code>found stash</code>ä¸­ï¼Œæ‰§è¡Œéšå³åœæ­¢ã€‚ä¹‹åä½ å¯ä»¥æ¢ç´¢æ‰¾åˆ°çš„çŠ¶æ€ï¼Œæˆ–è€…å†³å®šä¸¢å¼ƒå®ƒï¼Œè½¬è€Œæ¢ç´¢å…¶å®ƒçŠ¶æ€ã€‚</p><h4 id="è·å–æ‰§è¡Œç»“æœ">è·å–æ‰§è¡Œç»“æœ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> simulation.found:</span><br><span class="line">        solution_state = simulation.found[<span class="number">0</span>]  <span class="comment"># è·å–é€šè¿‡ explore æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„çŠ¶æ€</span></span><br><span class="line">        solution = solution_state.posix.dumps(sys.stdin.fileno())</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Success! Solution is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(solution.decode(<span class="string">&quot;utf-8&quot;</span>)))</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç›¸å…³çš„çŠ¶æ€å·²ç»ä¿å­˜åœ¨äº†<code>simgr</code>å½“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>simgr.found</code>æ¥è®¿é—®æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„åˆ†æ”¯ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ºäº†è§£é¢˜ï¼Œå°±é€‰æ‹©ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„åˆ†æ”¯å³å¯</p><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹<code>sys.stdin.fileno()</code>,åœ¨UNIXä¸­ï¼ŒæŒ‰ç…§æƒ¯ä¾‹ï¼Œä¸‰ä¸ªæ–‡ä»¶æè¿°ç¬¦åˆ†åˆ«è¡¨ç¤ºæ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.stdin.fileno()</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.stdout.fileno()</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.stderr.fileno()</span><br><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥ä¸€èˆ¬ä¹Ÿå¯ä»¥å†™æˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">solution = solution_state.posix.dumps(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><h4 id="ä¾‹é¢˜">ä¾‹é¢˜</h4><h5 id="ç½‘é¼æ¯-2020-é’é¾™ç»„singal">[ç½‘é¼æ¯ 2020 é’é¾™ç»„]singal</h5><p><img src="image-20240322224806843.png" /></p><p><code>main</code>å‡½æ•°é€»è¾‘ç®€å•ï¼Œå°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºé€†å‘å‡½æ•°</p><p>æ‰¾ä¸€ä¸‹<code>find</code>å’Œ<code>avoid</code></p><p><img src="image-20240322225301783.png" /></p><p>æ•´ä¸ª<code>vm_operad</code>å‡½æ•°åªæœ‰è¿™ä¸€å¤„<code>return</code>ï¼ŒçŒœæµ‹æ˜¯æ­£ç¡®è¾“å‡º</p><p><img src="image-20240322225356421.png" /></p><p><code>find</code>çš„åœ°å€æ˜¯<code>0x40175E</code>ï¼Œæˆ–è€…é€‰æ‹©<code>main</code>å‡½æ•°ä¸­<code>puts</code>çš„åœ°å€ä¹Ÿå¯</p><p><img src="image-20240322225711232.png" /></p><p><img src="image-20240322225759329.png" /></p><p><code>avoid</code>çš„åœ°å€æ˜¯<code>0x4016E6</code></p><p><code>angr</code>ä¸€æŠŠæ¢­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">project = angr.Project(<span class="string">&#x27;./signal.exe&#x27;</span>, auto_load_libs=<span class="literal">False</span>)</span><br><span class="line">state = project.factory.entry_state()</span><br><span class="line">simgr = project.factory.simgr(state)</span><br><span class="line">simgr.explore(find=<span class="number">0x40175E</span>,avoid=<span class="number">0x4016E6</span>)</span><br><span class="line"><span class="built_in">print</span>(simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))</span><br></pre></td></tr></table></figure><p><img src="image-20240322225927809.png" /></p><h5 id="nkctf2024reez">[nkctf2024]REEZ</h5><p><img src="image-20240328124939161.png" /></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line">project = angr.Project(<span class="string">&#x27;./outputfile&#x27;</span>, auto_load_libs=<span class="literal">False</span>)</span><br><span class="line">state = project.factory.entry_state()</span><br><span class="line">simgr = project.factory.simgr(state)</span><br><span class="line">simgr.explore(find=<span class="keyword">lambda</span> s: <span class="string">b&quot;What can I say? You are so great!&quot;</span> <span class="keyword">in</span> s.posix.dumps(<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(simgr.found[<span class="number">0</span>].posix.dumps(<span class="number">0</span>))</span><br></pre></td></tr></table></figure><p>æ³¨æ„<code>explore</code>çš„æ¡ä»¶ä¸æ˜¯åœ°å€ï¼Œè¿™ä¸ªé¢˜æ²¡æ³•ç”¨åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">simgr.explore(find=<span class="keyword">lambda</span> s: <span class="string">b&quot;What can I say? You are so great!&quot;</span> <span class="keyword">in</span> s.posix.dumps(<span class="number">1</span>))</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯chatç»™çš„å„ä¸ªå‚æ•°çš„è§£é‡Š</p><p>è®©æˆ‘ä»¬é€ä¸ªè§£é‡Šè¿™æ®µä»£ç ä¸­çš„å„ä¸ªå‚æ•°çš„å«ä¹‰ï¼š</p><ol type="1"><li><code>simgr</code>: è¿™å¾ˆå¯èƒ½æ˜¯ä¸€ä¸ªç¬¦å·æ‰§è¡Œç®¡ç†å™¨ï¼ˆSymbolic ExecutionManagerï¼‰çš„å®ä¾‹ï¼Œç”¨äºç®¡ç†ç¬¦å·æ‰§è¡Œè¿‡ç¨‹ä¸­çš„çŠ¶æ€å’Œè·¯å¾„ã€‚</li><li><code>explore()</code>:è¿™æ˜¯ç¬¦å·æ‰§è¡Œç®¡ç†å™¨ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºæ¢ç´¢ç¨‹åºçš„ä¸åŒè·¯å¾„ã€‚</li><li><code>find=lambda s: b"What can I say? You are so great!" in s.posix.dumps(1)</code>:è¿™æ˜¯ <code>explore()</code>æ–¹æ³•çš„å‚æ•°ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºæŒ‡å®šç¬¦å·æ‰§è¡Œæ—¶çš„æ¡ä»¶ã€‚åœ¨è¿™é‡Œï¼Œ<code>lambda s: ...</code>æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œ<code>s</code> æ˜¯ç¬¦å·æ‰§è¡ŒçŠ¶æ€çš„ä¸€ä¸ªå˜é‡ã€‚æ¡ä»¶<code>b"What can I say? You are so great!" in s.posix.dumps(1)</code>æŒ‡å®šäº†å½“ç¬¦å·æ‰§è¡ŒçŠ¶æ€ <code>s</code>çš„æ ‡å‡†è¾“å‡ºä¸­åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²æ—¶åœæ­¢æ¢ç´¢ã€‚<ul><li><code>s</code>: ç¬¦å·æ‰§è¡ŒçŠ¶æ€ï¼Œä»£è¡¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªçŠ¶æ€ã€‚</li><li><code>s.posix.dumps(1)</code>: è¿™éƒ¨åˆ†æ˜¯è·å–ç¬¦å·æ‰§è¡ŒçŠ¶æ€<code>s</code> çš„æ ‡å‡†è¾“å‡ºçš„å†…å®¹ã€‚åœ¨è¿™é‡Œï¼Œ<code>1</code>è¡¨ç¤ºæ ‡å‡†è¾“å‡ºæ–‡ä»¶æè¿°ç¬¦ï¼ˆstdoutï¼‰ï¼Œ<code>s.posix.dumps(1)</code>è¿”å›æ ‡å‡†è¾“å‡ºçš„å†…å®¹ä½œä¸ºä¸€ä¸ªå­—èŠ‚ä¸²ã€‚</li><li><code>b"What can I say? You are so great!" in s.posix.dumps(1)</code>:è¿™éƒ¨åˆ†æ˜¯æ¡ä»¶ï¼Œè¡¨ç¤ºå½“ç‰¹å®šå­—ç¬¦ä¸²å­˜åœ¨äºæ ‡å‡†è¾“å‡ºä¸­æ—¶ï¼Œåœæ­¢æ¢ç´¢ã€‚</li></ul></li></ol><h5 id="æœ‰å‚æ•°è„šæœ¬">æœ‰å‚æ•°è„šæœ¬</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> angr</span><br><span class="line"><span class="keyword">import</span> claripy</span><br><span class="line">proj = angr.Project(<span class="string">&#x27;./angr2&#x27;</span>, auto_load_libs=<span class="literal">False</span>)</span><br><span class="line">argv1 = claripy.BVS(<span class="string">&quot;argv1&quot;</span>, <span class="number">9</span> * <span class="number">8</span>) // è¿™é‡Œç”¨çš„å•ä½æ˜¯bit, å› æ­¤éœ€è¦ä¹˜ä»¥<span class="number">8</span></span><br><span class="line">state = proj.factory.entry_state(args=[<span class="string">&#x27;./angr2&#x27;</span>, argv1]) // å¯¼å…¥å‚æ•°</span><br><span class="line">simgr = proj.factory.simgr(state)</span><br><span class="line"><span class="built_in">print</span>(simgr.explore(find=<span class="number">0x4007DC</span>, avoid=<span class="number">0x4007EA</span>))</span><br><span class="line"><span class="built_in">print</span>(simgr.found[<span class="number">0</span>].solver.<span class="built_in">eval</span>(argv1, cast_to=<span class="built_in">bytes</span>)) // ç›´æ¥è¾“å‡ºæ˜¯<span class="built_in">ascii</span>ç , ç”¨cast_to=<span class="built_in">bytes</span>è½¬ä¸º<span class="built_in">bytes</span>ç±»å‹</span><br></pre></td></tr></table></figure><h2 id="çº¦æŸæ±‚è§£">çº¦æŸæ±‚è§£</h2><h3 id="smt"><code>SMT</code></h3><p>å‰é¢è¯´äº†è¿™ä¹ˆå¤šï¼Œå…¶å®æ²¡æœ‰æåˆ°ï¼Œå¦‚ä½•æ±‚è§£çº¦æŸæ¡ä»¶ä¸‹çš„é—®é¢˜å‘¢ï¼Ÿ<code>SMT</code>å°±æ˜¯é‡è¦çš„åŸç†æ–¹æ³•ä¹‹ä¸€ï¼Œ<code>z3</code>ã€<code>ida</code>çš„<code>Ponce</code>æ’ä»¶å°±æ˜¯ç”¨çš„<code>SMT</code>ã€‚</p><p><code>SAT</code>ï¼ˆsatisfiabilityï¼‰é—®é¢˜æŒ‡çš„æ˜¯å‘½é¢˜é€»è¾‘å…¬å¼çš„å¯æ»¡è¶³æ€§é—®é¢˜ã€‚ä½†æ˜¯<code>SAT</code> åœ¨è¡¨è¾¾èƒ½åŠ›ä¸Šæœ‰å¾ˆå¤§çš„å±€é™æ€§ï¼Œéœ€è¦æ¯”<code>SAT</code>æ›´å¼ºçš„è¡¨è¾¾æ–¹å¼ã€‚åœ¨è¿™ç§å½¢åŠ¿ä¸‹ï¼Œå°†<code>SAT</code>é—®é¢˜æ‰©å±•ä¸º<code>SMT</code>ï¼Œç»è¿‡æ‰©å±•ï¼Œ<code>SMT</code>èƒ½æ¯”<code>SAT</code>æ›´å¥½åœ°è¡¨è¾¾ä¸€äº›äººå·¥æ™ºèƒ½å’Œå½¢å¼åŒ–æ–¹æ³•é¢†åŸŸå†…çš„é—®é¢˜ï¼Œæ¯”å¦‚åœ¨èµ„æºè§„åˆ’ã€æ—¶åºæ¨ç†ã€ç¼–è¯‘å™¨ä¼˜åŒ–ç­‰å¾ˆå¤šæ–¹é¢ç”¨åˆ°äº†<code>SMT</code>ã€‚</p><p><code>SMT</code> çš„å…¨ç§°æ˜¯ Satisfiability ModuloTheoriesï¼Œå¯è¢«ç¿»è¯‘ä¸ºâ€œå¯æ»¡è¶³æ€§æ¨¡ç†è®ºâ€ã€â€œå¤šç†è®ºä¸‹çš„å¯æ»¡è¶³æ€§é—®é¢˜â€æˆ–è€…â€œç‰¹å®šï¼ˆèƒŒæ™¯ï¼‰ç†è®ºä¸‹çš„å¯æ»¡è¶³æ€§é—®é¢˜â€ï¼Œå…¶åˆ¤å®šç®—æ³•è¢«ç§°ä¸º<code>SMT</code> æ±‚è§£å™¨ã€‚ç®€å•åœ°è¯´ï¼Œä¸€ä¸ª<code>SMT</code>å…¬å¼æ˜¯ç»“åˆäº†ç†è®ºèƒŒæ™¯çš„é€»è¾‘å…¬å¼ï¼Œå…¶ä¸­çš„å‘½é¢˜å˜é‡å¯ä»¥ä»£è¡¨ç†è®ºå…¬å¼ã€‚</p><h2 id="ç»“è¯­">ç»“è¯­</h2><p>æœ¬æ–‡éåŸåˆ›ï¼Œå‰é¢ä¹Ÿæåˆ°ï¼Œç¬”è€…æ˜¯å­¦ä¹ reçš„è¿‡ç¨‹ä¸­æ¥äº†è§£ä¸€ä¸‹çš„ï¼Œä¸»è¦æ˜¯æ‘˜å½•äº†å‡ ä½å¤§ä½¬çš„åšå®¢ï¼Œè¯¦ç»†å†…å®¹æ²¡æœ‰å­¦ä¹ å®Œå…¨ï¼Œåœ¨è¿™é‡Œé™„ä¸Šé“¾æ¥:</p><p><ahref="https://bbs.kanxue.com/thread-264878.htm">[åŸåˆ›]angrå­¦ä¹ ï¼ˆäºŒï¼‰-ç¬¦å·æ‰§è¡Œä¸angr_ctf_00/01/02</a></p><p><a href="https://www.wangan.com/p/11v74d3c17b0eae9">Angrä½¿ç”¨æŠ€å·§é€Ÿé€šç¬”è®°</a></p><p><ahref="https://ylcao.top/2022/05/10/%E5%85%A5%E9%97%A8angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E6%A1%86%E6%9E%B6/">å…¥é—¨angrç¬¦å·æ‰§è¡Œæ¡†æ¶</a></p><p><a href="https://zhuanlan.zhihu.com/p/623524832">Angrä½¿ç”¨æŠ€å·§é€Ÿé€šç¬”è®°</a></p><p><ahref="https://bluesadi.me/0x401RevTrain-Tools/angr/10_%E5%88%A9%E7%94%A8angr%E7%AC%A6%E5%8F%B7%E6%89%A7%E8%A1%8C%E5%8E%BB%E9%99%A4%E6%8E%A7%E5%88%B6%E6%B5%81%E5%B9%B3%E5%9D%A6%E5%8C%96/">åˆ©ç”¨angrç¬¦å·æ‰§è¡Œå»é™¤æ§åˆ¶æµå¹³å¦åŒ–</a></p><p><ahref="https://www.anquanke.com/post/id/212816">Angr_CTFä»å…¥é—¨åˆ°ç²¾é€š</a></p>]]></content>
      
      
      <categories>
          
          <category> reverseç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reverse </tag>
            
            <tag> angr </tag>
            
            <tag> ç¬¦å·æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èŠ±æŒ‡ä»¤</title>
      <link href="/2024/01/27/%E8%8A%B1%E6%8C%87%E4%BB%A4/"/>
      <url>/2024/01/27/%E8%8A%B1%E6%8C%87%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="èŠ±æŒ‡ä»¤">èŠ±æŒ‡ä»¤</h1><h2 id="æ¦‚å¿µ">æ¦‚å¿µ</h2><p>èŠ±æŒ‡ä»¤ï¼Œ<code>junk code</code>ï¼Œä¹Ÿå°±æ˜¯åƒåœ¾ä»£ç ã€‚å®é™…ä¸ŠèŠ±æŒ‡ä»¤çš„ç¡®æ˜¯ä¸€äº›ä¸å½±å“ç¨‹åºé€»è¾‘çš„åƒåœ¾æœºå™¨ç ï¼Œå®ƒå­˜åœ¨çš„å”¯ä¸€æ„ä¹‰å°±æ˜¯å¹²æ‰°åæ±‡ç¼–å¼•æ“å’Œäººä¸ºåˆ†æ</p><p>èŠ±æŒ‡ä»¤åœ¨çœŸå®ä»£ç ä¸­æ’å…¥ä¸€äº›åƒåœ¾ä»£ç çš„åŒæ—¶è¿˜ä¿è¯åŸæœ‰ç¨‹åºçš„æ­£ç¡®æ‰§è¡Œï¼Œè€Œç¨‹åºæ— æ³•å¾ˆå¥½åœ°åç¼–è¯‘ï¼Œéš¾ä»¥ç†è§£ç¨‹åºå†…å®¹ï¼Œè¾¾åˆ°æ··æ·†è§†å¬çš„æ•ˆæœï¼Œå› æ­¤åœ¨ç¨‹åºçš„é™æ€åˆ†æå¯¹æŠ—ä¸­å¯ä»¥èµ·åˆ°æ•ˆæœï¼ˆä¹ŸåŒ…æ‹¬ä½¿reé¢˜å˜å¤æ‚</p><h2 id="åˆ†ç±»">åˆ†ç±»</h2><p>èŠ±æŒ‡ä»¤å¤§è‡´å¯ä»¥åˆ†ä¸ºå¯æ‰§è¡ŒèŠ±æŒ‡ä»¤å’Œä¸å¯æ‰§è¡ŒèŠ±æŒ‡ä»¤ä¸¤ç±»</p><h3 id="å¯æ‰§è¡ŒèŠ±æŒ‡ä»¤">å¯æ‰§è¡ŒèŠ±æŒ‡ä»¤</h3><p>å¯æ‰§è¡Œçš„èŠ±æŒ‡ä»¤æœ¬è´¨æ˜¯å°†æŒ‡ä»¤çš„ç»„æˆéƒ¨åˆ†é‡æ–°è§£é‡Šæ‰§è¡Œï¼Œè¿™ç§èŠ±æŒ‡ä»¤å¯ä»¥ç ´ååç¼–è¯‘çš„åˆ†æ,ä½¿å¾—æ ˆæŒ‡é’ˆåœ¨åç¼–è¯‘å¼•æ“ä¸­å‡ºç°å¼‚å¸¸</p><h3 id="ä¸å¯æ‰§è¡ŒèŠ±æŒ‡ä»¤">ä¸å¯æ‰§è¡ŒèŠ±æŒ‡ä»¤</h3><p>è¿™ç§èŠ±æŒ‡ä»¤æœ¬è´¨ä¸Šæ˜¯åœ¨è·³è½¬æŒ‡ä»¤ä¹‹åæ’å…¥ä¸€ä¸ªå¤šå­—èŠ‚æŒ‡ä»¤çš„å­—èŠ‚ï¼Œæ¬ºéª—åæ±‡ç¼–å™¨å°†è¿™ä¸ªå­—èŠ‚ä¹‹åçš„å‡ ä¸ªå­—èŠ‚å½“æˆä¸€ä¸ªå¤šå­—èŠ‚æŒ‡ä»¤è§£é‡Šï¼Œè¿›è€Œé€ æˆåç»­æŒ‡ä»¤åæ±‡ç¼–å‡ºé”™ï¼Œè€Œè¿™éƒ¨åˆ†èŠ±æŒ‡ä»¤ä»£ç åœ¨ç¨‹åºçš„æ­£å¸¸æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¢«æ‰§è¡Œ</p><h2 id="æ„é€ ä¸patch">æ„é€ ä¸patch</h2><h3 id="åæ±‡ç¼–ç®—æ³•">åæ±‡ç¼–ç®—æ³•</h3><p>å¸¸è§çš„åæ±‡ç¼–ç®—æ³•æœ‰ä¸¤ç±»ï¼Œä¸€ç±»æ˜¯çº¿æ€§æ‰«æåæ±‡ç¼–ï¼Œå¯¹è¾“å…¥çš„æ•°æ®é€å­—èŠ‚ç¿»è¯‘æˆæ±‡ç¼–ä»£ç ï¼Œå› æ­¤ç®€å•åœ°åœ¨<code>jmp</code>åæ’å…¥<code>0xe8</code>ï¼ˆ<code>0xe8</code>æ˜¯<code>call</code>æŒ‡ä»¤çš„æœºå™¨ç ï¼‰å°±èƒ½éª—åˆ°</p><p>å¦ä¸€ç±»æ˜¯é€’å½’ä¸‹é™åæ±‡ç¼–ï¼Œæ˜¯ä¸€ç§åŸºäºæ§åˆ¶æµåˆ†æçš„ç®—æ³•ï¼Œè¿™ç±»ç®—æ³•ä¼˜å…ˆåæ±‡ç¼–å¯è¾¾çš„ä»£ç ï¼Œä¾‹å¦‚IDAã€‚é’ˆå¯¹è¿™ç±»ç®—æ³•ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®æ°¸çœŸæˆ–è€…æ°¸å‡æ¡ä»¶ï¼Œå¯¼è‡´ç¨‹åºä¸€å®šä¼šæ‰§è¡Œï¼Œå› ä¸ºidaåæ±‡ç¼–ä¼šä¼˜å…ˆåæ±‡ç¼–æ¥ä¸‹å»çš„éƒ¨åˆ†ï¼ˆfalseåˆ†æ”¯ï¼‰</p><p>å…¶å®ƒæ›´åŠ è¯¦å°½çš„èŠ±æŒ‡ä»¤æ„é€ æ–¹æ³•ï¼Œè¿™é‡Œå¼•è·¯<ahref="https://nnnewb.github.io/blog/p/learning-packer-07/">å¤§ä½¬çš„æ–‡ç« </a></p><h3 id="æ„é€ æ¡ˆä¾‹">æ„é€ æ¡ˆä¾‹</h3><p>æˆ‘åœ¨å­¦ä¹ èŠ±æŒ‡ä»¤çŸ¥è¯†æ—¶çœ‹åˆ°çš„ä¸€ä¸ª<ahref="https://www.anquanke.com/post/id/208682#h3-5">å¾ˆå¥½çš„ä¾‹å­</a></p><h3 id="patchçš„æ–¹æ³•-nop">patchçš„æ–¹æ³•-NOP</h3><p><img src="image-20240125203811902.png" /></p><p>ä¸Šå›¾æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¸å¯æ‰§è¡ŒèŠ±æŒ‡ä»¤ï¼ˆ<code>call</code>æŒ‡ä»¤çš„åœ°å€ä¸å­˜åœ¨ï¼‰ï¼Œè€Œä¸”è¿™é‡Œå°±æ˜¯æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ç»å…¸çš„åœ¨<code>jmp</code>åæ’å…¥<code>0xe8</code>æ„é€ èŠ±æŒ‡ä»¤çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å°†ä¸¤æ¡æŒ‡ä»¤åŒ–ä¸ºæœºå™¨ç çœ‹å¾—æ›´æ¸…æ¥šï¼ˆå³é”®Undifineæˆ–å¿«æ·é”®Uï¼‰</p><p><img src="image-20240125204212095.png" /></p><p><code>0x75</code>æ˜¯<code>jnz</code>çš„æœºå™¨ç ï¼Œ<code>0xe8</code>æ˜¯<code>call</code>çš„æœºå™¨ç </p><p>å¯¹ä»˜è¿™ç§èŠ±æŒ‡ä»¤ï¼Œå¯ä»¥å°†<code>jnz</code>è¿™ä¸ªæ— æ•ˆè·³è½¬ç›´æ¥nopæ‰ï¼ˆå³é”®nopï¼‰ï¼Œè‡³äº<code>call</code>æŒ‡ä»¤çš„éƒ¨åˆ†ä¸è¦è¿™æ ·ï¼Œä¸‹é¢è¯¦è¿°</p><h2 id="ä¾‹é¢˜-hdctf2019maze">ä¾‹é¢˜-[HDCTF2019]Maze</h2><p>å…¶å®ä¸Šé¢çš„å›¾æ¥æºäºä¸€é“reé¢˜</p><p>å‰é¢upxè„±å£³çš„è¿‡ç¨‹ç•¥ï¼Œidaæ‰“å¼€</p><p><img src="image-20240125172244493.png" /></p><p>çœ‹åˆ°æ ‡çº¢åœ°æ–¹æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¸å¯æ‰§è¡ŒèŠ±å‘½ä»¤ï¼Œè¿™ä¸ªæ•°æ®æ˜æ˜¾ä¸æ˜¯åœ°å€ï¼Œè€Œä¸”å¾ˆæœ‰å¯èƒ½æ˜¯æŒ‡ä»¤ï¼Œæ‰€ä»¥å…ˆä¸è¦ç›´æ¥nop</p><p>ä¸Šé¢æ˜¯ä¸€ä¸ªæ²¡æœ‰ç”¨çš„è·³è½¬ï¼Œé‚£å°±æŠŠ2Cå¤„çš„<code>jnz</code>ç»™nopæ‰</p><p><img src="image-20240125172724844.png" /></p><p>2Eå¤„è½¬ä¸ºcodeï¼ˆæ–¹æ³•ä¸Šæ–‡æœ‰ï¼‰ï¼Œå‘ç°æœç„¶2Få¤„æ˜¯ä¸€ä¸ªpopï¼Œå¹¶ä¸”ä¸‹é¢ä¸€å †è¢«IDAæœªè¯†åˆ«çš„æ•°æ®ä¹Ÿä¸€èµ·è½¬ä¸ºæŒ‡ä»¤äº†</p><p><img src="image-20240125173334448.png" /></p><p>æ­¤æ—¶æ•°æ®åœ°å€æ˜¯çº¢è‰²çš„ï¼Œé€‰ä¸­<code>_mian</code>å‡½æ•°å¤´ï¼Œå¿«æ·é”®På°†å…¶å£°æ˜ä¸ºå‡½æ•°ï¼ŒF5æŸ¥çœ‹ä¼ªä»£ç å¹¶åˆ†æ</p><p>æ˜¯ä¸ªèµ°è¿·å®«çš„é¢˜å•¦~</p>]]></content>
      
      
      <categories>
          
          <category> reverseç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reverse </tag>
            
            <tag> èŠ±æŒ‡ä»¤ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>BUUCTF-[2019çº¢å¸½æ¯]easyRE</title>
      <link href="/2024/01/23/buuctf-2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-easyRE/"/>
      <url>/2024/01/23/buuctf-2019%E7%BA%A2%E5%B8%BD%E6%9D%AF-easyRE/</url>
      
        <content type="html"><![CDATA[<h1 id="buuctf-2019çº¢å¸½æ¯easyre">buuctf [2019çº¢å¸½æ¯]easyRE</h1><p>æŸ¥å£³</p><p><img src="image-20240123114625741.png" /></p><p>64ä½æ— å£³ï¼Œæ‹–å…¥IDA</p><p><img src="image-20240123114714915.png" /></p><p>å…¨æ˜¯è¿™ç§å‡½æ•°ï¼Œæ— mainå‡½æ•°ï¼Œæœ‰ä¸€ä¸ªstartå‡½æ•°ä½†æ²¡ä»€ä¹ˆç”¨ï¼Œæ‰“å¼€å­—ç¬¦ä¸²å­è§†å›¾çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯</p><p><img src="image-20240123114826506.png" /></p><p>å‰äº”ä¸ªæ¯”è¾ƒé‡è¦ï¼Œè·Ÿè¿›åˆ°å”¯ä¸€ä¸€ä¸ªå¼•ç”¨å‡½æ•°</p><p><img src="image-20240123115135954.png" /></p><p>åˆ†æä¸€ä¸‹ç¬¬ä¸€é˜¶æ®µï¼Œå°±æ˜¯è¾“å…¥ä¸€ä¸ªé•¿åº¦ä¸º36çš„å­—ç¬¦ä¸²ï¼Œè¿™é‡ŒIDAçš„è¯†åˆ«æœ‰ç‚¹é—®é¢˜ï¼Œv12ã€v13å’Œv14åº”è¯¥æ˜¯è¿åœ¨ä¸€èµ·çš„ä¸€ä¸ªæ•°ç»„ï¼Œä¸ç„¶ä¸‹é¢çš„ifåˆ¤æ–­æ¡ä»¶ä¸­v12æ•°ç»„ä¼šè¶Šç•Œ</p><p>å†™ä¸ªè„šæœ¬çœ‹ä¸€ä¸‹v15é‡Œçš„æ˜¯ä»€ä¹ˆå†…å®¹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v12=<span class="string">&quot;Iodl&gt;Qnb(ocy\x7Fy.i\x7Fd`3w&#125;wek9&#123;iy=~yL@EC&quot;</span></span><br><span class="line">v15=<span class="string">&#x27;&#x27;</span></span><br><span class="line">j=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v12:</span><br><span class="line">    v15+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(i)^j)</span><br><span class="line">    j+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(v15)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœæ˜¯ Info:The first four chars are `flag`ï¼Œæ²¡ä»€ä¹ˆç”¨...</p><p>å¾€ä¸‹åˆ†æ</p><p><img src="image-20240123120254716.png" /></p><p>è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œ10æ¬¡å‡½æ•°è¿ç®—åå¾—åˆ°çš„ç»“æœä¸<code>off_6CC090</code>å¤„å­—ç¬¦è¿›è¡Œæ¯”è¾ƒ</p><p>æŸ¥çœ‹<code>sub_400E44</code>å‡½æ•°ä¸<code>off_6CC090</code>å†…å®¹</p><p><img src="image-20240123120621481.png" /></p><p><img src="image-20240123120720992.png" /></p><p>æ­£å¸¸çš„base64è¡¨ï¼Œå…¶å®åˆšæ‰çœ‹å­—ç¬¦ä¸²è§†å›¾å°±å·²ç»çœ‹åˆ°äº†</p><p><img src="image-20240123120819735.png" /></p><p>è¿™é‡Œå°±æ˜¯åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œè§£å¯†åæ¬¡å¾—åˆ°</p><p><code>https://bbs.kanxue.com/thread-254172-3.htm</code></p><p>åˆè¢«éª—äº†...</p><p><img src="image-20240123121157163.png" /></p><p>å…¶å®çœŸæ­£çš„æœ‰æ•ˆä¿¡æ¯åœ¨<code>off_6CC090</code>ä¸‹æ–¹ï¼Œè·Ÿè¿›å¼•ç”¨å‡½æ•°</p><p><img src="image-20240123121356850.png" /></p><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°flagåˆå…·é›å½¢ï¼Œä¸ç”¨ç®¡ä¸Šé¢çš„1234æ¬¡å¾ªç¯ï¼Œç›´æ¥æ ¹æ®<code>byte_6CC0A0</code>å¤„çš„å†…å®¹å¯ä»¥å¾—åˆ°v1å’Œv4ï¼Œè¿™é‡Œ<code>unsigned_int8</code>å’Œ<code>HIBYTE</code>æ˜¯æŠŠä½å…«ä½å’Œé«˜å…«ä½å–å‡ºæ¥ï¼Œåˆ†åˆ«æ˜¯få’Œgï¼Œå¯ä»¥åˆç†çŒœæµ‹æ•´ä¸ªå°±æ˜¯flag</p><p>è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">0x40</span>, <span class="number">0x35</span>, <span class="number">0x20</span>, <span class="number">0x56</span>, <span class="number">0x5D</span>, <span class="number">0x18</span>, <span class="number">0x22</span>, <span class="number">0x45</span>, <span class="number">0x17</span>, <span class="number">0x2F</span>, <span class="number">0x24</span>, <span class="number">0x6E</span>, <span class="number">0x62</span>, <span class="number">0x3C</span>, <span class="number">0x27</span>, <span class="number">0x54</span>, <span class="number">0x48</span>, <span class="number">0x6C</span>, <span class="number">0x24</span>, <span class="number">0x6E</span>, <span class="number">0x72</span>, <span class="number">0x3C</span>, <span class="number">0x32</span>, <span class="number">0x45</span>, <span class="number">0x5B</span>]</span><br><span class="line">b=[<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;g&#x27;</span>]</span><br><span class="line">c=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    b[i]=<span class="built_in">chr</span>(<span class="built_in">ord</span>(b[i])^a[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    c+=<span class="built_in">chr</span>(a[i]^<span class="built_in">ord</span>(b[i%<span class="number">4</span>]))</span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="image-20240123123340185.png" /></p><p>è™½ç„¶è¿™é¢˜å½“æ—¶å¥½åƒåªæ˜¯ä¸€é“ç­¾åˆ°ï¼Œä½†å¾ˆæçš„æ˜¯è¢«éª—äº†ä¸¤æ¬¡...</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reverse </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Z3-Solver</title>
      <link href="/2024/01/21/Z3-Solver%E5%AD%A6%E4%B9%A0/"/>
      <url>/2024/01/21/Z3-Solver%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="z3-solver">Z3-Solver</h1><h2 id="ç®€ä»‹">ç®€ä»‹</h2><p>Z3Solveræ˜¯ä¸€ä¸ªå¾®è½¯å‡ºå“çš„å¼€æºçº¦æŸæ±‚è§£å™¨ï¼Œèƒ½å¤Ÿè§£å†³å¾ˆå¤šç§æƒ…å†µä¸‹çš„ç»™å®šéƒ¨åˆ†çº¦æŸæ¡ä»¶å¯»æ±‚ä¸€ç»„æ»¡è¶³æ¡ä»¶çš„è§£çš„é—®é¢˜</p><p>Z3Solveræ”¯æŒå¤šç§ä¸åŒçš„é—®é¢˜é¢†åŸŸï¼ŒåŒ…æ‹¬å¸ƒå°”é€»è¾‘ã€æ•´æ•°å’Œå®æ•°çš„çº¿æ€§å’Œéçº¿æ€§ç®—æœ¯ã€ä½å‘é‡ã€æ•°ç»„ã€é›†åˆã€å‡½æ•°ç­‰ï¼Œä¸»è¦åº”ç”¨é¢†åŸŸåŒ…æ‹¬è½¯ä»¶éªŒè¯ã€å½¢å¼åŒ–éªŒè¯ã€ç¨‹åºåˆ†æã€äººå·¥æ™ºèƒ½å’Œè‡ªåŠ¨å®šç†è¯æ˜ç­‰</p><h2 id="è¯­æ³•">è¯­æ³•</h2><p>z3ä¸­æœ‰3ç§ç±»å‹çš„å˜é‡ï¼Œåˆ†åˆ«æ˜¯<strong>æ•´å‹(Int)</strong>ï¼Œ<strong>å®å‹(Real)</strong>å’Œ<strong>å‘é‡(BitVec)</strong></p><p>å¯¹äºæ•´æ•°ç±»å‹æ•°æ®ï¼ŒåŸºæœ¬APIï¼š</p><ol type="1"><li>Int(name, ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªæ•´æ•°å˜é‡ï¼Œnameæ˜¯åå­—</li><li>Ints (names, ctx=None)ï¼Œåˆ›å»ºå¤šä¸ªæ•´æ•°å˜é‡ï¼Œnamesæ˜¯ç©ºæ ¼åˆ†éš”åå­—</li><li>IntVal (val, ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªæ•´æ•°å¸¸é‡ï¼Œæœ‰åˆå§‹å€¼ï¼Œæ²¡åå­—</li></ol><p>å¯¹äºå®æ•°ç±»å‹çš„APIä¸æ•´æ•°ç±»å‹ä¸€è‡´ï¼Œå‘é‡(BitVec)åˆ™ç¨æœ‰åŒºåˆ«ï¼š</p><ol type="1"><li>Bitvec(name,bv,ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªä½å‘é‡ï¼Œnameæ˜¯ä»–çš„åå­—ï¼Œbvè¡¨ç¤ºå¤§å°</li><li>BitVecs(name,bv,ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªæœ‰å¤šå˜é‡çš„ä½å‘é‡ï¼Œnameæ˜¯åå­—ï¼Œbvè¡¨ç¤ºå¤§å°</li><li>BitVecVal(val,bv,ctx=None)ï¼Œåˆ›å»ºä¸€ä¸ªä½å‘é‡ï¼Œæœ‰åˆå§‹å€¼ï¼Œæ²¡åå­—</li></ol><p>simplify(è¡¨è¾¾å¼)ï¼Œå¯¹å¯ä»¥ç®€åŒ–çš„è¡¨è¾¾å¼è¿›è¡Œç®€åŒ–</p><h2 id="åº”ç”¨">åº”ç”¨</h2><h3 id="ç›´æ¥è°ƒç”¨solve-å‡½æ•°">ç›´æ¥è°ƒç”¨<code>solve()</code> å‡½æ•°</h3><p><code>solve()</code> å‡½æ•°ä¼šåˆ›é€ ä¸€ä¸ªsolverï¼Œç„¶åå¯¹æ‹¬å·ä¸­çš„çº¦æŸæ¡ä»¶è¿›è¡Œæ±‚è§£ï¼Œ<strong>éœ€è¦æ³¨æ„é»˜è®¤æƒ…å†µä¸‹åªä¼šæ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ä¸€ç»„è§£</strong>ï¼Œå› æ­¤æä¾›çº¦æŸæ¡ä»¶æ—¶å°½å¯èƒ½è¯¦å°½ï¼Œä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">x = Int(<span class="string">&#x27;x&#x27;</span>)                                         <span class="comment">#å£°æ˜å˜é‡</span></span><br><span class="line">y = Int(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">solve(x &gt; <span class="number">2</span>, y &lt; <span class="number">10</span>, x + <span class="number">2</span>*y == <span class="number">7</span>)                   <span class="comment">#æ·»åŠ çº¦æŸæ¡ä»¶</span></span><br><span class="line">&gt;&gt;&gt;[y = <span class="number">0</span>, x = <span class="number">7</span>]</span><br></pre></td></tr></table></figure><p><code>solve()</code>å‡½æ•°ä¼šè‡ªåŠ¨æ‰“å°è§£ï¼Œä¸éœ€è¦å†å¥—ä¸€å±‚<code>print()</code></p><h3 id="åˆ›å»ºsolveræ±‚è§£å™¨">åˆ›å»ºSolveræ±‚è§£å™¨</h3><p>åŸºæœ¬æŒ‰ç…§ <strong>åˆ›å»ºçº¦æŸæ±‚è§£å™¨ã€å£°æ˜å˜é‡ -&gt; æ·»åŠ çº¦æŸæ¡ä»¶ -&gt;éªŒè¯æ˜¯å¦æœ‰è§£ -&gt; æ±‚è§£</strong> çš„æ­¥éª¤è¿›è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()                <span class="comment">#åˆ›å»ºçº¦æŸæ±‚è§£å™¨</span></span><br><span class="line">x = Int(<span class="string">&#x27;x&#x27;</span>)                <span class="comment">#å£°æ˜å˜é‡</span></span><br><span class="line">y = Int(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">s.add(x &gt; <span class="number">2</span>)                <span class="comment">#æ·»åŠ çº¦æŸæ¡ä»¶</span></span><br><span class="line">s.add(y &lt; <span class="number">10</span>)</span><br><span class="line">s.add(x + <span class="number">2</span>*y == <span class="number">7</span>)</span><br><span class="line"><span class="keyword">if</span> s.check() == sat:        <span class="comment">#éªŒè¯æ˜¯å¦æœ‰è§£</span></span><br><span class="line"><span class="built_in">print</span>(s.model())        <span class="comment">#æ±‚è§£å¹¶æ‰“å°</span></span><br><span class="line">&gt;&gt;&gt;[y = <span class="number">0</span>, x = <span class="number">7</span>]</span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜">ä¾‹é¢˜</h2><h3 id="è§£æ•°ç‹¬">è§£æ•°ç‹¬</h3><p>æ–‡ç« é“¾æ¥ï¼š<ahref="https://blog.csdn.net/P01yH3dr0n/article/details/106784526">PythonZ3çº¦æŸæ±‚è§£å™¨è§£å†³æ•°ç‹¬é—®é¢˜</a></p><h3 id="guet-ctf2019re">[GUET-CTF2019]re</h3><p>å‰é¢è„±å£³é€†å‘çš„è¿‡ç¨‹ç•¥ï¼Œæ‰¾åˆ°å…³é”®å‡½æ•°</p><p><img src="image-20240121132512763.png" /></p><p>å‡ºç°è¿™ä¹ˆå¤šçº¿æ€§åˆ¤æ–­è¯­å¥ï¼Œè€ƒè™‘ç”¨z3æ±‚è§£ï¼Œè„šæœ¬å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">s = Solver()</span><br><span class="line">a1 = [Int(<span class="string">&quot;[a1[%d]&quot;</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">s.add( <span class="number">1629056</span> * a1[<span class="number">0</span>] == <span class="number">166163712</span> )</span><br><span class="line">s.add( <span class="number">6771600</span> * a1[<span class="number">1</span>] == <span class="number">731332800</span> )</span><br><span class="line">s.add( <span class="number">3682944</span> * a1[<span class="number">2</span>] == <span class="number">357245568</span> )</span><br><span class="line">s.add( <span class="number">10431000</span> * a1[<span class="number">3</span>] == <span class="number">1074393000</span> )</span><br><span class="line">s.add( <span class="number">3977328</span> * a1[<span class="number">4</span>] == <span class="number">489211344</span> )</span><br><span class="line">s.add( <span class="number">5138336</span> * a1[<span class="number">5</span>] == <span class="number">518971936</span> )</span><br><span class="line">s.add( a1[<span class="number">6</span>] == <span class="number">49</span> )</span><br><span class="line">s.add( <span class="number">7532250</span> * a1[<span class="number">7</span>] == <span class="number">406741500</span> )</span><br><span class="line">s.add( <span class="number">5551632</span> * a1[<span class="number">8</span>] == <span class="number">294236496</span> )</span><br><span class="line">s.add( <span class="number">3409728</span> * a1[<span class="number">9</span>] == <span class="number">177305856</span> )</span><br><span class="line">s.add( <span class="number">13013670</span> * a1[<span class="number">10</span>] == <span class="number">650683500</span> )</span><br><span class="line">s.add( <span class="number">6088797</span> * a1[<span class="number">11</span>] == <span class="number">298351053</span> )</span><br><span class="line">s.add( <span class="number">7884663</span> * a1[<span class="number">12</span>] == <span class="number">386348487</span> )</span><br><span class="line">s.add( <span class="number">8944053</span> * a1[<span class="number">13</span>] == <span class="number">438258597</span> )</span><br><span class="line">s.add( <span class="number">5198490</span> * a1[<span class="number">14</span>] == <span class="number">249527520</span> )</span><br><span class="line">s.add( <span class="number">4544518</span> * a1[<span class="number">15</span>] == <span class="number">445362764</span> )</span><br><span class="line">s.add( <span class="number">3645600</span> * a1[<span class="number">17</span>] == <span class="number">174988800</span> )</span><br><span class="line">s.add( <span class="number">10115280</span> * a1[<span class="number">16</span>] == <span class="number">981182160</span> )</span><br><span class="line">s.add( <span class="number">9667504</span> * a1[<span class="number">18</span>] == <span class="number">493042704</span> )</span><br><span class="line">s.add( <span class="number">5364450</span> * a1[<span class="number">19</span>] == <span class="number">257493600</span> )</span><br><span class="line">s.add( <span class="number">13464540</span> * a1[<span class="number">20</span>] == <span class="number">767478780</span> )</span><br><span class="line">s.add( <span class="number">5488432</span> * a1[<span class="number">21</span>] == <span class="number">312840624</span> )</span><br><span class="line">s.add( <span class="number">14479500</span> * a1[<span class="number">22</span>] == <span class="number">1404511500</span> )</span><br><span class="line">s.add( <span class="number">6451830</span> * a1[<span class="number">23</span>] == <span class="number">316139670</span> )</span><br><span class="line">s.add( <span class="number">6252576</span> * a1[<span class="number">24</span>] == <span class="number">619005024</span> )</span><br><span class="line">s.add( <span class="number">7763364</span> * a1[<span class="number">25</span>] == <span class="number">372641472</span> )</span><br><span class="line">s.add( <span class="number">7327320</span> * a1[<span class="number">26</span>] == <span class="number">373693320</span> )</span><br><span class="line">s.add( <span class="number">8741520</span> * a1[<span class="number">27</span>] == <span class="number">498266640</span> )</span><br><span class="line">s.add( <span class="number">8871876</span> * a1[<span class="number">28</span>] == <span class="number">452465676</span> )</span><br><span class="line">s.add( <span class="number">4086720</span> * a1[<span class="number">29</span>] == <span class="number">208422720</span> )</span><br><span class="line">s.add( <span class="number">9374400</span> * a1[<span class="number">30</span>] == <span class="number">515592000</span> )</span><br><span class="line">s.add( <span class="number">5759124</span> * a1[<span class="number">31</span>] == <span class="number">719890500</span> )</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    m = s.model()</span><br><span class="line">    <span class="comment">#ç›´æ¥print(m)è¾“å‡ºçš„æ˜¯è§£ï¼Œç”¨evalå’Œas_longå¤„ç†ä¸€ä¸‹</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(m.<span class="built_in">eval</span>(a1[i]).as_long()),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¿™é¢˜æœ‰ä¸¤ä¸ªå‘ï¼Œä¸€ä¸ªæ˜¯a1[6]ä¸åœ¨è¿™ä¸ªåˆ¤æ–­æ¡ä»¶ä¸­ï¼Œä¸€ä¸ªæ˜¯a1[16]å’Œa1[17]ä½ç½®è°ƒæ¢äº†</p><h3 id="å…³äºè°ƒæ•´è§£çš„æ ¼å¼çš„è¡¥å……">*å…³äºè°ƒæ•´è§£çš„æ ¼å¼çš„è¡¥å……</h3><p>a1[6]è¦æ·»åŠ åœ¨çº¦æŸæ¡ä»¶ä¸­ï¼Œä¸ç„¶æœ€åè¾“å‡ºä¼šæŠ¥é”™ï¼Œæœ‰å¤§ä½¬æŒ‡å‡ºç”¨burpçˆ†ç ´å¯ä»¥å¾—åˆ°æœ¬é¢˜çš„a1[6]</p><p>è€Œä¸”ä¸èƒ½å†™æˆ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot; &quot;</span>.join([m.<span class="built_in">eval</span>(a1[i]).as_long() <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]))</span><br></pre></td></tr></table></figure><p>(æˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><p>æœ‰æ—¶å€™åœ¨ä½¿ç”¨.as_long() / .as_fraction()æ—¶ä¼šæŠ¥é”™</p><p><code>AttributeError: 'NoneType' object has no attribute 'as_long'</code></p><p>è§£å†³æ–¹æ³•è¯¦è§é“¾æ¥ï¼š<ahref="https://blog.csdn.net/weixin_39251985/article/details/113865326">Z3æ±‚è§£å™¨ç»“æœè¾“å‡ºï¼ˆpython</a></p>]]></content>
      
      
      <categories>
          
          <category> reverseç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reverse </tag>
            
            <tag> Z3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shell</title>
      <link href="/2024/01/07/Shell%E5%AD%A6%E4%B9%A0/"/>
      <url>/2024/01/07/Shell%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="shell">Shell</h1><h2 id="æ¦‚å¿µ">æ¦‚å¿µ</h2><h4 id="shell-1">Shell</h4><p>è§£é‡Šæ‰§è¡Œç”¨æˆ·è¾“å…¥çš„å‘½ä»¤æˆ–ç¨‹åºç­‰ï¼Œäº¤äº’å¼</p><p>Shellæ˜¯ä¸€å—åŒ…è£¹ç€ç³»ç»Ÿæ ¸å¿ƒçš„å£³ï¼Œå¤„äºæ“ä½œç³»ç»Ÿçš„æœ€å¤–å±‚ï¼Œä¸ç”¨æˆ·ç›´æ¥å¯¹è¯ï¼ŒæŠŠç”¨æˆ·çš„è¾“å…¥è§£é‡Šç»™æ“ä½œç³»ç»Ÿï¼Œç„¶åå¤„ç†æ“ä½œç³»ç»Ÿçš„è¾“å‡ºç»“æœï¼Œè¾“å‡ºåˆ°å±å¹•ç»™ä¸ç”¨æˆ·çœ‹åˆ°ç»“æœ</p><h4 id="shellè„šæœ¬">Shellè„šæœ¬</h4><p>å‘½ä»¤æˆ–ç¨‹åºå†™åœ¨æ–‡ä»¶ä¸­ï¼Œæ‰§è¡Œæ–‡ä»¶è¯»å–ä»£ç ï¼Œè¿™æ ·çš„ç¨‹åºæ–‡ä»¶ç§°ä¸ºShellè„šæœ¬ï¼Œéäº¤äº’å¼</p><p>Windowsä¸­å­˜åœ¨<code>*.bat</code>æ‰¹å¤„ç†è„šæœ¬ï¼ŒLinuxä¸­å¸¸ç”¨<code>*.sh</code>è„šæœ¬æ–‡ä»¶</p><h2 id="shebang">Shebang</h2><p>æŒ‡çš„æ˜¯æ–‡ä»¶å¼€å¤´çš„ä¸¤ä¸ªå­—ç¬¦<code>#!</code> ï¼Œåè·Ÿè§£é‡Šå™¨åç§°</p><p>â‘ ä»¥<code>#!/bin/sh</code>å¼€å¤´çš„æ–‡ä»¶è°ƒç”¨çš„æ˜¯bashè§£é‡Šå™¨</p><p>â‘¡ä»¥<code>#!/usr/bin/python</code>å¼€å¤´çš„æ–‡ä»¶è°ƒç”¨çš„æ˜¯pythonè§£é‡Šå™¨</p><p>â‘¢ä»¥<code>#!/usr/bin/env è§£é‡Šå™¨å</code>å¼€å¤´çš„æ–‡ä»¶è°ƒç”¨çš„æ˜¯æŒ‡å®šè§£é‡Šå™¨</p><p>â‘£è‹¥æ–‡ä»¶æœªæŒ‡æ˜Shebangï¼Œè„šæœ¬æ‰§è¡Œçš„æ—¶å€™é»˜è®¤æ˜¯å½“å‰Shellä½œä¸ºè§£é‡Šå™¨ï¼Œå¯ä»¥é€šè¿‡<code>echo $SHELL</code>æŒ‡ä»¤æŸ¥çœ‹</p><h3 id="æ‰§è¡Œshellè„šæœ¬çš„æ–¹å¼">æ‰§è¡ŒShellè„šæœ¬çš„æ–¹å¼</h3><p>â‘ æ–‡ä»¶æ— xæƒé™æˆ–è„šæœ¬æœªæŒ‡å®šShebangæ—¶ï¼Œä½¿ç”¨<code>è§£é‡Šå™¨å script.sh</code>ï¼Œææƒ<code>chmod +x script.sh</code></p><p>â‘¡æ–‡ä»¶æœ‰xæƒé™å¯ä»¥ä½¿ç”¨<code>ç»å¯¹/ç›¸å¯¹è·¯å¾„</code></p><p>â‘¢<code>source script.sh</code>æˆ–<code>. script.sh</code></p><p>â‘£åˆ©ç”¨é‡å®šå‘å†™å…¥ç¬¦å·<code>è§£é‡Šå™¨å &lt; script.sh</code>ï¼Œè¿™ä¸ªå‘½ä»¤ä¼šè¿è¡Œscript.shè„šæœ¬ï¼Œå¹¶å°†å…¶å†…å®¹ä½œä¸ºè¾“å…¥ä¼ é€’ç»™Shellè§£é‡Šå™¨</p><p><img src="image-20240106134537311.png" /></p><h2 id="bashç‰¹æ€§">Bashç‰¹æ€§</h2><p>â‘ æ–‡ä»¶è·¯å¾„tabé”®è¡¥å…¨</p><p>â‘¡å‘½ä»¤è¡¥å…¨</p><p>â‘¢å¿«æ·é”® ctrl + aï¼Œeï¼Œuï¼Œkï¼Œl</p><p>â‘£é€šé…ç¬¦</p><p>â‘¤history</p><p><code>echo $HISTFILE</code>æŸ¥çœ‹å†å²å‘½ä»¤</p><p><code>! å†å²id</code>å¿«é€Ÿæ‰§è¡Œå†å²å‘½ä»¤</p><p><code>!!</code>è°ƒç”¨ä¸Šä¸€æ¡å‘½ä»¤</p><h2 id="shellè¯­è¨€">Shellè¯­è¨€</h2><h3 id="å˜é‡">å˜é‡</h3><h4 id="å®šä¹‰">å®šä¹‰</h4><p>Shellè„šæœ¬è¯­è¨€æ˜¯ä¸€ç§å¼±ç±»å‹è¯­è¨€ï¼Œæ— éœ€å£°æ˜å˜é‡ç±»å‹ï¼Œé»˜è®¤å­—ç¬¦ä¸²ï¼›æ ‡è¯†ç¬¦è§„åˆ™ä¸Cç±»ä¼¼</p><h4 id="èµ‹å€¼">èµ‹å€¼</h4><p>Shellå˜é‡èµ‹å€¼ä¸å¾—æœ‰ç©ºæ ¼ï¼Œä¼šè¢«è¯†åˆ«ä¸ºå‘½ä»¤+å‚æ•°ç­‰ï¼›å•å¼•å·å¼ºå¼•ç”¨ï¼Œä¸è¯†åˆ«ç‰¹æ®Šç¬¦å·ï¼ŒåŒå¼•å·è¯†åˆ«ï¼Œåå¼•å·æ‹¬èµ·æ¥çš„è¿”å›çš„æ˜¯å‘½ä»¤æ‰§è¡Œç»“æœï¼Œç›¸å½“äº<code>$()</code></p><h4 id="æŸ¥å€¼">æŸ¥å€¼</h4><p><code>echo $å˜é‡å</code>æˆ–<code>echo $&#123;å˜é‡å&#125;</code></p><h4 id="ä½œç”¨åŸŸ">ä½œç”¨åŸŸ</h4><p>æ™®é€šå˜é‡ä½œç”¨åŸŸæ˜¯å½“å‰Shellï¼ˆ<code>pstree</code>æŸ¥çœ‹è¿›ç¨‹æ ‘ï¼‰ï¼Œåˆ‡æ¢Shellå˜é‡ä¼šä¸¢å¤±</p><p>æ¯æ¬¡è°ƒç”¨è§£é‡Šå™¨æ‰§è¡Œè„šæœ¬éƒ½ä¼šå¼€å¯ä¸€ä¸ªå­Shellï¼Œå®Œæ¯•åå›åˆ°çˆ¶Shellä¸­ï¼Œå› æ­¤è„šæœ¬ä¸­å˜é‡çš„å®šä¹‰èµ‹å€¼ä¸ä¼šè¢«ä¿ç•™ï¼›è‹¥é‡‡ç”¨<code>source</code>æˆ–<code>.</code>çš„æ–¹å¼æ‰§è¡Œè„šæœ¬ä¼šåœ¨å½“å‰Shellæ‰§è¡Œ</p><h4 id="ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡</h4><h5 id="é…ç½®æ–‡ä»¶">é…ç½®æ–‡ä»¶</h5><p>ç”¨æˆ·ä¸ªäººï¼š<code>~/.bash_profile</code>ã€<code>~/.bashrc</code>ï¼Œæ˜¯è¿œç¨‹ç™»é™†ç”¨æˆ·ç‰¹æœ‰æ–‡ä»¶</p><p>å…¨å±€é…ç½®æ–‡ä»¶ï¼š<code>/etc/profile</code>ã€<code>/etc/bashrc</code></p><p>ä»¥ä¸ªäººé…ç½®æ–‡ä»¶ä¼˜å…ˆåŠ è½½å˜é‡</p><h5 id="æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒå˜é‡çš„å‘½ä»¤">æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒå˜é‡çš„å‘½ä»¤</h5><p><code>set</code>è¾“å‡ºå½“å‰Shellæ‰€æœ‰å˜é‡ï¼ŒåŒ…æ‹¬å…¨å±€å˜é‡ä¸å±€éƒ¨å˜é‡ï¼ˆshè„šæœ¬ä¸­å®šä¹‰çš„å˜é‡ï¼‰ï¼Œ<code>declare</code>ç›¸åŒ</p><p><code>env</code>æ˜¾ç¤ºå…¨å±€å˜é‡ï¼Œ<code>export</code>æ˜¾ç¤ºç¯å¢ƒå˜é‡</p><h5 id="æ’¤é”€ç¯å¢ƒå˜é‡">æ’¤é”€ç¯å¢ƒå˜é‡</h5><p><code>unset</code>åˆ é™¤å˜é‡æˆ–å‡½æ•°</p><h5 id="è®¾ç½®åªè¯»å˜é‡">è®¾ç½®åªè¯»å˜é‡</h5><p><code>readonly</code>å½“å‰Shellç»“æŸåªè¯»å˜é‡å¤±æ•ˆ</p><h5 id="ç¯å¢ƒå˜é‡æ–‡ä»¶åŠ è½½é¡ºåº">ç¯å¢ƒå˜é‡æ–‡ä»¶åŠ è½½é¡ºåº</h5><p><code>/etc/profile</code> -&gt;<code>/etc/profile.d</code>ç›®å½•ä¸‹çš„è„šæœ¬ -&gt;<code>~/.bash_profile</code> -&gt; <code>~/.bashrc</code> -&gt;<code>/etc/bashrc</code></p><h4 id="ç‰¹æ®Šå˜é‡">ç‰¹æ®Šå˜é‡</h4><p><img src="image-20240106004329246.png" /></p><h5 id="è¡¥å……">è¡¥å……</h5><p>$$ å½“å‰Shellè„šæœ¬çš„è¿›ç¨‹å·</p><p>$_ å–å¾—ä¸Šæ¬¡æ‰§è¡Œå‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°</p><h3 id="åŸºç¡€å†…ç½®å‘½ä»¤bash">åŸºç¡€å†…ç½®å‘½ä»¤ï¼ˆBashï¼‰</h3><h4 id="echo">echo</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-n ä¸æ¢è¡Œè¾“å‡º</span><br><span class="line">-e è§£æå­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šç¬¦å·</span><br><span class="line">printf æ‰“å°å‘½ä»¤</span><br></pre></td></tr></table></figure><h4 id="eval">eval</h4><p>æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œåˆ†å·éš”å¼€</p><h4 id="exec">exec</h4><p>ä¸åˆ›å»ºå­è¿›ç¨‹æ‰§è¡Œåç»­å‘½ä»¤ï¼Œæ‰§è¡Œå®Œæ¯•åexit</p><h3 id="çˆ¶å­shell">çˆ¶å­Shell</h3><p>çˆ¶Shellçš„PIDæ˜¯å­Shellçš„PPID</p><p><code>ps</code>è¿›ç¨‹ç®¡ç†å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ps -ef</span><br><span class="line">-f æ˜¾ç¤ºUIDï¼ŒPIDï¼ŒPPID</span><br><span class="line">-e åˆ—å‡ºæ‰€æœ‰è¿›ç¨‹ä¿¡æ¯ï¼Œä¸ -a ç›¸åŒ</span><br><span class="line">--forest ä»¥æ ‘å½¢ç»“æ„å±•ç¤ºè¿›ç¨‹ä¹‹é—´çš„çˆ¶å­å…³ç³»</span><br></pre></td></tr></table></figure><p>æ¯æ¬¡è°ƒç”¨è§£é‡Šå™¨éƒ½ä¼šå¼€å¯ä¸€ä¸ªå­Shellï¼Œexitå¯ä»¥é€€å‡ºå›åˆ°çˆ¶Shellä¸­</p><h4 id="è¿›ç¨‹åˆ—è¡¨">è¿›ç¨‹åˆ—è¡¨</h4><p>ç”¨<code>()</code>æ‹¬èµ·æ¥çš„å‘½ä»¤ä¼šä½œä¸ºä¸€ä¸ªè¿›ç¨‹åˆ—è¡¨ï¼Œåˆ›å»ºå­Shellï¼Œ<code>()</code>å¯ä»¥åµŒå¥—</p><p>ç”¨å­Shellè¿›è¡Œå¤šè¿›ç¨‹å¤„ç†ï¼Œå¯ä»¥æé«˜å¹¶å‘æ‰§è¡Œæ•ˆç‡</p><h4 id="å†…ç½®å¤–ç½®å‘½ä»¤">å†…ç½®/å¤–ç½®å‘½ä»¤</h4><p>å¤–ç½®å‘½ä»¤è¿è¡Œæ›´æ…¢ï¼Œå¹¶ä¸”ä¼šå¼€å¯å­è¿›ç¨‹æ‰§è¡Œï¼›<code>type</code>å‘½ä»¤åˆ¤æ–­å‘½ä»¤ä¸ºå†…ç½®/å¤–ç½®ï¼Œ<code>compgen -b</code>åˆ—å‡ºå†…ç½®å‘½ä»¤</p>]]></content>
      
      
      <categories>
          
          <category> å…¶å®ƒç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç½‘ç»œç¬”è®°ï¼ˆå…­ï¼‰</title>
      <link href="/2023/12/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/"/>
      <url>/2023/12/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E5%85%AD%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="dhcp">6.1 DHCP</h2><p>è‡ªåŠ¨åˆ†é…çš„å†…å®¹åŒ…æ‹¬ï¼šIPåœ°å€ã€å­ç½‘æ©ç ã€é»˜è®¤ï¼ˆç¼ºçœï¼‰ç½‘å…³ã€DNSæœåŠ¡å™¨</p><p>æœåŠ¡å™¨ä¸èƒ½ç”¨DHCP</p><p>DHCPæœåŠ¡å™¨çš„ä¸¤å¤§å·¥ä½œï¼šç§Ÿçº¦è¯·æ±‚ï¼ˆUDPï¼‰ã€ç§Ÿçº¦ç»­è®¢</p><h3 id="å·¥ä½œæµç¨‹">å·¥ä½œæµç¨‹</h3><p>ç§Ÿç”¨è¯·æ±‚ï¼šæºIPæ˜¯0.0.0.0ï¼Œç›®çš„IPæ˜¯255.255.255.255ï¼Œä»¥MACåœ°å€ä¸ºä¸»æœºæ ‡è¯†</p><p>ç§Ÿç”¨æä¾›ï¼šç›®çš„IPæ˜¯255.255.255.255</p><p>ç§Ÿç”¨é€‰æ‹©ï¼šä¸è¯·æ±‚æ—¶ç›¸åŒ</p><p>ç§Ÿç”¨ç¡®è®¤ï¼šä¸æä¾›æ—¶ç›¸åŒ</p><h3 id="ç§Ÿç”¨ç»­çº¦">ç§Ÿç”¨ç»­çº¦</h3><p><img src="image-20231222000709029.png" /></p><p>APIPA</p><p><img src="image-20231222000811798.png" /></p><p>æµç¨‹</p><p>ç§Ÿç”¨è¯·æ±‚ï¼šæºIPæ˜¯ä¸Šæ¬¡ç»™çš„IPï¼Œç›®çš„IPæ˜¯DHCPæœåŠ¡å™¨çš„IPï¼Œä»¥MACåœ°å€ä¸ºä¸»æœºæ ‡è¯†</p><p>ç§Ÿç”¨æä¾›ï¼šç›®çš„IPæ˜¯ä¸Šæ¬¡ç»™çš„IP</p><p>ç§Ÿç”¨é€‰æ‹©ï¼šä¸è¯·æ±‚æ—¶ç›¸åŒ</p><p>ç§Ÿç”¨ç¡®è®¤ï¼šä¸æä¾›æ—¶ç›¸åŒ</p><p><strong>è·¯ç”±å™¨éš”ç¦»å¹¿æ’­åŸŸï¼Œäº¤æ¢æœºéš”ç¦»å†²çªåŸŸä½†ä¸éš”ç¦»å¹¿æ’­åŸŸ</strong></p><p><img src="image-20231222001115306.png" /></p><h2 id="dns">6.2 DNS</h2><p>DNSä½¿ç”¨TCPå’ŒUDPï¼ˆä¸»è¦ï¼‰çš„53ç«¯å£</p><p>æ¯ä¸€çº§åŸŸåé•¿åº¦é™åˆ¶63å­—ç¬¦ï¼Œæ€»é•¿åº¦253å­—ç¬¦ï¼Œæœ€åå…¶å®æœ‰ä¸€ä¸ªç‚¹ï¼ˆ.ï¼‰</p><p><img src="image-20231222001348558.png" /></p><p>æŸ¥è¯¢è¿‡ç¨‹</p><p><img src="image-20231222002122742.png" /></p><p>é€’å½’æŸ¥è¯¢ä¸é—®è¿‡ç¨‹åªè¦ç»“æœ</p><p><strong>åŸŸåä¸IPåœ°å€ä¸æ˜¯ä¸€ä¸€æ˜ å°„çš„</strong></p><h2 id="ä¸‡ç»´ç½‘">6.3 ä¸‡ç»´ç½‘</h2><h3 id="wwwå·¥ä½œæµç¨‹">wwwå·¥ä½œæµç¨‹</h3><p><img src="image-20231222002721556.png" /></p><h3 id="url">URL</h3><p><img src="image-20231222002823289.png" /></p><h3 id="http">HTTP</h3><p><img src="image-20231222002942391.png" /></p><p>HTTP 1.1ç›¸è¾ƒäº1.0æŒç»­è¿æ¥ã€æµæ°´çº¿æ–¹å¼</p><h3 id="httpä»£ç†">HTTPä»£ç†</h3><p><img src="image-20231222003557889.png" /></p><h4 id="cookie">cookie</h4><p><img src="image-20231222003650652.png" /></p><h2 id="ç”µå­é‚®ä»¶">6.4 ç”µå­é‚®ä»¶</h2><h3 id="mua">MUA</h3><p><img src="image-20231222003811006.png" /></p><h3 id="mtaå’Œmda">MTAå’ŒMDA</h3><p><img src="image-20231222003848811.png" /></p><p>ä»¥ä¸‹æ˜¯éšä¾¿å†™çš„...</p><p><img src="image-20231222004137734.png" /></p><h2 id="ftptftptelnet">6.5 FTP/TFTP/TELNET</h2><p>FTPæ˜¯TCPï¼Œä¸¤ä¸ªTCPè¿æ¥ï¼Œä¸¤ç§æ¨¡å¼portã€passive</p><p>TFTPæ˜¯UDPï¼Œå±€åŸŸç½‘ï¼Œåœç­‰åè®®</p><p>TELNETæ˜¯TCPï¼Œå‡»é”®å’Œå‘½ä»¤è½¬ä¸ºNVT</p>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç½‘ç»œç¬”è®°ï¼ˆäº”ï¼‰</title>
      <link href="/2023/12/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89/"/>
      <url>/2023/12/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%94%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¼ è¾“å±‚åŸºæœ¬åŠŸèƒ½ä¸udpåè®®">5.1 ä¼ è¾“å±‚åŸºæœ¬åŠŸèƒ½ä¸UDPåè®®</h2><h3 id="ä¼ è¾“å±‚åŠŸèƒ½">ä¼ è¾“å±‚åŠŸèƒ½</h3><p>ä¼ è¾“å±‚æä¾›åº”ç”¨è¿›ç¨‹é—´çš„é€»è¾‘é€šä¿¡ï¼Œä¸”æä¾›å¤ç”¨ä¸åˆ†ç”¨åŠŸèƒ½</p><h3 id="udpåè®®">UDPåè®®</h3><p>æ— è¿æ¥ã€ä¸å¯é </p><p>æä¾›çš„æ•°æ®å•ä½åè®®æ˜¯UDPæŠ¥æ–‡æˆ–ç”¨æˆ·æ•°æ®æŠ¥ï¼ˆ<strong>ä¸åšæ•°æ®çš„åˆ’åˆ†</strong>ï¼‰</p><p><img src="image-20231221225105915.png" /></p><p>æŠ¥æ–‡æ ¼å¼</p><p><img src="image-20231221225240560.png" /></p><p>æ­¤å¤„å¯ä»¥çœ‹å‡ºä¸ºä»€ä¹ˆä¸Šä¸€ç« ä¸­ICMPæŠ¥å¤´éœ€è¦åŒ…æ‹¬IPæ•°æ®æŠ¥æŠ¥å¤´å’Œæ•°æ®å‰8ä¸ªå­—èŠ‚ï¼Œå› ä¸ºå‰8ä¸ªå­—èŠ‚å°±æ˜¯UDPæ•°æ®æŠ¥çš„æŠ¥å¤´ï¼ŒåŒ…å«äº†è¿›ç¨‹ï¼ˆç«¯å£ï¼‰</p><p>è®¡ç®—æ ¡éªŒå’Œï¼šäºŒè¿›åˆ¶åç æ±‚å’Œ</p><h3 id="tcpåè®®">TCPåè®®</h3><p>é¢å‘è¿æ¥ã€å¯é ã€å¼€é”€æ›´å¤§</p><p><strong>ä¸æä¾›å¹¿æ’­ã€å¤šæ’­</strong></p><p>æä¾›çš„æ•°æ®å•ä½åè®®æ˜¯TCPæŠ¥æ–‡æ®µ</p><h3 id="åŸºäºç«¯å£æ ‡è¯†è¿›ç¨‹">åŸºäºç«¯å£æ ‡è¯†è¿›ç¨‹</h3><p><img src="image-20231221224846688.png" /></p><p>ç†ŸçŸ¥ç«¯å£å·</p><p><img src="image-20231221224918165.png" /></p><p>è®°ä½TCP+UDP</p><h2 id="tcpåè®®-1">5.2 TCPåè®®</h2><p>é¢å‘è¿æ¥ã€å¯é ã€å­—èŠ‚æµã€ç‚¹åˆ°ç‚¹ã€å•ä½ä¸ºæ®µ</p><p>æŠ¥æ–‡ç»“æ„</p><p><img src="image-20231221225723648.png" /></p><p>é‡è¦çš„å­—æ®µ</p><p><img src="image-20231221225955722.png" /></p><p><img src="image-20231221230037783.png" /></p><p><img src="image-20231221230238111.png" /></p><p><img src="image-20231221230323094.png" /></p><h2 id="tcpåè®®è¿æ¥ç®¡ç†">5.3 TCPåè®®è¿æ¥ç®¡ç†</h2><h3 id="tcpè¿æ¥">TCPè¿æ¥</h3><p>TCPè¿æ¥çš„ç«¯ç‚¹å«åšå¥—æ¥å­—ï¼ˆsocket)=ï¼ˆIPåœ°å€ï¼šç«¯å£å·ï¼‰ï¼Œæ¯ä¸€æ¡TCPè¿æ¥è¢«é€šä¿¡ä¸¤ç«¯ä¸¤ä¸ªå¥—æ¥å­—æ‰€ç¡®å®š</p><h3 id="ä¸‰æ¬¡æ¡æ‰‹">ä¸‰æ¬¡æ¡æ‰‹</h3><p><img src="image-20231221231123421.png" /></p><p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ç¡®ä¿å‘é€çš„ä¸æ˜¯æ—§çš„è¯·æ±‚</p><h3 id="é‡Šæ”¾è¿æ¥å››æ¬¡æ¡æ‰‹">é‡Šæ”¾è¿æ¥å››æ¬¡æ¡æ‰‹</h3><p><img src="image-20231221231704901.png" /></p><h2 id="tcpåè®®å¯é ä¼ è¾“">5.4 TCPåè®®å¯é ä¼ è¾“</h2><h3 id="å¯é ä¼ è¾“åŸç†">å¯é ä¼ è¾“åŸç†</h3><p>è¶…æ—¶é‡ä¼ æœºåˆ¶</p><h3 id="åœç­‰åè®®">åœç­‰åè®®</h3><p>åˆ†ç»„é”™è¯¯ã€åˆ†ç»„ä¸¢å¤±ã€ç¡®è®¤ä¸¢å¤±ã€ç¡®è®¤æ”¶åˆ°</p><p>ç®€å•ä½†ä¿¡é“åˆ©ç”¨ç‡ä½</p><h3 id="æµæ°´çº¿åè®®">æµæ°´çº¿åè®®</h3><h3 id="æ»‘åŠ¨çª—å£åè®®">æ»‘åŠ¨çª—å£åè®®</h3><h3 id="tcpæ»‘åŠ¨çª—å£">TCPæ»‘åŠ¨çª—å£</h3><h3 id="tcpé‡ä¼ å®šæ—¶å™¨">TCPé‡ä¼ å®šæ—¶å™¨</h3><p><img src="image-20231221233946109.png" /></p><p><img src="image-20231221234103046.png" /></p><h3 id="å…¶ä»–å®šæ—¶å™¨">å…¶ä»–å®šæ—¶å™¨</h3><p>æŒç»­å®šæ—¶å™¨ã€ä¿æ´»å®šæ—¶å™¨ã€ç­‰å¾…æ§åˆ¶å®šæ—¶å™¨</p><h3 id="tcpåè®®æ‹¥å¡æ§åˆ¶">5.5 TCPåè®®æ‹¥å¡æ§åˆ¶</h3><p>UDPæ²¡æœ‰æ‹¥å¡æ§åˆ¶èƒ½åŠ›</p><p><img src="image-20231221234652149.png" /></p><h3 id="æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…">æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…</h3><p><img src="image-20231221234806355.png" /></p><p><img src="image-20231221234946979.png" /></p><p>æ³¨æ„ç¬¬äºŒè½®çš„é˜ˆå€¼æ—¶ä¸Šä¸€è½®æ‹¥å¡æ—¶çš„ä¸€åŠ</p><h3 id="å¿«é‡ä¼ å’Œå¿«æ¢å¤">å¿«é‡ä¼ å’Œå¿«æ¢å¤</h3><p><img src="image-20231221235100133.png" /></p><p><img src="image-20231221235255378.png" /></p><h3 id="éšæœºæ—©æœŸæ£€æµ‹ç½‘ç»œå±‚">éšæœºæ—©æœŸæ£€æµ‹ï¼ˆç½‘ç»œå±‚ï¼‰</h3><p>åº”ç”¨äºè·¯ç”±å™¨é˜Ÿåˆ—ç®¡ç†</p><p><img src="image-20231221235417607.png" /></p>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç½‘ç»œç¬”è®°ï¼ˆå››ï¼‰</title>
      <link href="/2023/12/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/"/>
      <url>/2023/12/21/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E5%9B%9B%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ç½‘ç»œå±‚åŠŸèƒ½å’Œipåè®®">4.1 ç½‘ç»œå±‚åŠŸèƒ½å’ŒIPåè®®</h2><h3 id="ç½‘ç»œå±‚åŠŸèƒ½">ç½‘ç»œå±‚åŠŸèƒ½</h3><p>è·¯ç”±ã€å¯»å€ã€ç½‘ç»œäº’è”ã€ä¸ºä¸Šå±‚æä¾›æœåŠ¡</p><h3 id="ç½‘ç»œå±‚æœåŠ¡">ç½‘ç»œå±‚æœåŠ¡</h3><p>è™šç”µè·¯ï¼šæä¾›é«˜è´¨é‡æœåŠ¡ï¼Œå…¸ä¾‹ATMç½‘ç»œï¼Œé€šä¿¡éœ€è¦æå‰å»ºç«‹è™šç”µè·¯</p><p>æ•°æ®æŠ¥ï¼ˆä¸»è¦ï¼‰ï¼šç½‘ç»œæœ‰é«˜å®¹é”™æ€§ï¼ˆé²æ£’æ€§ï¼‰ã€å¯é æ€§</p><p><img src="image-20231221191444338.png" /></p><h3 id="ç½‘ç»œå±‚åè®®">ç½‘ç»œå±‚åè®®</h3><p><img src="image-20231221191659413.png" /></p><h3 id="ipåè®®">IPåè®®</h3><p>æ— è¿æ¥ã€ä¸å¯é </p><p><strong>å¸§æ ¼å¼</strong></p><p><img src="image-20231221191849865.png" /></p><p>ç‰ˆæœ¬ï¼šå 4ä½ï¼Œç›®å‰ä¸º4ï¼ˆåœ¨ä¸æ–­å‘å±•ä¸­ï¼‰</p><p>é¦–éƒ¨é•¿åº¦ï¼šå 4ä½ï¼Œå•ä½æ˜¯åŒå­—ï¼ˆå³32ä½ï¼Œä¸€èˆ¬16ä½ä¸ºä¸€ä¸ªå­—ï¼‰ï¼Œä½†IPé¦–éƒ¨çš„å›ºå®šéƒ¨åˆ†æ˜¯20å­—èŠ‚ï¼Œå› æ­¤é¦–éƒ¨é•¿åº¦å­—æ®µæœ€å°å€¼ä¸º5ï¼Œä¸”é¦–éƒ¨é•¿åº¦æœ€å¤§ä¸º60å­—èŠ‚ï¼ˆ15*32/8ï¼‰</p><p>æ€»é•¿åº¦ï¼š ä¸è¶…è¿‡æœ€å¤§ä¼ é€å•å…ƒMTU</p><p>æ ‡è¯†ï¼šè¡¨æ˜åŒä¸€ç”¨æˆ·ä¿¡æ¯çš„ä¸åŒæ•°æ®æ®µ</p><p>æ ‡è¯†ï¼ˆFlagsï¼‰ä¸ç‰‡åç§»</p><p><img src="image-20231221193825984.png" /></p><p>åç»­</p><p><img src="image-20231221194137892.png" /></p><p><img src="image-20231221194244235.png" /></p><p>å¡«å……å­—æ®µä¿è¯æŠ¥æ–‡32ä½å¯¹é½</p><h2 id="arpåè®®icmpåè®®">4.2 ARPåè®®/ICMPåè®®</h2><h3 id="arpåè®®">ARPåè®®</h3><p>MACåœ°å€æ˜¯å›ºå®šçš„ï¼ŒARPè´Ÿè´£ä»ç½‘ç»œå±‚ä½¿ç”¨çš„IPåœ°å€è§£æå‡ºæ•°æ®é“¾è·¯å±‚çš„MACåœ°å€ï¼Œè§£æç»“æœå­˜å‚¨åœ¨ä¸»æœºç¼“å­˜ä¸­ï¼Œå‘½ä»¤arp-aï¼›ä¸€èˆ¬åœ¨å±€åŸŸç½‘å†…ä½¿ç”¨ï¼Œä¸å…¶ä»–å±€åŸŸç½‘éœ€è¦è·¯ç”±ç½‘å…³</p><p><strong>å¸§æ ¼å¼</strong></p><p><img src="image-20231221195238244.png" /></p><h3 id="icmpåè®®">ICMPåè®®</h3><p>å·®é”™æ§åˆ¶</p><p><strong>å¸§æ ¼å¼</strong></p><p><img src="image-20231221195717780.png" /></p><p>ICMPåè®®å°è£…åœ¨IPåè®®ä¸­ï¼ŒIPåè®®å°è£…åœ¨ä»¥å¤ªç½‘åè®®ä¸­</p><p><img src="image-20231221195809376.png" /></p><p><strong>ICMPæŠ¥æ–‡æœ‰æ•ˆæ•°æ®åŒ…æ‹¬IPæ•°æ®æŠ¥æŠ¥å¤´ä¸æœ‰æ•ˆæ•°æ®å‰8ä¸ªå­—èŠ‚</strong>ï¼Œå‰8ä¸ªå­—èŠ‚åŒ…æ‹¬äº†ä¼ è¾“å±‚ä¸­çš„ç«¯å£å·</p><h3 id="icmpå‘½ä»¤">ICMPå‘½ä»¤</h3><p>ping tracertï¼ˆlinuxä¸­æ˜¯Trace routeï¼‰</p><h2 id="ipåœ°å€">4.3 IPåœ°å€</h2><p>IPåœ°å€æ¯”MACåœ°å€æ›´æœ‰å±‚æ¬¡ç»“æ„</p><p>å±€åŸŸç½‘å†…ä¸»æœºçš„é»˜è®¤ç½‘å…³æ˜¯è¿æ¥çš„è·¯ç”±å™¨çš„ç«¯å£</p><p>å­ç½‘æ©ç åŒºåˆ†ç½‘ç»œå·ä¸ä¸»æœºå·è¿›è€ŒåŒºåˆ†è¿œç¨‹å’Œæœ¬åœ°ä¸»æœº</p><h3 id="ipåœ°å€åˆ†ç±»æŠ˜åŠåˆ’åˆ†">IPåœ°å€åˆ†ç±»ï¼ˆæŠ˜åŠåˆ’åˆ†ï¼‰</h3><p>Aç±»å­ç½‘æ©ç 255.0.0.0ï¼ŒèŒƒå›´1.0.0.0-126.0.0.0ï¼Œç¬¬ä¸€ä½0</p><p>Bç±»255.255.0.0ï¼ŒèŒƒå›´128.0.0.0-191.255.0.0ï¼Œå‰ä¸¤ä½10</p><p>Cç±»255.255.255.0ï¼ŒèŒƒå›´192.0.0.0-223.255.255.0ï¼Œå‰ä¸‰ä½110</p><p>Dç±»å‰å››ä½1110</p><p>Eç±»å‰äº”ä½11110</p><h3 id="ç§ç½‘ip">ç§ç½‘IP</h3><p><img src="image-20231221202556872.png" /></p><h3 id="ç‰¹æ®Šip">ç‰¹æ®ŠIP</h3><p><img src="image-20231221202632653.png" /></p><p><strong>æ‰€æœ‰ç½‘æ®µä¸­å…¨0ï¼ˆç½‘ç»œåœ°å€ï¼‰å’Œå…¨1ï¼ˆå¹¿æ’­åœ°å€ï¼‰çš„åœ°å€æ˜¯ä¸å¯ä½¿ç”¨çš„ï¼ˆåˆ’åˆ†å‡ºçš„å­ç½‘ä¸­çš„ä¹Ÿæ˜¯ï¼‰</strong></p><h2 id="å­ç½‘è¶…ç½‘å’Œcidr">4.4 å­ç½‘ã€è¶…ç½‘å’ŒCIDR</h2><p>å­ç½‘ï¼šæ©ç å€Ÿç”¨ç½‘ç»œå·</p><p><img src="image-20231221204204431.png" /></p><p>è¶…ç½‘ï¼šæ©ç å€Ÿç”¨ä¸»æœºå·ï¼Œä¹Ÿç§°è·¯ç”±èšåˆ</p><h2 id="è·¯ç”±">4.5 è·¯ç”±</h2><h3 id="è½¬å‘">è½¬å‘</h3><p><img src="image-20231221205111710.png" /></p><p>è·¯ç”±è¡¨ä¸­éƒ½æ˜¯ç½‘ç»œåœ°å€ï¼Œå°†ç›®çš„åœ°å€ä¸å­ç½‘æ©ç ç›¸ä¸ï¼ŒæŸ¥çœ‹æ˜¯å¦ä¸è·¯ç”±è¡¨ä¸­çš„æŸé¡¹ç½‘ç»œåœ°å€åŒ¹é…ï¼Œå‡ºç°å¤šä¸ªåŒ¹é…é¡¹æ—¶ï¼Œé€‰æ‹©æœ€é•¿å‰ç¼€åŒ¹é…åœ°å€</p><p>è½¬å‘è¿‡ç¨‹ä¸­æºã€ç›®çš„MACå˜åŒ–ï¼ŒIPä¸å˜åŒ–</p><h2 id="è·¯ç”±ç®—æ³•">4.6 è·¯ç”±ç®—æ³•</h2><h3 id="åˆ†ç±»">åˆ†ç±»</h3><p><img src="image-20231221211901868.png" /></p><p>è‡ªæ²»ç³»ç»Ÿï¼ˆASï¼‰ï¼šå†…éƒ¨é‡‡ç”¨ä¸€è‡´è·¯ç”±ç­–ç•¥</p><h3 id="è·¯ç”±åè®®">è·¯ç”±åè®®</h3><p>å†…éƒ¨ç½‘å…³è·¯ç”±åè®®ï¼šRIPã€OSPF</p><p>å¤–éƒ¨ç½‘å…³è·¯ç”±åè®®ï¼šBGP</p><h3 id="è·¯ç”±ç®—æ³•-1">è·¯ç”±ç®—æ³•</h3><p>è·ç¦»çŸ¢é‡è·¯ç”±</p><p>é“¾è·¯çŠ¶æ€è·¯ç”±ï¼šè¿ªæ°æ–¯ç‰¹æ‹‰ç®—æ³•ï¼Œåˆ†ç»„ä¸­åŒ…æ‹¬åºå·å’Œå¹´é¾„ï¼ˆè·¯ç”±å™¨é‡å¯é—®é¢˜ï¼‰</p><p><img src="image-20231221212818612.png" /></p><h2 id="å†…éƒ¨ç½‘å…³è·¯ç”±åè®®">4.7 å†…éƒ¨ç½‘å…³è·¯ç”±åè®®</h2><h3 id="ripåè®®åŸºäºè·ç¦»çŸ¢é‡è·¯ç”±">RIPåè®®ï¼ˆåŸºäºè·ç¦»çŸ¢é‡è·¯ç”±ï¼‰</h3><p><img src="image-20231221213118495.png" /></p><p>æ³¨æ„æœ€å¤§è·³æ•°æ˜¯15è·³</p><p><strong>é¿å…ç¯è·¯æœºåˆ¶</strong></p><p><img src="image-20231221213439818.png" /></p><p><strong>RIPå®šæ—¶å™¨</strong></p><p><img src="image-20231221213551379.png" /></p><p>RIPv2æ ¼å¼</p><p><img src="image-20231221213722112.png" /></p><p>å‘½ä»¤å­—æ®µ1ä¸ºè¯·æ±‚ï¼Œ2ä¸ºå“åº”</p><h3 id="ospfåè®®">OSPFåè®®</h3><p><img src="image-20231221213954217.png" /></p><p>æŠ¥æ–‡æ ¼å¼</p><p><img src="image-20231221214101245.png" /></p><p>äº”ç§ç±»å‹çš„OSPFåˆ†ç»„</p><p><img src="image-20231221214321241.png" /></p><p>å·¥ä½œæµç¨‹</p><p><img src="image-20231221214409844.png" /></p><h2 id="å¤–éƒ¨ç½‘å…³è·¯ç”±åè®®å’Œå¤šæ’­è·¯ç”±åè®®">4.8å¤–éƒ¨ç½‘å…³è·¯ç”±åè®®å’Œå¤šæ’­è·¯ç”±åè®®</h2><h3 id="bgpåè®®">BGPåè®®</h3><p><img src="image-20231221214800483.png" /></p><p>BGPçš„äº”ç§æŠ¥æ–‡</p><p><img src="image-20231221215037059.png" /></p><p>æŠ¥æ–‡æ ¼å¼</p><p><img src="image-20231221215111420.png" /></p><h3 id="å¤šæ’­">å¤šæ’­</h3><p>åº”ç”¨ï¼šä¼šå‘˜ç‚¹æ’­</p><p>å¤šæ’­éœ€è¦ç¡¬ä»¶å¤šæ’­åœ°å€æ”¯æŒï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹</p><p><img src="image-20231221215512357.png" /></p><p>å¤šæ’­éœ€è¦æˆå‘˜ç®¡ç†åè®®</p><p>IGMPåè®®</p><p><img src="image-20231221215910851.png" /></p><p>å·¥ä½œæµç¨‹ç•¥</p><p>å¤šæ’­éœ€è¦å¤šæ’­è·¯ç”±åè®®</p><p>RPBã€éš§é“æŠ€æœ¯ï¼Œå…·ä½“ç•¥</p><h2 id="è·¯ç”±å™¨">4.9 è·¯ç”±å™¨</h2><p>ç»“æ„ç•¥</p><p>è·¯ç”±å’Œè½¬å‘</p><p>è½¬å‘è¡¨ç¡¬ä»¶ã€è·¯ç”±è¡¨è½¯ä»¶</p><p><strong>ä¸åˆ†ç‰‡</strong></p><p>ç•¥</p><p>ç•¥</p><p>ç•¥</p><h2 id="vpnnatmpls">4.10 VPN/NAT/MPLS</h2><h3 id="vpn">VPN</h3><p>åˆ†ç±»ï¼šå†…è”ç½‘ã€å¤–è”ç½‘ã€è¿œç¨‹æ¥å…¥</p><h3 id="nat">NAT</h3><p>å¤šå†…ç½‘ä¸»æœºå…±ç”¨å¤–ç½‘IP</p><h3 id="mpls">MPLS</h3><p>ç•¥</p><h2 id="ipv6">4.11 IPv6</h2><h3 id="ä¸»è¦ç›®æ ‡">ä¸»è¦ç›®æ ‡</h3><p><img src="image-20231221222128138.png" /></p><h3 id="ä¸»è¦ç‰¹ç‚¹">ä¸»è¦ç‰¹ç‚¹</h3><p><img src="image-20231221222205002.png" /></p><h3 id="æŠ¥æ–‡æ ¼å¼">æŠ¥æ–‡æ ¼å¼</h3><p>ç•¥</p><h3 id="ipv6åœ°å€">IPv6åœ°å€</h3><p>å•æ’­ã€å¤šæ’­ã€ä»»æ„æ’­ï¼ˆé€šå¸¸æ˜¯æœ€è¿‘çš„ä¸€ä¸ªï¼‰</p><p>è¿ç»­çš„0å…è®¸å‹ç¼©ï¼Œä½†åªå…è®¸ä¸€æ¬¡</p><p>IPv4å¯è®°ä¸ºï¼šï¼š128.10.2.1</p><p>CIDRæ–œçº¿è®°æ³•ä»é€‚ç”¨</p><p><img src="image-20231221223207704.png" /></p><p><img src="image-20231221223219562.png" /></p><p>æœ¬åœ°é“¾è·¯å•æ’­åœ°å€å³IPv4ä¸­çš„ç§æœ‰IPåœ°å€</p><p><img src="image-20231221223252267.png" /></p><p>å¤Ÿé•¿ï¼Œå¯ä»¥ç›´æ¥æŠŠMACå†™è¿›æ¥ï¼Œå› æ­¤ä¸éœ€è¦ARP</p><h3 id="ä¸¤ç±»åœ°å€çš„è¿‡æ¸¡">ä¸¤ç±»åœ°å€çš„è¿‡æ¸¡</h3><p><img src="image-20231221223354246.png" /></p>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤è¡Œæ”¶å‘é‚®ä»¶</title>
      <link href="/2023/11/24/%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%94%B6%E5%8F%91%E9%82%AE%E4%BB%B6/"/>
      <url>/2023/11/24/%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%94%B6%E5%8F%91%E9%82%AE%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<p>win11ä¸‹telnetå®¢æˆ·ç«¯é»˜è®¤æ˜¯å…³é—­çš„ï¼Œé¦–å…ˆæ‰“å¼€telnet</p><p>æ§åˆ¶é¢æ¿-ç¨‹åº-ç¨‹åºä¸åŠŸèƒ½-å¯ç”¨æˆ–å…³é—­WindowsåŠŸèƒ½</p><p><img src="1.png" /></p><h3 id="å‘é€é‚®ä»¶">å‘é€é‚®ä»¶</h3><p>cmdä¸­telnetè¿œç¨‹ç™»å½•163é‚®ç®±smtpæœåŠ¡å™¨ï¼Œç«¯å£å·25</p><p><ahref="https://blog.csdn.net/gongqinglin/article/details/115975619">å„ç§é‚®ç®±æ”¶å‘æœåŠ¡å™¨åœ°å€åŠç«¯å£</a></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet smtp.<span class="number">163</span>.com <span class="number">25</span></span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šä»¥ä¸‹è¿‡ç¨‹ï¼Œtelnetä¸­è¾“å…¥ä»»ä½•å­—ç¬¦å¦‚æœæœ‰é”™ï¼Œè¯¥æ¡å‘½ä»¤å°±éœ€è¦å›è½¦é‡æ–°å†™ï¼Œå°±ç®—å›é€€é‡å†™åªæ˜¯è¡¨é¢æ”¹å˜äº†ï¼Œå®é™…è¿˜æ˜¯æ¥ç€è¾“å…¥ï¼Œè¿è¡Œä¸€å®šä¼šæŠ¥é”™æˆ–è¾“å‡ºä¸ç¬¦é¢„æœŸ</strong></p><p>å‘æœåŠ¡å™¨æ‰“æ‹›å‘¼,çœ‹æ˜¯å¦å¾—åˆ°æ­£ç¡®å›åº”ï¼ˆæœ‰çš„æœåŠ¡å™¨æ˜¯ehloï¼‰</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helo hi</span><br></pre></td></tr></table></figure><p>é€‰æ‹© auth loginç™»å½•æ–¹å¼</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth login</span><br></pre></td></tr></table></figure><p>è¾“å…¥base64ç¼–ç åçš„ç”¨æˆ·åå¯†ç ï¼ˆç”¨æˆ·åä¸å¸¦@163.comï¼‰ï¼ŒAuthenticationsuccessfuléªŒè¯æˆåŠŸ</p><p>æ¥ç€è¾“å…¥å‘ä»¶äººé‚®ç®±ã€æ”¶ä»¶äººé‚®ç®±ï¼Œè¾“å…¥dataå¼€å§‹å†™ä¿¡</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mail from:&lt;å‘ä»¶äººé‚®ç®±åœ°å€&gt;</span><br><span class="line">rcpt to:&lt;æ”¶ä»¶äººé‚®ç®±åœ°å€&gt;</span><br><span class="line">data //å¼€å§‹å†™ä¿¡çš„å†…å®¹</span><br></pre></td></tr></table></figure><p>è¾“å…¥é‚®ä»¶ä¸»é¢˜</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">subject:<span class="title">hi</span></span></span><br></pre></td></tr></table></figure><p>ç©ºä¸€è¡Œä¹‹åè¾“å…¥å†…å®¹</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello world!</span><br></pre></td></tr></table></figure><p>å†™å®Œåè¾“å…¥</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.</span><br></pre></td></tr></table></figure><p>è¿›å…¥æ”¶ä»¶äººé‚®ç®±æŸ¥çœ‹ï¼Œæœ‰è¯¥é‚®ä»¶</p><p>ä»¥ä¸‹æ˜¯å®Œæ•´è¿‡ç¨‹ä¸ç»“æœæˆªå›¾</p><p><img src="2.png" /></p><h3 id="æ¥æ”¶é‚®ä»¶">æ¥æ”¶é‚®ä»¶</h3><p>pop3æ¥æ”¶é‚®ä»¶ï¼Œqqçš„ç«¯å£å·110ï¼Œ<strong>æ³¨æ„æ­¤å¤„æ˜¯110</strong>ï¼ŒQQå®˜ç½‘ä¸Šç»™çš„995æ˜¯SSLåŠ å¯†çš„ç«¯å£</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet pop.qq.com <span class="number">110</span></span><br></pre></td></tr></table></figure><p>å…ˆå¾—åœ¨qqé‚®ç®±ä¸­å¯ç”¨pop3</p><p><img src="3.png" /></p><p><img src="4.png" /></p><p>æˆæƒç å¤åˆ¶ä¸€ä¸‹ï¼Œç­‰ä¸‹passwordå¯ä»¥è¾“æˆæƒç </p><p>ç™»å½•pop3åï¼Œè¾“å…¥ç”¨æˆ·åã€æˆæƒç </p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user ç”¨æˆ·å</span><br><span class="line">pass æˆæƒç </span><br></pre></td></tr></table></figure><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list //æŸ¥çœ‹æ‰€æœ‰é‚®ä»¶</span><br></pre></td></tr></table></figure><p><img src="6.png" /></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">retr <span class="number">63</span> //retrå‘½ä»¤æŸ¥çœ‹é‚®ä»¶å†…å®¹</span><br></pre></td></tr></table></figure><p><img src="7.png" /></p><p>æ­¤å¤–è¿˜æœ‰å‘½ä»¤</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dele //åˆ é™¤é‚®ä»¶ï¼ˆéçœŸæ­£åˆ é™¤ï¼Œè€Œæ˜¯æ ‡è®°åˆ é™¤ï¼‰</span><br><span class="line">rset //æ¢å¤åˆ é™¤</span><br><span class="line">quit //é€€å‡ºæ—¶ä¼šæŠŠæ‰€æœ‰æ ‡è®°åˆ é™¤çš„é‚®ä»¶åˆ é™¤</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> cmd </tag>
            
            <tag> é‚®ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç½‘ç»œç¬”è®°ï¼ˆä¸‰ï¼‰</title>
      <link href="/2023/11/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/"/>
      <url>/2023/11/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%89%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="æ•°æ®é“¾è·¯å±‚åŸºæœ¬åŠŸèƒ½">3.1 æ•°æ®é“¾è·¯å±‚åŸºæœ¬åŠŸèƒ½</h2><h3 id="å°è£…æˆå¸§æœ€é‡è¦">å°è£…æˆå¸§ï¼ˆæœ€é‡è¦ï¼‰</h3><p>å­—ç¬¦è®¡æ•°æ³•ã€ç‰¹æ®Šå­—ç¬¦ç•Œå®šæ³•ã€ç‰¹æ®Šä½ä¸²ç•Œå®šæ³•ï¼ˆä»¥01111110ä¸ºå¸§çš„è¾¹ç•Œï¼Œæ­£æ–‡ä¸­æ¯5ä¸ª1å¼ºåˆ¶åé¢æ·»0ï¼‰ã€ç‰©ç†å±‚ç¼–ç è¿ä¾‹æ³•ï¼ˆä»¥ç‰¹æ®Šæ³¢å½¢ä½œä¸ºå¸§çš„è¾¹ç•Œï¼‰</p><h3 id="é€æ˜ä¼ è¾“">é€æ˜ä¼ è¾“</h3><p>å¸§å®šç•Œç¬¦ï¼šSOHï¼ˆStart Of Headerï¼ŒASCIIç 01ï¼‰ã€EOTï¼ˆEnd OfTransmissionï¼ŒASCIIç 04ï¼‰ï¼Œéƒ½æ˜¯ä¸å¯æ‰“å°å­—ç¬¦ã€‚å½“ä¼ é€çš„å¸§æ˜¯ç”¨æ–‡æœ¬æ–‡ä»¶ç»„æˆçš„å¸§ï¼ˆæ–‡æœ¬æ–‡ä»¶ä¸­çš„å­—ç¬¦éƒ½æ˜¯ä»é”®ç›˜ä¸Šè¾“å…¥çš„ï¼‰ï¼Œé‚£ä¹ˆä¸ç®¡è¾“å…¥ä»€ä¹ˆæ ·çš„å­—ç¬¦éƒ½å¯ä»¥æ”¾åœ¨å¸§ä¸­ä¼ è¾“è¿‡å»ï¼Œç§°ä¸ºé€æ˜ä¼ è¾“ã€‚å½“æ•°æ®ä¸­æœ‰SOHã€EOTæ—¶ä¼šè¢«æ•°æ®é“¾è·¯å±‚è¯¯åˆ¤ä¸ºå¸§çš„è¾¹ç•Œï¼Œå› æ­¤åœ¨è¿™æ ·çš„æ•°æ®å‰æ·»åŠ è½¬ä¹‰å­—ç¬¦ESC</p><h3 id="å·®é”™æ§åˆ¶">å·®é”™æ§åˆ¶</h3><p><strong>æ£€é”™ç </strong></p><p>å¾ªç¯å†—ä½™æ ¡éªŒCRCï¼šnä½å†—ä½™ç ï¼ˆFCSå¸§æ£€éªŒåºåˆ—ï¼‰æ˜¯ç”±æ•°æ®Mæ·»åŠ nä¸ª0åé™¤ä»¥n+1ä½é™¤æ•°På¾—åˆ°çš„ä½™æ•°ï¼Œæ¥æ”¶ç«¯å°†Mä¸FCSæ‹¼æ¥åé™¤ä»¥ç›¸åŒçš„é™¤æ•°ï¼Œä½™æ•°ä¸º0æ­£å¸¸ï¼Œä½™æ•°ä¸ä¸º0ä¸¢å¼ƒ</p><p><strong>çº é”™ç </strong></p><p><strong>æµ·æ˜ç </strong></p><h3 id="æµé‡æ§åˆ¶">æµé‡æ§åˆ¶</h3><p>æ»‘åŠ¨çª—å£åè®®ã€åœç­‰åè®®</p><h3 id="é“¾è·¯ç®¡ç†">é“¾è·¯ç®¡ç†</h3><p>å»ºç«‹ã€ç»´æŒã€é‡Šæ”¾è¿æ¥</p><h2 id="pppåè®®">3.2 PPPåè®®</h2><h3 id="é“¾è·¯ç±»å‹">é“¾è·¯ç±»å‹</h3><p>å¹¿æ’­é“¾è·¯-&gt;MACåè®®ï¼Œç‚¹åˆ°ç‚¹é“¾è·¯-&gt;PPPåè®®</p><h3 id="pppåè®®åŠŸèƒ½">PPPåè®®åŠŸèƒ½</h3><p>æˆå¸§æ–¹æ³•ã€é“¾è·¯æ§åˆ¶åè®®LCPã€ç½‘ç»œå±‚é€‰é¡¹åå•†æ–¹æ³•NCP</p><h3 id="pppåè®®å¸§çš„æ ¼å¼">PPPåè®®å¸§çš„æ ¼å¼</h3><p><img src="3.2-1.png" /></p><p>Flagå­—æ®µè¡¨ç¤ºå¸§çš„è¾¹ç•Œ</p><p>Addåœ°å€å­—æ®µ</p><p>Ctrlæ§åˆ¶å­—æ®µï¼Œå®é™…å†…å®¹ä¸º03ï¼Œä¸ºäº†ä»¥åå‡çº§å¯ä»¥æ·»åŠ å…¶ä»–æ§åˆ¶ä¿¡æ¯</p><p>åè®®å­—æ®µå¯ä»¥é€šè¿‡åå•†ä¸º1ä¸ªå­—èŠ‚</p><p>FCSæ£€éªŒå­—æ®µï¼Œé€šè¿‡åå•†å¯ä»¥æ˜¯4ä¸ªå­—èŠ‚</p><h3 id="pppåè®®é€æ˜ä¼ è¾“">PPPåè®®é€æ˜ä¼ è¾“</h3><p>å¼‚æ­¥ä¼ è¾“ï¼ˆæŒ‰å­—èŠ‚é¡ºåºï¼‰ï¼šå­—ç¬¦å¡«å……æ³•ï¼Œ0x7Eå®šç•Œï¼Œä¿¡æ¯å­—æ®µä¸­çš„0x7Eå˜ä¸º0x7Då’Œ0x5Eï¼Œè‹¥å†å‡ºç°0x7Dï¼Œ0x7Då˜ä¸º0x7Då’Œ0x5Dï¼›è‹¥å‡ºç°ASCIIç çš„æ§åˆ¶å­—ç¬¦ï¼ˆå³æ•°å€¼å°äºOx20çš„å­—ç¬¦ï¼‰ï¼Œåˆ™åœ¨è¯¥å­—ç¬¦å‰é¢è¦åŠ å…¥ä¸€ä¸ªOx7Då­—èŠ‚ï¼ŒåŒæ—¶å°†è¯¥å­—ç¬¦çš„ç¼–ç åŠ ä»¥æ”¹å˜</p><p>åŒæ­¥ä¼ è¾“ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰ï¼šä»¥01111110ä¸ºå¸§çš„è¾¹ç•Œï¼Œæ­£æ–‡ä¸­æ¯5ä¸ª1å¼ºåˆ¶åé¢æ·»0</p><h3 id="pppåè®®å·¥ä½œæµç¨‹">PPPåè®®å·¥ä½œæµç¨‹</h3><p><img src="å±å¹•æˆªå›¾%202023-12-21%20101540.png" /></p><h3 id="pppåè®®æ— å·®é”™æ§åˆ¶">PPPåè®®æ— å·®é”™æ§åˆ¶</h3><p>â‘ æ•°æ®é“¾è·¯å±‚å‡ºç°å·®é”™æ¦‚ç‡ä¸å¤§ï¼Œä½¿ç”¨ç®€å•çš„PPPåè®®</p><p>â‘¡PPPåè®®ä¸»è¦æ‰¿è½½çš„æ˜¯IPæ•°æ®æŠ¥ï¼ŒIPåè®®æœ¬èº«æ˜¯ä¸å¯é ã€æ— è¿æ¥çš„</p><p>â‘¢PPPåè®®ä¸­çš„FCSå­—æ®µå¯ä»¥ä¿è¯æ— å·®é”™æ¥å—</p><h2 id="å±€åŸŸç½‘macåè®®">3.3 å±€åŸŸç½‘MACåè®®</h2><p>å±€åŸŸç½‘æ•°æ®é“¾è·¯å±‚é‡‡ç”¨å¹¿æ’­å¼é€šä¿¡ï¼ŒèŠ‚ç‚¹å¯ä»¥è®¿é—®ç½‘å†…å…¶ä»–èŠ‚ç‚¹ï¼Œæ˜¯å•ä½ã€å®¶åº­æ¥å…¥ç½‘ç»œä¸»è¦å½¢å¼</p><h3 id="ç½‘å¡">ç½‘å¡</h3><p>å®ç°CSMA/CDå’ŒCSMA/CAåè®®çš„è®¾å¤‡ã€è¿›è¡Œæ•°æ®çš„ä¸²/å¹¶è¡Œè½¬æ¢å’Œç¼“å­˜ã€éœ€è¦åœ¨è®¡ç®—æœºæ“ä½œç³»ç»Ÿå®‰è£…è®¾å¤‡é©±åŠ¨ç¨‹åº</p><p><img src="image-20231221103755831.png" /></p><p>æ­¤å¤„çš„ç¡¬ä»¶åœ°å€å³MACåœ°å€</p><h3 id="macåœ°å€">MACåœ°å€</h3><p>å¯é‡‡ç”¨6å­—èŠ‚æˆ–2å­—èŠ‚ï¼Œç”¨ - åˆ†å‰²æˆ– : åˆ†å‰²æˆ–ä¸åˆ†å‰²éƒ½å¯</p><p>6å­—èŠ‚MACåœ°å€çš„å‰3å­—èŠ‚ä¸ºç»„ç»‡å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå³å‚å•†æ ‡è¯†ï¼Œå3å­—èŠ‚ä¸ºæ‹“å±•å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå‚å•†è‡ªè¡ŒæŒ‡æ´¾ï¼Œä¿è¯ä¸é‡å¤</p><p>é€‚é…å™¨æ¥æ”¶åˆ°MACå¸§æ—¶é¦–å…ˆæ£€æŸ¥åœ°å€å­—æ®µæ˜¯å¦ä¸ºæœ¬ç«™ï¼Œä¸æ˜¯åˆ™ä¸¢å¼ƒï¼Œæ··æ‚æ¨¡å¼çš„ç½‘å¡å¯æ”¶ä¸‹æ‰€æœ‰çš„å¸§</p><p>IEEEè§„å®šåœ°å€å­—æ®µç¬¬ä¸€å­—èŠ‚çš„æœ€ä½ä½ä¸ºI/Gä½ï¼Œå‘å¾€æœ¬åœ°çš„åœ°å€åŒ…æ‹¬ä»¥ä¸‹ä¸‰ç§</p><p>å•æ’­ï¼ˆä¸€å¯¹ä¸€ï¼‰å¸§ï¼šI/Gä½=0</p><p>å¹¿æ’­ï¼ˆä¸€å¯¹æ‰€æœ‰ï¼‰å¸§ï¼šI/Gä½=1</p><p>å¤šæ’­ï¼ˆä¸€å¯¹å¤šï¼‰å¸§ï¼š48ä½åœ°å€å…¨ä¸º1</p><h3 id="å¤šå€æ¥å…¥åè®®">å¤šå€æ¥å…¥åè®®</h3><p><img src="image-20231221121751529.png" /></p><p>å›ºå®šå¤šå€æ¥å…¥åè®®å¯¹åº”ç‰©ç†å±‚çš„TDMã€FDMã€CDMï¼ŒSDMAæ˜¯ç©ºï¼ˆç©ºé—´ï¼‰åˆ†å¤ç”¨</p><h3 id="éšæœºå¤šå€æ¥å…¥åè®®">éšæœºå¤šå€æ¥å…¥åè®®</h3><p>å®Œå…¨éšæœºï¼š</p><p>çº¯ALOHAï¼šäº§ç”Ÿæ•°æ®ç«‹å³å‘é€ï¼Œä¸è€ƒè™‘ä¿¡é“å ç”¨æƒ…å†µï¼Œå†²çªçš„æŠ¥æ–‡è¢«ä¸¢å¼ƒï¼Œå‘ç”Ÿå†²çªåéšæœºå»¶è¿Ÿ</p><p>æ—¶éš™çš„ALOHAï¼šåœ¨ä¸Šé¢åŸºç¡€ä¸Šæ”¹ä¸ºæŠ¥æ–‡é•¿åº¦å›ºå®šã€å¿…é¡»åœ¨ä¸€ä¸ªæ—¶éš™å†…ä¼ è¾“ï¼ˆå³æ—¶é—´è¢«åˆ†ä¸ºæ—¶éš™ï¼ŒæŠ¥æ–‡å¿…é¡»åœ¨æ—¶éš™å¼€å§‹å¤„å‘é€ï¼‰</p><p>ï¼ˆè½½æ³¢ä¾¦å¬å¤šå€åè®®ï¼‰CSMAï¼š</p><p>éåšæŒï¼šå½“èŠ‚ç‚¹ç›‘å¬åˆ°ä¿¡é“å¿™æ—¶ï¼Œéšæœºåå»¶ä¸€æ®µæ—¶é—´å†æ¥ç›‘å¬</p><p>1-åšæŒï¼šèŠ‚ç‚¹å‘é€æ•°æ®å‰ï¼Œå…ˆç›‘å¬ä¿¡é“ï¼Œè‹¥ä¿¡é“å¿™åˆ™ä¸€ç›´ç›‘å¬ç›´åˆ°ç©ºé—²ï¼Œä¸€ç©ºé—²ç«‹åˆ»å‘é€ï¼ˆå…¶å®è¦ç­‰9.6Î¼sçš„æœ€å°å¸§é—´é—´éš”ï¼‰</p><p>P-åšæŒï¼šåŒä¸Šï¼Œä½†ç©ºé—²æ—¶ä»¥Pçš„æ¦‚ç‡å‘é€æ•°æ®ï¼Œ1-Pçš„æ¦‚ç‡æ¨è¿Ÿ</p><h2 id="csmacdåè®®">3.4 CSMA/CDåè®®</h2><p>æœ‰çº¿å±€åŸŸç½‘ä»¥å¤ªç½‘é‡‡ç”¨çš„MACåè®®</p><p>ä¸¤ä¸ªåŸºæœ¬ç‰¹ç‚¹ï¼šä¸å¯é ã€æ— è¿æ¥ï¼Œé‡‡ç”¨æ›¼å½»æ–¯ç‰¹ç¼–ç æ–¹å¼</p><p><img src="image-20231221154425445.png" /></p><p>ç”µç£æ³¢åœ¨1kmç”µç¼†çš„ä¼ æ’­æ—¶å»¶çº¦5Î¼s</p><h3 id="äº‰ç”¨æœŸ">äº‰ç”¨æœŸ</h3><p>CSMA/CDé‡‡ç”¨1-åšæŒï¼Œç«¯åˆ°ç«¯å¾€è¿”æ—¶å»¶2Ï„ç§°ä¸ºäº‰ç”¨æœŸï¼Œå¤§å°ä¸º51.2Î¼sï¼Œä»¥å¤ªç½‘è§„å®šæœ€çŸ­å¸§é•¿64å­—èŠ‚ï¼Œå³512bitï¼Œä»è€Œå¯¹äº10Mbit/sçš„ä»¥å¤ªç½‘ï¼Œå‘é€512bitçš„æ—¶é—´å°±æ˜¯51.2Î¼sï¼Œå³äº‰ç”¨æœŸå¤§å°</p><p>ç»è¿‡äº‰ç”¨æœŸè¿™æ®µæ—¶é—´è¿˜æ²¡æœ‰æ£€æµ‹åˆ°ç¢°æ’ï¼Œå°±è‚¯å®šæ­¤æ¬¡å‘é€ä¸ä¼šå‘ç”Ÿç¢°æ’</p><h3 id="bebäºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•">BEBï¼ˆäºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ï¼‰ç®—æ³•</h3><p><img src="image-20231221162109560.png" /></p><p>å‘é€æ•°æ®çš„ç«™æ£€æµ‹åˆ°å†²çªåï¼Œè¿˜ä¼šå‘é€32bitæˆ–48bitçš„äººä¸ºå¹²æ‰°ä¿¡å·ï¼Œ<strong>ä¸”è¿™ä¸ªä¿¡å·å‘é€åœ¨BEBç®—æ³•ä¹‹å‰</strong></p><h3 id="csmacdåè®®å¸§æ ¼å¼">CSMA/CDåè®®å¸§æ ¼å¼</h3><p><img src="image-20231221164319609.png" /></p><p>æ³¨æ„å¤´éƒ¨çš„8bitå‰åŒæ­¥ç ä¸å¸§å¼€å§‹å®šç•Œç¬¦</p><p>ä»¥å¤ªç½‘è§„å®šå¸§é—´æœ€å°é—´éš”ä¸º9.6Î¼s</p><h2 id="æ— çº¿ç½‘macåè®®">3.5 æ— çº¿ç½‘MACåè®®</h2><h3 id="æ— çº¿ç½‘ç»œ">æ— çº¿ç½‘ç»œ</h3><p>WPANï¼ˆæ— çº¿ä¸ªåŸŸç½‘ï¼‰-&gt; WLANï¼ˆæ— çº¿å±€åŸŸç½‘ï¼‰-&gt; WMANï¼ˆæ— çº¿åŸåŸŸç½‘ï¼‰-&gt; WWANï¼ˆæ— çº¿å¹¿åŸŸç½‘ï¼‰</p><p>æ”¯æŒWPANä¸»æµæŠ€æœ¯ï¼šZigBeeï¼ˆè‡ªç»„ç»‡ç½‘ç»œå½¢å¼å»ºç«‹ç½‘ç»œæ‹“æ‰‘ï¼‰ã€è“ç‰™ï¼ˆæ ‡å‡†ä¸ºIEEE802.15.1ï¼‰</p><p>WMANçš„å…¸å‹æ— çº¿å®½å¸¦æ¥å…¥åŸåŸŸç½‘æŠ€æœ¯æ ‡å‡†WiMAX</p><p>WWANæ˜¯èœ‚çªé€šä¿¡ç³»ç»Ÿçš„ä¸»è¦è§£å†³æ–¹æ¡ˆ</p><p>WLANåè®®ä¸»è¦æ˜¯802.11åè®®</p><h3 id="bssåŸºæœ¬ä¸šåŠ¡é›†">802.11 BSSï¼ˆåŸºæœ¬ä¸šåŠ¡é›†ï¼‰</h3><p>BSSï¼šå­˜åœ¨æ¥å…¥ç‚¹ï¼ˆAPï¼‰ï¼Œè´Ÿè´£é›†å†…å·¥ä½œç«™ä¹‹é—´çš„é€šä¿¡</p><p>IBSSï¼šç‹¬ç«‹çš„åŸºæœ¬ä¸šåŠ¡é›†ï¼Œæ— æ¥å…¥ç‚¹ï¼Œåˆç§°ç§»åŠ¨è‡ªç»„ç½‘æ¨¡å¼ï¼ˆAdhocï¼‰ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯æ— çº¿é€šä¿¡</p><p>ä¸šåŠ¡é›†ç”±SSIDæ ‡è¯†ï¼ŒBSSä¸­çš„BSSIDå¯ä»¥ç†è§£ä¸ºAPçš„MACåœ°å€</p><p>ESSï¼šé€šè¿‡éª¨å¹²ç½‘å°†å¤šä¸ªBSSä¸²è”èµ·æ¥å½¢æˆï¼ŒåŒä¸€ä¸ªESSå†…çš„SSIDç›¸åŒ</p><p>DSï¼ˆåˆ†å¸ƒå¼ç³»ç»Ÿï¼‰ï¼šé€šè¿‡APå°†æ— çº¿å±€åŸŸç½‘ä¸æœ‰çº¿å±€åŸŸç½‘ç›¸è¿</p><h2 id="csmacaåè®®">3.6 CSMA/CAåè®®</h2><h3 id="é¢ä¸´çš„é—®é¢˜">802.11é¢ä¸´çš„é—®é¢˜</h3><p>éšè—ç»ˆç«¯é—®é¢˜ã€æš´éœ²ç»ˆç«¯é—®é¢˜</p><h3 id="å¸§é—´é—´éš”">å¸§é—´é—´éš”</h3><p>SIFSï¼šä¸€æ¬¡äº¤äº’è¿‡ç¨‹ä¸­ï¼Œä¸¤å¸§ä¹‹é—´çš„é—´éš”</p><p>PIFSï¼šç‚¹åè°ƒæ–¹å¼ä¸‹ï¼ˆAPæ§åˆ¶ä¸‹ï¼‰è®¿é—®ä¿¡é“çš„æ—¶é—´é—´éš”</p><p>DIFSï¼šä¸¤æ¬¡ä¸šåŠ¡ä¹‹é—´çš„æ—¶é—´é—´éš”</p><p>EIFSï¼šå‰ä¸€å¸§å‡ºé”™æ—¶ï¼Œéœ€è¦å»¶è¿Ÿçš„æ—¶é—´é—´éš”</p><h3 id="ä¿¡é“é¢„çº¦æµç¨‹">ä¿¡é“é¢„çº¦æµç¨‹</h3><p><img src="image-20231221175006078.png" /></p><p>CSMA/CDæ˜¯å†²çªæ£€æµ‹ï¼ŒCAæ˜¯å†²çªé¿å…ï¼ˆè®¾å¤‡é™åˆ¶æ— æ³•è¾¹å‘é€è¾¹ç›‘å¬ï¼‰</p><h3 id="bebç®—æ³•">BEBç®—æ³•</h3><p>é€€é¿çª—å£é»˜è®¤å¼€å§‹ä¸º[0,31]ä¸ªslotï¼Œå‘ç”Ÿä¸€æ¬¡é‡ä¼ åï¼Œç«äº‰çª—å£åœ¨[0,63]ä¸ªslotä¸­éšæœºé€‰å–ä¸€ä¸ªï¼Œæ¯å‘ç”Ÿä¸€æ¬¡é‡ä¼ ï¼Œç«äº‰çª—å£å°±ç§»è‡³ä¸‹ä¸€ä¸ª2çš„æŒ‡æ•°ï¼Œå…­æ¬¡å°é¡¶</p><h3 id="å¸§ç»“æ„">802.11å¸§ç»“æ„</h3><p><img src="image-20231221184305524.png" /></p><p>å­—æ®µå†…å®¹ç•¥ï¼ˆå¤ªå¤šäº†ä¸æƒ³å­¦...</p><h2 id="ç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚ç½‘ç»œäº’è”è®¾å¤‡">3.7ç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚ç½‘ç»œäº’è”è®¾å¤‡</h2><h3 id="ç‰©ç†å±‚">ç‰©ç†å±‚</h3><p>é›†çº¿å™¨ï¼ˆä¸­ç»§å™¨çš„é›†ä¸­ï¼‰ã€ä¸­ç»§å™¨</p><h3 id="æ•°æ®é“¾è·¯å±‚">æ•°æ®é“¾è·¯å±‚</h3><p><strong>ç½‘æ¡¥</strong>ï¼šç”Ÿæˆæ ‘ç®—æ³•</p><p><strong>äº¤æ¢æœº</strong>ï¼š</p><p>é€šè¿‡åœ°å€å­¦ä¹ è¿‡ç¨‹å°†ç«¯å£ä¸MACåœ°å€å¯¹åº”ï¼Œæ³›æ´ª</p><p>è½¬å‘æœ‰å­˜å‚¨è½¬å‘ï¼ˆæ£€æŸ¥å·®é”™ï¼‰ä¸ç›´é€šè½¬å‘ä¸¤ç§å·¥ä½œæ–¹å¼</p><p>åˆ’åˆ†VLANï¼ˆè™šæ‹Ÿå±€åŸŸç½‘ï¼‰ï¼šåŸºäºç«¯å£åˆ’åˆ†ã€åŸºäºMACåœ°å€ã€æ ¹æ®ç½‘ç»œå±‚ã€åŸºäºç»„æ’­ï¼ˆåä¸¤ç§ä¸é€‚åˆå±€åŸŸç½‘ï¼‰</p><p>é“¾è·¯ç±»å‹ï¼šè®¿é—®ï¼ˆAccessï¼‰ä¸å¹²è·¯ï¼ˆTrunkï¼‰ï¼ˆå¤šä¸ªVLANä¹‹é—´çš„é€šä¿¡ï¼‰</p><p>å¹²é“é“¾è·¯ä¸¤ç«¯ï¼Œè¾“å‡ºç«¯å£ä¼šå‰¥ç¦»VLANæ ‡ç­¾ï¼ŒåŸºäº802.1Qå¸§</p><p><img src="image-20231221190440290.png" /></p><p>å¦‚ä¸Šå›¾ï¼Œ802.1Qæ˜¯åŸºäº802.11å¸§çš„ï¼Œæ·»åŠ äº†Tagå­—æ®µï¼ŒPRIå­—æ®µè¡¨ç¤ºä¼˜å…ˆçº§</p>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç½‘ç»œç¬”è®°ï¼ˆäºŒï¼‰</title>
      <link href="/2023/11/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/"/>
      <url>/2023/11/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ç‰©ç†å±‚">2.1 ç‰©ç†å±‚</h2><p>ç‰©ç†å±‚çš„åè®®å¸¸è¢«ç§°ä¸ºè§„ç¨‹ï¼ˆprocedureï¼‰</p><p>æ•°å­—ä¿¡å·ç¦»æ•£ï¼Œæ¨¡æ‹Ÿä¿¡å·è¿ç»­</p><p>æ¯ç§’é’Ÿä¼ æ’­ç å…ƒçš„æ•°ç›®ç§°ä¸ºæ³¢ç‰¹ç‡</p><p>æ²¡æœ‰ç»è¿‡è°ƒåˆ¶ç§°ä¸ºåŸºå¸¦ä¿¡å·ï¼Œä»…å¯¹æ³¢å½¢è¿›è¡Œå˜æ¢ç§°ä¸ºåŸºå¸¦è°ƒåˆ¶ï¼Œä¹Ÿç§°ç¼–ç ï¼›ä½¿ç”¨è½½æ³¢è¿›è¡Œè°ƒåˆ¶ï¼ŒæŠŠåŸºå¸¦ä¿¡å·çš„é¢‘ç‡èŒƒå›´æ¬ç§»åˆ°è¾ƒé«˜çš„é¢‘æ®µï¼Œå¹¶è½¬æ¢ä¸ºæ¨¡æ‹Ÿä¿¡å·ç§°ä¸ºå¸¦é€šè°ƒåˆ¶</p><h3 id="ç¼–ç æ–¹å¼">ç¼–ç æ–¹å¼</h3><p>ä¸å½’é›¶åˆ¶ã€å½’é›¶åˆ¶ã€æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼ˆè‡ªåŒæ­¥ï¼‰ã€å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼ˆçº¿è·¯å¯ä»¥åæ¥ä½†æˆæœ¬é«˜ï¼‰</p><h3 id="å¸¦é€šè°ƒåˆ¶è°ƒå¹…è°ƒé¢‘è°ƒç›¸">å¸¦é€šè°ƒåˆ¶ï¼šè°ƒå¹…ã€è°ƒé¢‘ã€è°ƒç›¸</h3><h3 id="ä¿¡é“æœ€å¤§æ•°æ®é€Ÿç‡">ä¿¡é“æœ€å¤§æ•°æ®é€Ÿç‡</h3><p>å¥ˆæ°ï¼ˆæ— å™ªå£°æ¡ä»¶ï¼‰ï¼š$ C = 2Hlog_2LÂ b/s $</p><p>é¦™å†œï¼ˆæœ‰å™ªå£°æ¡ä»¶ï¼‰ï¼š$ C = Hlog_2(1+S/N)Â b/s $</p><p>H ä¸ºä¿¡é“å¸¦å®½ï¼ŒL ä¸ºç å…ƒç§ç±»æ•°ï¼ˆç›¸ä½ã€è°ƒåˆ¶æ–¹å¼ç­‰ä¸åŒè€Œä¸åŒï¼‰ï¼ŒSä¸ºä¿¡é“å†…æ‰€ä¼ ä¿¡å·çš„å¹³å‡åŠŸç‡ï¼ŒN ä¸ºä¿¡é“å†…éƒ¨çš„é«˜æ–¯å™ªå£°åŠŸç‡</p><p>åœ¨ç†æƒ³ä½é€šï¼ˆæ— å™ªå£°ï¼Œå¸¦å®½å—é™ï¼‰æ¡ä»¶ä¸‹ï¼Œä¸ºäº†é¿å…ç é—´ä¸²æ‰°ï¼Œæé™ç å…ƒä¼ è¾“é€Ÿç‡ä¸º2H</p><h3 id="ä¿¡å™ªæ¯”db-10-log_10sn">ä¿¡å™ªæ¯”ï¼ˆdBï¼‰= 10 $ log_{10}(S/N) $</h3><h2 id="ä¼ è¾“ä»‹è´¨ä¸å¤šè·¯å¤ç”¨">2.2 ä¼ è¾“ä»‹è´¨ä¸å¤šè·¯å¤ç”¨</h2><h3 id="æœ‰çº¿ä»‹è´¨">æœ‰çº¿ä»‹è´¨</h3><p>åŒç»çº¿ï¼šéå±è”½UTPã€å±è”½STPï¼ŒRJ45æ¥å£åˆ†ä¸ºT-568Aå’ŒT-568Bï¼ˆæœ€å¸¸è§æ¥çº¿çº¿åºï¼‰</p><p>å…‰çº¤ï¼šå•æ¨¡åŸç†ç»•å°„ã€å¤šæ¨¡åŸç†åå°„</p><p><img src="2.2-1.png" /></p><h3 id="æ— çº¿ä»‹è´¨">æ— çº¿ä»‹è´¨</h3><p><img src="2.2-2.png" /></p><h3 id="å¤šè·¯å¤ç”¨">å¤šè·¯å¤ç”¨</h3><p>æ—¶åˆ†å¤ç”¨TDMï¼ˆåŒæ­¥å¼‚æ­¥ï¼‰ã€é¢‘åˆ†å¤ç”¨FDMï¼ˆæ”¶éŸ³æœºï¼›æ³¢åˆ†å¤ç”¨å³å…‰çš„é¢‘åˆ†å¤ç”¨ï¼‰ã€ç åˆ†å¤ç”¨CDMï¼ˆè‡ªå·±å’Œè‡ªå·±å†…ç§¯1ï¼Œè‡ªå·±å’Œåç å†…ç§¯-1ï¼Œç«™ç‚¹ç å…ƒä¸ç ç‰‡å†…ç§¯1è¡¨ç¤ºå‘é€1ï¼Œå†…ç§¯-1è¡¨ç¤ºå‘é€0ï¼Œå†…ç§¯0è¡¨ç¤ºæœªå‘é€ï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç½‘ç»œç¬”è®°ï¼ˆä¸€ï¼‰</title>
      <link href="/2023/11/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/"/>
      <url>/2023/11/23/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯è®¡ç®—æœºç½‘ç»œ">1.1 ä»€ä¹ˆæ˜¯è®¡ç®—æœºç½‘ç»œ</h2><p>è®¡ç®—æœºç½‘ç»œæ˜¯<strong>é€šä¿¡æŠ€æœ¯</strong>ä¸<strong>è®¡ç®—æœºæŠ€æœ¯</strong>ç›¸ç»“åˆï¼Œå®ç°<strong>ä¿¡æ¯ä¼ è¾“</strong>å’Œ<strong>èµ„æºå…±äº«</strong>çš„ä¸€ç§ä¿¡æ¯ç³»ç»Ÿ</p><h2 id="è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„">1.2 è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„</h2><p>æœ‰æ— ç¡®è®¤å³å¯ä¸å¯é </p><h3 id="é¢å‘è¿æ¥çš„æœåŠ¡ç”µè¯">é¢å‘è¿æ¥çš„æœåŠ¡ï¼ˆç”µè¯ï¼‰ï¼š</h3><p>å¯é çš„æ¶ˆæ¯æµï¼šæŠ¥æ–‡ç³»åˆ—ã€ç½‘ä¸Šä¸‹è½½å®Œæ•´é¡µé¢</p><p>å¯é çš„å­—èŠ‚æµï¼šè¿œç¨‹ç™»å½•ã€ftpä¸‹è½½é€šè¿‡ç¼“å†²åŒºåˆ†æ‰¹ä¸‹è½½</p><p>ä¸å¯é çš„è¿æ¥ï¼šæ•°å­—åŒ–å£°éŸ³ï¼ˆè§†é¢‘ã€ç›´æ’­ï¼‰</p><h3 id="æ— è¿æ¥çš„æœåŠ¡é‚®æ”¿">æ— è¿æ¥çš„æœåŠ¡ï¼ˆé‚®æ”¿ï¼‰ï¼š</h3><p>ä¸å¯é çš„æ•°æ®æŠ¥ï¼šç”µå­å‡½ä»¶</p><p>æœ‰ç¡®è®¤çš„æ•°æ®æŠ¥ï¼šæŒ‚å·é‚®ä»¶ã€å¿«é€’</p><p>é—®ç­”ï¼šæ•°æ®æŸ¥è¯¢</p><h3 id="åè®®ä¸‰è¦ç´ è¯­æ³•è¯­ä¹‰åŒæ­¥">åè®®ä¸‰è¦ç´ ï¼šè¯­æ³•ã€è¯­ä¹‰ã€åŒæ­¥</h3><h2 id="osiå‚è€ƒæ¨¡å‹">1.3 OSIå‚è€ƒæ¨¡å‹</h2><p>æ ¹æ®è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰ï¼Œå°†å…¶åˆ†ä¸ºé€šä¿¡å­ç½‘ï¼ˆé€šä¿¡æŠ€æœ¯ï¼‰ä¸èµ„æºå­ç½‘ï¼ˆè®¡ç®—æœºæŠ€æœ¯ï¼‰</p><h3 id="é€šä¿¡å­ç½‘">é€šä¿¡å­ç½‘</h3><p>ç‰©ç†å±‚ï¼šæ¯”ç‰¹æµä¼ è¾“</p><p>æ•°æ®é“¾è·¯å±‚ï¼šè§„èŒƒç›¸é‚»èŠ‚ç‚¹çš„è½¬å‘</p><p>ç½‘ç»œå±‚ï¼šå¯»å€å’Œè·¯ç”±</p><h3 id="èµ„æºå­ç½‘">èµ„æºå­ç½‘</h3><p>ä¼ è¾“å±‚ï¼šå±è”½é€šä¿¡å­ç½‘ç»Ÿä¸€æ¥å£</p><p>ä¼šè¯å±‚ï¼šä¸åŒä¸šåŠ¡ä¹‹é—´çš„åŒæ­¥ã€æ¢å¤ä¼šè¯ä¸­æ–­å‰çŠ¶æ€</p><p>è¡¨ç¤ºå±‚ï¼šæ•°æ®æ ¼å¼è½¬æ¢ã€å‹ç¼©ã€åŠ å¯†</p><p>åº”ç”¨å±‚ï¼šä¸ç”¨æˆ·äº¤äº’ï¼ˆåˆ†é…IPåœ°å€ã€åŸŸåè§£æï¼‰</p><p><img src="1.3-1.png" /></p><p>æ•°æ®é“¾è·¯å±‚åˆ†ä¸ºé€»è¾‘é“¾è·¯æ§åˆ¶å­å±‚ä¸åª’ä½“è®¿é—®æ§åˆ¶å­å±‚ï¼ˆå·²å¼±åŒ–ï¼‰</p><p>ç½‘ç»œå±‚+ï¼šç½‘ç»œäº’è”ã€ä¸ºä¸Šå±‚æä¾›è™šè¿æ¥æˆ–æ•°æ®æŠ¥æœåŠ¡</p><p>è·¯ç”±ï¼š</p><p><img src="1.3-2.png" /></p><h3 id="è·¯ç”±ç®—æ³•">è·¯ç”±ç®—æ³•</h3><p>é™æ€ï¼šæ‰©æ•£æ³•ã€å›ºå®šè·¯ç”±é€‰æ‹©ã€éšæœºè·¯ç”±é€‰æ‹©ã€åŸºäºæµé‡çš„è·¯ç”±é€‰æ‹©</p><p>åŠ¨æ€ï¼šç‹¬ç«‹è·¯ç”±é€‰æ‹©ã€é›†ä¸­è·¯ç”±é€‰æ‹©ã€åˆ†å¸ƒå¼è·¯ç”±é€‰æ‹©</p><h3 id="ä¼ è¾“è´¨é‡æ§åˆ¶">ä¼ è¾“è´¨é‡æ§åˆ¶</h3><p>åˆ†ABCç±»ç½‘ç»œåˆ†åˆ«æä¾›ä¸åŒçº§åˆ«çš„æœåŠ¡</p><p>ç®€å•æ³•ã€åŸºæœ¬é”™è¯¯æ¢å¤ç±»ã€å¤šè·¯å¤ç”¨ç±»ã€é”™è¯¯æ¢å¤å’Œå¤šè·¯å¤ç”¨ç±»ã€é”™è¯¯æ£€æµ‹å’Œæ¢å¤ç±»</p><h3 id="ä¼šè¯å±‚">ä¼šè¯å±‚</h3><p>+æ´»åŠ¨ç®¡ç†ï¼Œæ˜¯ä¸€ä¸ªæ¦‚å¿µä¸Šçš„å±‚ï¼ŒåŠŸèƒ½å¾ˆå¼±ï¼Œå¾€å¾€åˆå¹¶äºä¼ è¾“å±‚æˆ–åº”ç”¨å±‚</p><h3 id="è¡¨ç¤ºå±‚">è¡¨ç¤ºå±‚</h3><p>ä¹Ÿæ˜¯ä¸€ä¸ªæ¦‚å¿µä¸Šçš„å±‚ï¼Œé€šå¸¸åœ¨åº”ç”¨å±‚å®ç°ï¼Œå®é™…ä¸Šçš„æ•°æ®åŠ å¯†åœ¨åº”ç”¨å±‚ï¼ˆåŠ å¯†å¯¹è±¡å…·ä½“ä¿¡æ¯å—ã€æ–‡ä»¶ï¼‰ã€ä¼ è¾“å±‚ï¼ˆé€šä¿¡è¿›ç¨‹ã€ä¼šè¯ï¼‰ã€ç½‘ç»œå±‚ï¼ˆä¸¤ä¸ªèŠ‚ç‚¹é—´æ‰€æœ‰é€šä¿¡ï¼‰ã€æ•°æ®é“¾è·¯å±‚å®ç°</p><h3 id="åº”ç”¨å±‚">åº”ç”¨å±‚</h3><p>+è·¯ç”±åè®®ï¼ˆéƒ¨åˆ†ï¼Œæ„å‘³ç€è·¯ç”±åè®®ä¸å…¨åœ¨ç½‘ç»œå±‚ï¼‰ï¼Œåˆ†ä¸ºä¸é€šä¿¡ç›¸å…³å’Œä¸é€šä¿¡æ— å…³ä¸¤ç§</p><h2 id="tcpipå‚è€ƒæ¨¡å‹">1.4 TCP/IPå‚è€ƒæ¨¡å‹</h2><p><img src="1.4-1.png" /></p><p><img src="1.4-2.png" /></p><h3 id="åº”ç”¨å±‚-1">åº”ç”¨å±‚</h3><p>æ‰€è°“å¥—æ¥å­—(Socket)ï¼Œå°±æ˜¯å¯¹ç½‘ç»œä¸­ä¸åŒä¸»æœºä¸Šçš„åº”ç”¨è¿›ç¨‹ä¹‹é—´è¿›è¡ŒåŒå‘é€šä¿¡çš„ç«¯ç‚¹çš„æŠ½è±¡ã€‚ä¸€ä¸ªå¥—æ¥å­—å°±æ˜¯ç½‘ç»œä¸Šè¿›ç¨‹é€šä¿¡çš„ä¸€ç«¯ï¼Œæä¾›äº†åº”ç”¨å±‚è¿›ç¨‹åˆ©ç”¨ç½‘ç»œåè®®äº¤æ¢æ•°æ®çš„æœºåˆ¶ã€‚<span class="math display">\[Socket\ =\ IP\ address\ +\ TCP\ or\ UDP\ port\]</span>ç«¯å£å·åˆ†ä¸ºæœåŠ¡å™¨ç«¯å£å·ä¸å®¢æˆ·ç«¯ç«¯å£å·ï¼ŒæœåŠ¡å™¨ç«¯å£å·å¾€å¾€æ˜¯çŸ¥åç«¯å£å·ï¼Œå¦‚80ç«¯å£æ˜¯TCPç«¯å£ï¼Œä¸ºhttpå¼€æ”¾ï¼›53ç«¯å£æ˜¯UDPç«¯å£ï¼Œä¸ºDNSæœåŠ¡å™¨å¼€æ”¾ã€‚å®¢æˆ·ç«¯ç«¯å£å·ä¸å›ºå®šï¼Œä»1024ä»¥ä¸Šéšæœºäº§ç”Ÿï¼Œå°äº1024çš„ç«¯å£è¢«çŸ¥åç«¯å£å ç”¨äº†ï¼Œå¦‚ä¸Šä¸Šé¢ä¸¤ä¸ª</p><h3 id="ä¼ è¾“å±‚">ä¼ è¾“å±‚</h3><p>å¤šæ’­æˆ–å¹¿æ’­é€šä¿¡åªèƒ½é€‰æ‹©UDPåè®®ï¼Œå› ä¸ºå®ƒæ˜¯æ— è¿æ¥çš„ï¼Œå•æ’­é€šä¿¡TCP/UDPéƒ½å¯</p><p>TCPå¤§æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæ˜¯å¯é çš„ï¼Œä¿è¯æ•°æ®æ­£ç¡®å®Œæ•´æ€§ï¼ŒUDPå°æ–‡ä»¶ï¼Œä¿¡é“åˆ©ç”¨ç‡é«˜ï¼Œå¿«é€Ÿå‘é€æ•°æ®</p><h3 id="ç½‘ç»œå±‚">ç½‘ç»œå±‚</h3><p>æ ¸å¿ƒIPåè®®ï¼ŒARPåè®®åœ¨é€»è¾‘åœ°å€ï¼ˆIPåœ°å€ï¼‰ä¸ç‰©ç†åœ°å€ï¼ˆç½‘å¡åœ°å€ï¼‰å»ºç«‹æ˜ å°„å…³ç³»ï¼ŒICMPåè®®è¿›è¡Œæ•…éšœå®šä½ä¸ç½‘ç»œä¸­ç®€å•çš„ç®¡ç†åŠŸèƒ½ï¼ŒIGMPåè®®æ”¯æŒåœ¨ç½‘ç»œä¸­çš„å¤šæ’­é€šä¿¡</p><h3 id="ç½‘ç»œæ¥å£å±‚">ç½‘ç»œæ¥å£å±‚</h3><p>æ²¡æœ‰æ˜ç¡®çš„çº¦æŸï¼ŒATMã€X.25ã€å¸§ä¸­ç»§ã€ä»¥å¤ªç½‘ã€FDDIç­‰æ”¯æŒIPåè®®çš„éƒ½å¯ä»¥æ¥å…¥è¿›æ¥</p><p><img src="1.4-3.png" /></p><p>å¸¸ç”¨è®¨è®ºçš„æ¨¡å‹ï¼šç‰©ç†å±‚ã€æ•°æ®é“¾è·¯å±‚ã€ç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€åº”ç”¨å±‚</p><h2 id="ç½‘ç»œæ€§èƒ½å‚æ•°">1.5 ç½‘ç»œæ€§èƒ½å‚æ•°</h2><p>å¸¦å®½ä¹Ÿå’Œé€Ÿç‡å•ä½ç›¸åŒ bit/sï¼Œååé‡æŒ‡çš„æ˜¯æœ‰æ•ˆæ•°æ®çš„é€Ÿç‡</p><p>æ—¶å»¶åˆ†ä¸ºå‘é€ï¼ˆå–å†³äºåˆ†ç»„é•¿åº¦ä¸é¢å®šé€Ÿç‡ï¼‰ã€ä¼ æ’­ï¼ˆå–å†³äºç‰©ç†è·ç¦»ã€ä»‹è´¨ï¼‰ã€å¤„ç†ï¼ˆä¸»æœºæˆ–è·¯ç”±å™¨å¤„ç†çš„è¿‡ç¨‹ï¼‰ã€æ’é˜Ÿã€æ¥å…¥ï¼ˆå–å†³äºä¿¡é“ä½¿ç”¨æƒï¼‰æ—¶å»¶ï¼Œ</p><p>æ—¶å»¶å¸¦å®½ç§¯=ä¼ æ’­æ—¶å»¶Ã—å¸¦å®½ï¼Œåˆç§°ä»¥bitä¸ºå•ä½çš„é“¾è·¯é•¿åº¦</p><p>æ—¶å»¶æŠ–åŠ¨ï¼šç”±äºæ•°æ®åˆ†ç»„äº¤æ¢ï¼Œæ‰€èµ°è·¯å¾„ä¸åŒæ—¶å»¶ä¸åŒï¼Œå…‹æœçš„æ–¹æ³•æ˜¯åˆ©ç”¨ç¼“å­˜ï¼Œä½†ä¼šå¢åŠ æ—¶å»¶ï¼ˆçœ‹è§†é¢‘å¼€åœ¨ç¼“å­˜åŠ è½½å°±æ˜¯è¿™ä¸ªé“ç†ï¼‰</p><p>å¾€è¿”æ—¶é—´ï¼ˆRTTï¼‰ï¼šä¹Ÿç§°pingæ—¶é—´ï¼Œå¯¹å®ç°å¯é é€šä¿¡éå¸¸é‡è¦ï¼Œç”¨äºè®¡ç®—é‡ä¼ æ—¶é—´ï¼Œç®—çŸ­äº†å¯èƒ½é€ æˆç½‘ç»œæ‹¥å¡ï¼Œç®—é•¿äº†å¯èƒ½å¯¼è‡´å¯é æ€§ä¸‹é™</p><p>ä¿¡é“åˆ©ç”¨ç‡ï¼šå‘é€æ–¹åœ¨ä¸€ä¸ªå‘é€å‘¨æœŸçš„æ—¶é—´å†…ï¼Œæœ‰æ•ˆçš„å‘é€æ•°æ®æ‰€éœ€è¦çš„æ—¶é—´å æ•´ä¸ªå‘é€å‘¨æœŸçš„æ¯”ç‡ï¼Œç½‘ç»œåˆ©ç”¨ç‡æ˜¯å…¨ç½‘ç»œçš„ä¿¡é“åˆ©ç”¨ç‡çš„åŠ æƒå¹³å‡å€¼<span class="math display">\[D=\frac{D_0}{1-U}\]</span> $ D_0 $ä¸ºç½‘ç»œç©ºé—²æ—¶çš„æ—¶å»¶ï¼ŒUæ˜¯ç½‘ç»œåˆ©ç”¨ç‡</p>]]></content>
      
      
      <categories>
          
          <category> è¯¾ç¨‹ç¬”è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2023.10æ ¡èµ›WP</title>
      <link href="/2023/11/08/%E6%A0%A1%E8%B5%9BWP/"/>
      <url>/2023/11/08/%E6%A0%A1%E8%B5%9BWP/</url>
      
        <content type="html"><![CDATA[<h1 id="misc">Misc</h1><h2 id="ä½ å¥½æ¥ç­¾åˆ°çš„æ—…è¡Œè€…">ä½ å¥½ï¼Œæ¥ç­¾åˆ°çš„æ—…è¡Œè€…</h2><p>å¾®ä¿¡å…¬ä¼—å·å‘é€flagè·å¾—</p><p><img src="EF5AD68201DA7EED949F8D3462390D18.jpg" /></p><h2 id="çº¯é»‘çš„å™©æ¢¦">çº¯é»‘çš„å™©æ¢¦</h2><p>docxæ–‡ä»¶æœ¬è´¨æ˜¯å‹ç¼©åŒ…ï¼Œæ”¹åç¼€ä¸º.zipæ‰“å¼€</p><p>åœ¨word-mediaä¸­å¯ä»¥æŸ¥çœ‹wordä¸­çš„å›¾ç‰‡æ–‡ä»¶</p><p><del>ç¬¬ä¸€å¼ å›¾ç‰‡æ˜¯å‡ºé¢˜äººå°é»‘å­è¯æ˜</del>ï¼Œç¬¬äºŒå¼ æ˜¯æ‰€æœ‰çš„é»‘å›¾ï¼Œç¬¬ä¸‰å¼ æ˜¯flag</p><p><img src="image3.png" /></p><h2 id="è¸©è¸©æˆ‘çš„å›¾">è¸©è¸©æˆ‘çš„å›¾</h2><p>é¦–å…ˆæ˜¯å›¾ç‰‡éšå†™é¢˜å¸¸è§æ€è·¯ï¼Œbinwalkä¸€ä¸‹ï¼Œå‘ç°é‡Œé¢æœç„¶æœ‰ç§˜å¯†</p><p><img src="7.png" /></p><p>æ ¹æ®é¢˜ç›®æ–‡ä»¶å¤¹åä¸æç¤ºï¼Œæœç´¢Picselå…³é”®è¯ï¼Œå‘ç°ç¬¦åˆâ€œåˆäºŒä¸ºä¸€â€â€œå†›ç”¨çº§åŠ å¯†â€çš„è½¯ä»¶ä¸º</p><p><strong>SSuite Picsel Security</strong>ï¼ˆä¸å¾—ä¸è¯´miscçš„æ¶‰çŒç¡®å®å¹¿</p><p>ä¸‹è½½è½¯ä»¶å¹¶åˆå¹¶ä¸¤å›¾ç‰‡å¾—åˆ°flag</p><p><img src="8.png" /></p><h2 id="ezpcapng">ezpcapng</h2><p>pcapngæ–‡ä»¶ï¼Œç”¨wiresharkæ‰“å¼€ï¼Œå‘ç°æ˜¾ç›®çš„GET /tmp/sql/sql4.php HTTP/1.1æ¡ç›®</p><p><img src="QQå›¾ç‰‡20231025000650.png" /></p><p>æ„è¯†åˆ°æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯sqlæ³¨å…¥ï¼Œå…ˆè¿‡æ»¤httpæ•°æ®åŒ…ï¼Œå‘ç°å¾ˆå¤šæ¡æ³¨å…¥è®°å½•ï¼Œè€ƒè™‘æ˜¯sqlç›²æ³¨</p><figure><img src="QQæˆªå›¾20231025001515.png" alt="QQæˆªå›¾20231025001515" /><figcaption aria-hidden="true">QQæˆªå›¾20231025001515</figcaption></figure><p>å‰é¢æ˜¯ä¸€äº›çŒœè§£åº“åã€è¡¨åç­‰çš„æ³¨å…¥ï¼Œæ‰¾åˆ°çŒœè§£flagçš„æ³¨å…¥èµ·ç‚¹</p><p><img src="123.png" /></p><p>ASCIIç å€¼ä¸º102çš„å­—ç¬¦ä¸ºfï¼Œå‘ä¸‹æ£€æŸ¥ï¼Œå››ä¸ªå­—ç¬¦ä¸ºflagï¼Œå°±æ˜¯è¿™é‡Œæ²¡é”™ï¼Œæ¥ç€å‘ä¸‹æŸ¥æ‰¾ï¼Œåˆ—å†™å‡ºæœ€ç»ˆflag</p><p>ï¼ˆå½“ç„¶æœ‰èƒ½åŠ›å¯ä»¥å†™ä¸ªè„šæœ¬ä¾æ¬¡æå–æ‰€æœ‰å­—ç¬¦ï¼Œæœ¬äººæ˜¯ä¸€ä¸ªä¸ªåˆ—å‡ºæ¥çš„</p><h1 id="crypto">Crypto</h1><h2 id="matryoshka-doll">Matryoshka-doll</h2><p>è®¿é—®å®ä¾‹å¾—åˆ°å­—ç¬¦ä¸²</p><p>LJCGG6SMLBXXQZLHOBYVSVDLPJGFQ2ZQJRLVCMCZPJJGUZSYNQ3U26S2NJMTG4DILFUTAMSNPJETEWSYNMYFSV2FGVGVCPJ5</p><p>åˆ†æsource.pyä»£ç é€»è¾‘</p><p><img src="1.png" /></p><p>å‡¯æ’’ç§»ä½ä½æ•°ä¸º1è‡³25çš„éšæœºæ•°ï¼Œæ …æ å®½åº¦ä¸º2è‡³10çš„éšæœºæ•°ï¼Œç„¶åæ˜¯base64åŠ å¯†ä¸base32åŠ å¯†</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ ¹æ®å‡½æ•°årail_fenceä¹Ÿå¯ä»¥æ³¨æ„åˆ°ï¼Œè¿™é‡Œçš„æ …æ å¯†ç æ˜¯Wå‹å˜ç§</p><p>äº†è§£ä»¥ä¸Šä¹‹åï¼Œé€šè¿‡åœ¨çº¿è§£å¯†ç½‘ç«™å¯ä»¥è§£å‡ºbase64åŠ å¯†å‰å­—ç¬¦ä¸²</p><p>d73-z1zja93-y4-d4c4c}y{36cczab-6326ey4aa91</p><p>æšä¸¾è§£å¯†æ …æ </p><p><img src="2.png" /></p><p>æ‰¾åˆ°ç¬¦åˆXXXX{XXXXXXXÂ·Â·Â·}æ ¼å¼çš„å¯†æ–‡ï¼Œå†Caeseræšä¸¾å¾—åˆ°flag</p><p><img src="3.png" /></p><p>ï¼ˆåæ§½ä¸€ä¸‹å‡ºé¢˜äººå†™çš„è„šæœ¬</p><p><img src="XYGLRPHNK3@TJ4%7D6ZV%60%7BYSC.png" /></p><h1 id="pwn">Pwn</h1><h2 id="ç­¾åˆ°">ç­¾åˆ°</h2><p>æ ¹æ®è¦æ±‚ï¼Œåœ¨linuxç¯å¢ƒä¸‹nc ctf.qwq.cc ç«¯å£å·å³å¯è·å¾—flag</p><h2 id="çº¢åŒ…é¢˜1024">çº¢åŒ…é¢˜ï¼1024ï¼</h2><p>æœ¬äºº<del>ä¸æ€ä¹ˆä¼š</del>æ ¹æœ¬ä¸ä¼špwnï¼ŒæŠŠ1024å®Œæˆäº†è·å¾—shell</p><p>lsä¸‹å‘ç°flag</p><p>cat flagæŸ¥çœ‹flagå†…å®¹</p><h1 id="web">Web</h1><h2 id="checkin">checkin</h2><p>è®¿é—®å®ä¾‹ï¼Œ<del>æœç„¶åˆæ˜¯åŸç¥</del>ï¼Œè™½ç„¶ä¸æ˜¯webæ‰‹ï¼Œä½†ä¹ŸçŸ¥é“webæ‰‹çš„æ ¸å¿ƒè¦ä¹‰æ˜¯ç½‘é¡µæºä»£ç </p><p>F12å‘ç°å¼€å‘è€…å·¥å…·å¿«æ·é”®è¢«banäº†ï¼Œå³é”®å‘ç°ä¹Ÿè¢«banäº†</p><p>è¿˜å¥½è¿˜æœ‰ä¸€æ‹›ï¼Œåœ¨ç½‘å€å‰æ·»åŠ view-source:æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°flag</p><figure><img src="QQå›¾ç‰‡20231025010640.png" alt="QQå›¾ç‰‡20231025010640" /><figcaption aria-hidden="true">QQå›¾ç‰‡20231025010640</figcaption></figure><h2 id="ezphp">ezphp</h2><p>ä»£ç å®¡è®¡</p><p><img src="QQå›¾ç‰‡20231025011102.png" /></p><p>å‘ç°å¯ä»¥æ•°ç»„ç»•è¿‡md5éªŒè¯ï¼Œé€šè¿‡Filterä¼ªåè®®è¯»å–æºç </p><p>éœ€è¦æ³¨æ„è¯»å–å½¢å¼é€‰æ‹©base64ç¼–ç ï¼Œå¦åˆ™æ ¹æ®if(strstr($res,"flag"))die("DaMie!")ä¼šæ— æ³•æ­£å¸¸å›æ˜¾flag</p><p>ç½‘å€åè¡¥å……ï¼š</p><p>&amp;username[]=0&amp;password[]=1&amp;url=php://filter/read=convert.base64-encode/resource=&amp;target=/../../../../flag</p><p>å¾—åˆ°æºç ï¼ˆbase64ç¼–ç åï¼‰</p><p><img src="QQå›¾ç‰‡20231025012331.png" /></p><p>base64è§£ç å¾—åˆ°flag</p><h1 id="reverse">Reverse</h1><h2 id="check_in">321check_in</h2><p>ä¸‹è½½é™„ä»¶æ‰“å¼€ï¼Œå‘ç°.exeæ–‡ä»¶ç”šè‡³æ²¡æœ‰åŠæ³•è¿è¡Œï¼Œå‡ºç°é—ªé€€çš„æƒ…å†µ</p><p>ç»“åˆé¢˜ç›®æç¤ºï¼ŒæŸ¥å£³å‘ç°ï¼Œ.exeæ–‡ä»¶åº”è¯¥æ˜¯ç”¨exe4jæ‰“åŒ…çš„</p><p><img src="11.png" /></p><p>ä¸‹è½½exe4jæ­£å¸¸è¿è¡Œç¨‹åºï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸€å®šè¦æ­£å¸¸è¿è¡Œç¨‹åºå‘¢ï¼Ÿ</p><p>å› ä¸ºjavaåç¼–è¯‘çš„å·¥å…·ä¸èƒ½ç›´æ¥åç¼–è¯‘exeæ–‡ä»¶ï¼Œéœ€è¦å¾—åˆ°classæ–‡ä»¶æˆ–è€…jaråŒ…</p><p>è€Œé€šè¿‡exe4jæ‰“åŒ…çš„exeç¨‹åºåœ¨exeè¿è¡Œæ—¶ä¼šåœ¨...jarçš„ç¼“å­˜æ–‡ä»¶</p><p>ï¼ˆè™½ç„¶ä½†æ˜¯ï¼Œæˆ‘å¹¶æ²¡æœ‰æ‰¾åˆ°attachment.jar</p><p>ä½†æ˜¯æ ¹æ®æ–‡ä»¶ç”Ÿæˆæ—¶é—´ï¼Œåœ¨e4jD82C.tmp_dir1698213950æ–‡ä»¶å¤¹ä¸‹æ‰¾åˆ°äº†readme.jar</p><p><img src="12.png" /></p><p>ç”¨jd-guiåç¼–è¯‘readme.jarï¼Œåœ¨ä¸»å‡½æ•°ä¸­å‘ç°flag</p><p><img src="13.png" /></p><h2 id="babyida">babyida</h2><p>æŸ¥å£³ï¼Œæ— å£³32ä½ç¨‹åºï¼Œida32æ‰“å¼€ï¼Œç»“åˆé¢˜ç›®æç¤ºï¼Œåœ¨å­—ç¬¦ä¸²çª—å£ä¸­æŸ¥æ‰¾flagï¼Œå‘ç°ä¸€ä¸ªå‡çš„flag</p><p><img src="14.png" /></p><p>é¢˜ç›®æç¤ºå­¦ä¸‹åŠ¨è°ƒç§’äº†ï¼Œäºæ˜¯åŠ¨æ€è°ƒè¯•çœ‹çœ‹ï¼Œç”¨x32dbgæ‰“å¼€ï¼Œæ‰¾åˆ°Can youfind the flag?å…³é”®å­—ç¬¦ä¸²å¤„</p><p><img src="15.png" /></p><p>å…¶å®è¿™ä¸ªåœ°æ–¹ä¸‹é¢å·²ç»çœ‹åˆ°flagäº†ï¼Œä½†åˆ«ç›´æ¥åˆ—å†™å½“flagäº†ï¼Œè¿˜æ˜¯å¾—åŠ¨è°ƒä¸€ä¸‹ï¼ˆåˆ«é—®æˆ‘æ€ä¹ˆçŸ¥é“çš„</p><p>æ¥ç€å¾€ä¸‹åˆ†æï¼Œåœ¨00A21467å¤„å‘ç°å…³é”®åˆ¤æ–­è¯­å¥ jne babyida.A2147B</p><p><img src="16.png" /></p><p>è¯´æ˜è‹¥ä¸Šä¸€å¥cmpçš„ç»“æœä¸ºä¸ç›¸ç­‰ï¼Œä¼šè·³è½¬è‡³00A2147Bï¼Œè¾“å‡ºâ€œwrong!â€</p><p>æ ¹æ®ä¸Šé¢ä¸€å¤§å †çš„æ±‡ç¼–æŒ‡ä»¤å¤§è‡´å¯ä»¥çœ‹åˆ°ï¼Œè¿›è¡Œæ¯”è¾ƒçš„å­—ç¬¦ä¸²ï¼ˆå³ç›®æ ‡flagï¼‰å­˜å‚¨åœ¨å‡ ä¸ªå¯„å­˜å™¨ä¸­</p><p>ç›´æ¥åœ¨00A2147Bå¤„æ·»åŠ æ–­ç‚¹ï¼Œè®©ç¨‹åºè¿è¡Œåˆ°è¿™å…ˆåˆ«è·³è½¬ï¼Œç„¶åæŸ¥çœ‹å¯„å­˜å™¨çš„å€¼</p><p>è¿è¡Œç¨‹åºï¼ŒF9ç¨‹åºåœåœ¨00A2147Bå¤„ï¼Œåœ¨eaxä¸­å‘ç°flagå€¼</p><p><img src="17.png" /></p><p>ï¼ˆä¸€ç‚¹ä¹Ÿä¸baby</p><h2 id="ez_z3">ez_z3</h2><p>æŸ¥å£³ï¼Œ64ä½UPXå£³ï¼Œupx -dè„±å£³ï¼Œå‘ç°å±…ç„¶æŠ¥é”™äº†</p><p><img src="QQå›¾ç‰‡20231025152958.png" /></p><p>é¢å‘æœç´¢å¼•æ“ï¼Œå‘ç°æ˜¯æ–‡ä»¶åŠ å£³ä¹‹ååˆè¿›è¡Œäº†æ··æ·†ï¼Œå‘ç°ç¡®å®å¦‚æ­¤ï¼ŒåŒºæ®µåè¿›è¡Œäº†æ›´æ”¹</p><p><img src="18.png" /></p><p>äºæ˜¯010editoræ‰“å¼€æ–‡ä»¶ï¼ŒæŠŠæ–‡ä»¶é‡Œçš„XYUå…¨éƒ¨æ”¹æˆUPXï¼Œå†upx-dï¼Œè„±å£³æˆåŠŸ</p><p><img src="QQå›¾ç‰‡20231025161939.png" /></p><p>æ‹–å…¥idaæŸ¥çœ‹ï¼Œåˆ†æå„å‡½æ•°çš„å¤§è‡´ä½œç”¨ï¼Œç„¶åå¯ä»¥å…ˆç”¨z3çº¦æŸæ±‚è§£å™¨è§£å‡ºæ•°æ®ï¼Œè„šæœ¬å¦‚ä¸‹</p><p>è„šæœ¬åŸæ–‡é“¾æ¥ï¼š<ahref="https://ctttttttt.github.io/2023/03/26/57/#åˆ†æ">NSSCTF-RoundXeasy_z3 | é€†å‘ä¸Šåˆ†ä¹‹è·¯ (ctttttttt.github.io)</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a1 = [BitVec(<span class="string">&quot;num[%d]&quot;</span> % i, <span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">s = Solver()</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">    + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">    + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">    + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">    + <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">    + <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">    + a1[<span class="number">0</span>]</span><br><span class="line">+ <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">- <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">- <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">- <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">+ <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">- <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">- <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">- <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">- <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">- <span class="number">18</span> * a1[<span class="number">17</span>] == <span class="number">2582239</span>)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">    + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">    + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">    + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">    + <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">    - <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">    + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">    - <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">    + <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">    + <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">    + <span class="number">2</span> * a1[<span class="number">1</span>] * a1[<span class="number">0</span>]</span><br><span class="line">    - <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">    - <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">    - <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">    - (<span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">       + <span class="number">17</span> * a1[<span class="number">16</span>]) == <span class="number">2602741</span>)</span><br><span class="line">s.add(<span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">14</span> * a1[<span class="number">13</span>] * <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * a1[<span class="number">11</span>] * <span class="number">11</span> * a1[<span class="number">10</span>]</span><br><span class="line">     + <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">7</span> * a1[<span class="number">6</span>] * <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">4</span> * a1[<span class="number">3</span>] * <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>] * <span class="number">16</span> * a1[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">20</span> * a1[<span class="number">19</span>] == <span class="number">2668123</span>)</span><br><span class="line">s.add(<span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + (<span class="number">13</span> * a1[<span class="number">12</span>] + <span class="number">11</span> * a1[<span class="number">10</span>] - <span class="number">12</span> * a1[<span class="number">11</span>]) * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>] == <span class="number">2520193</span>)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">    + <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">    + <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">    + <span class="number">13</span> * a1[<span class="number">12</span>] * <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">    + <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">    + <span class="number">9</span> * a1[<span class="number">8</span>] * <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">    + <span class="number">3</span> * a1[<span class="number">2</span>] * <span class="number">2</span> * a1[<span class="number">1</span>] * a1[<span class="number">0</span>]</span><br><span class="line">    - <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">    - <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">    - <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">    - <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">    - <span class="number">11</span> * a1[<span class="number">10</span>]</span><br><span class="line">    - <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">    - <span class="number">16</span> * a1[<span class="number">15</span>]</span><br><span class="line">    - <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">    - <span class="number">20</span> * a1[<span class="number">19</span>] == <span class="number">8904587</span>)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">    + <span class="number">7</span> * a1[<span class="number">6</span>] * <span class="number">30</span> * a1[<span class="number">5</span>] * <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">    + <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">    + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">    + a1[<span class="number">0</span>]</span><br><span class="line">- <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">- <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">- <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">- <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">- <span class="number">16</span> * a1[<span class="number">15</span>] * (<span class="number">13</span> * a1[<span class="number">12</span>] + <span class="number">12</span> * a1[<span class="number">11</span>] - <span class="number">14</span> * a1[<span class="number">13</span>] - <span class="number">15</span> * a1[<span class="number">14</span>])</span><br><span class="line">- <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">- <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">- <span class="number">20</span> * a1[<span class="number">19</span>] == <span class="number">1227620874</span>)</span><br><span class="line">s.add(<span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * a1[<span class="number">11</span>] * <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * a1[<span class="number">6</span>] * <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>] == <span class="number">1836606059</span>)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">    + <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">    + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">    + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">    + <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">    + <span class="number">7</span> * a1[<span class="number">6</span>] * <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">    + <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">    + <span class="number">2</span> * a1[<span class="number">1</span>] * a1[<span class="number">0</span>]</span><br><span class="line">    - <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">    + <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">    + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">    - <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">    - <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">    - <span class="number">11</span> * a1[<span class="number">10</span>]</span><br><span class="line">    - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">    - <span class="number">18</span> * a1[<span class="number">17</span>] == <span class="number">8720560</span>)</span><br><span class="line">s.add(<span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * a1[<span class="number">10</span>] * (<span class="number">10</span> * a1[<span class="number">9</span>] + <span class="number">30</span> * a1[<span class="number">5</span>] + <span class="number">5</span> * a1[<span class="number">4</span>] + <span class="number">4</span> * a1[<span class="number">3</span>] - <span class="number">7</span> * a1[<span class="number">6</span>] + <span class="number">8</span> * a1[<span class="number">7</span>] - <span class="number">9</span> * a1[<span class="number">8</span>])</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     - (<span class="number">16</span> * a1[<span class="number">15</span>] - <span class="number">17</span> * a1[<span class="number">16</span>] - <span class="number">18</span> * a1[<span class="number">17</span>]) * <span class="number">15</span> * a1[<span class="number">14</span>] == <span class="number">11387045</span>)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">    + <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">    + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">    + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">    + <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">    + <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">    + a1[<span class="number">0</span>]</span><br><span class="line">- <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">+ <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">- <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">- <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">- <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">+ <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">- <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">- <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">- <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">- <span class="number">18</span> * a1[<span class="number">17</span>] == <span class="number">7660269</span>)</span><br><span class="line">s.add(<span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     - (<span class="number">4</span> * a1[<span class="number">3</span>] * <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">      - <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">      - <span class="number">30</span> * a1[<span class="number">5</span>])</span><br><span class="line">     - <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>] == <span class="number">2461883</span>)</span><br><span class="line">s.add(</span><br><span class="line">    <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">    + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">    + <span class="number">9</span> * a1[<span class="number">8</span>] * <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">    + <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">    + <span class="number">2</span> * a1[<span class="number">1</span>] * a1[<span class="number">0</span>]</span><br><span class="line">    - <span class="number">4</span> * a1[<span class="number">3</span>] * <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">    - <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">    - <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">    - <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">    - <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">    - <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">    - <span class="number">17</span> * a1[<span class="number">16</span>] * <span class="number">16</span> * a1[<span class="number">15</span>]</span><br><span class="line">    - <span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">    - <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">    - <span class="number">20</span> * a1[<span class="number">19</span>] == -<span class="number">966296</span>)</span><br><span class="line"></span><br><span class="line">s.add(</span><br><span class="line"><span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     + (<span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>] + <span class="number">30</span> * a1[<span class="number">5</span>] + <span class="number">5</span> * a1[<span class="number">4</span>] + <span class="number">3</span> * a1[<span class="number">2</span>] + <span class="number">4</span> * a1[<span class="number">3</span>] - <span class="number">7</span> * a1[<span class="number">6</span>] + <span class="number">8</span> * a1[<span class="number">7</span>] - <span class="number">9</span> * a1[<span class="number">8</span>])</span><br><span class="line">     * <span class="number">2</span></span><br><span class="line">     * a1[<span class="number">1</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">16</span> * a1[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">     - <span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>] == <span class="number">254500223</span></span><br><span class="line">    )</span><br><span class="line">s.add(</span><br><span class="line"><span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * a1[<span class="number">6</span>] * <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">     - <span class="number">5</span> * a1[<span class="number">4</span>] * <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">     + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">     - <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * a1[<span class="number">19</span>] == <span class="number">6022286</span></span><br><span class="line">    )</span><br><span class="line">s.add(</span><br><span class="line"><span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">16</span> * a1[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">4</span> * a1[<span class="number">3</span>] * <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">2</span> * a1[<span class="number">1</span>] * a1[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">9</span> * a1[<span class="number">8</span>] * <span class="number">8</span> * a1[<span class="number">7</span>] * <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">     - <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     - <span class="number">20</span> * a1[<span class="number">19</span>] == -<span class="number">636956022</span></span><br><span class="line">    )</span><br><span class="line">s.add(</span><br><span class="line"><span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     + <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">3</span> * a1[<span class="number">2</span>] * <span class="number">2</span> * a1[<span class="number">1</span>] * a1[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">9</span> * a1[<span class="number">8</span>] * <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">16</span> * a1[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>] == <span class="number">10631829</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line"><span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">16</span> * a1[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">15</span> * a1[<span class="number">14</span>] * <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">11</span> * a1[<span class="number">10</span>] * <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     - <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">     + (<span class="number">4</span> * a1[<span class="number">3</span>] - <span class="number">5</span> * a1[<span class="number">4</span>] - <span class="number">30</span> * a1[<span class="number">5</span>]) * <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">9</span> * a1[<span class="number">8</span>] == <span class="number">6191333</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line"><span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     + <span class="number">10</span> * a1[<span class="number">9</span>] * <span class="number">9</span> * a1[<span class="number">8</span>] * <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     + <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">4</span> * a1[<span class="number">3</span>] * <span class="number">3</span> * a1[<span class="number">2</span>]</span><br><span class="line">     + <span class="number">2</span> * a1[<span class="number">1</span>] * a1[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">7</span> * a1[<span class="number">6</span>] * <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">11</span> * a1[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">13</span> * a1[<span class="number">12</span>] * <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     - <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>] * <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>] == <span class="number">890415359</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line"><span class="number">20</span> * a1[<span class="number">19</span>]</span><br><span class="line">     + <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">18</span> * a1[<span class="number">17</span>]</span><br><span class="line">     + <span class="number">16</span> * a1[<span class="number">15</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     + <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">11</span> * a1[<span class="number">10</span>]</span><br><span class="line">     + <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">     + <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     + <span class="number">4</span> * a1[<span class="number">3</span>] * <span class="number">3</span> * a1[<span class="number">2</span>] * <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     - <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">     - <span class="number">7</span> * a1[<span class="number">6</span>]</span><br><span class="line">     + <span class="number">8</span> * a1[<span class="number">7</span>]</span><br><span class="line">     - <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     - <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">15</span> * a1[<span class="number">14</span>] == <span class="number">23493664</span></span><br><span class="line">)</span><br><span class="line">s.add(</span><br><span class="line"><span class="number">20</span> * a1[<span class="number">19</span>] * <span class="number">19</span> * a1[<span class="number">18</span>]</span><br><span class="line">     + <span class="number">13</span> * a1[<span class="number">12</span>]</span><br><span class="line">     + <span class="number">12</span> * a1[<span class="number">11</span>]</span><br><span class="line">     + <span class="number">10</span> * a1[<span class="number">9</span>]</span><br><span class="line">     + <span class="number">3</span> * a1[<span class="number">2</span>] * <span class="number">2</span> * a1[<span class="number">1</span>]</span><br><span class="line">     + a1[<span class="number">0</span>]</span><br><span class="line">     - <span class="number">4</span> * a1[<span class="number">3</span>]</span><br><span class="line">     - <span class="number">5</span> * a1[<span class="number">4</span>]</span><br><span class="line">     + <span class="number">8</span> * a1[<span class="number">7</span>] * <span class="number">7</span> * a1[<span class="number">6</span>] * <span class="number">30</span> * a1[<span class="number">5</span>]</span><br><span class="line">     - <span class="number">9</span> * a1[<span class="number">8</span>]</span><br><span class="line">     - <span class="number">11</span> * a1[<span class="number">10</span>]</span><br><span class="line">     - <span class="number">14</span> * a1[<span class="number">13</span>]</span><br><span class="line">     - <span class="number">16</span> * a1[<span class="number">15</span>] * <span class="number">15</span> * a1[<span class="number">14</span>]</span><br><span class="line">     - <span class="number">17</span> * a1[<span class="number">16</span>]</span><br><span class="line">     - <span class="number">18</span> * a1[<span class="number">17</span>] == <span class="number">1967260144</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a1:</span><br><span class="line">    <span class="built_in">print</span>(s.model()[i].as_long(), end=<span class="string">&quot;,&quot;</span>)</span><br><span class="line"><span class="comment">#è·‘å‡ºæ¥çš„ç»“æœæ˜¯[104,97,104,97,104,97,116,104,105,115,105,115,102,97,99,107,102,108,97,103]</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°å‚æ•°ï¼Œå†™è„šæœ¬å¾—åˆ°flag</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">DWORD <span class="title function_">Get_254D0</span><span class="params">(DWORD d254D0[<span class="number">20</span>])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">DWORD d25050[<span class="number">20</span>] = &#123;<span class="number">0X1207</span>,<span class="number">0X4CA0</span>,<span class="number">0X4F21</span>,<span class="number">0X39</span>,<span class="number">0X1A523</span>,<span class="number">0X23A</span>,<span class="number">0X926</span>,<span class="number">0X4CA7</span>,</span><br><span class="line"><span class="number">0X6560</span>,<span class="number">0X36</span>,<span class="number">0X1A99B</span>,<span class="number">0X4CA8</span>,<span class="number">0X1BBE0</span>,<span class="number">0X3705</span>,<span class="number">0X926</span>,<span class="number">0X77D3</span>,</span><br><span class="line"><span class="number">0X9A98</span>,<span class="number">0X657B</span>,<span class="number">0X18</span>,<span class="number">0X0B11</span>&#125;;</span><br><span class="line"><span class="keyword">for</span>( i ; i &lt; <span class="number">20</span> ; i++)</span><br><span class="line">&#123;</span><br><span class="line">d254D0[i] = d25050[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DWORD <span class="title function_">Get_25520</span><span class="params">(DWORD d25520[<span class="number">20</span>], DWORD d254D0[<span class="number">20</span>],DWORD a[<span class="number">20</span>])</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> ( <span class="type">int</span> i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="type">int</span> v2 = i;</span><br><span class="line">    <span class="keyword">if</span> ( v2 &gt;= <span class="number">20</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">   <span class="type">int</span> v3 = i;</span><br><span class="line">    d25520[v3] = *(a + <span class="number">20</span> - i - <span class="number">1</span>) ^ d254D0[i]; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">DWORD <span class="title function_">sub_1124E</span><span class="params">(DWORD a1, DWORD a2)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> v3; </span><br><span class="line">  v3 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> ( a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (a2 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">      v3 *= a1;</span><br><span class="line">    a1 = a1 * a1 % <span class="number">1000</span>;</span><br><span class="line">    a2 &gt;&gt;= <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">DWORD a[<span class="number">20</span>] = &#123;<span class="number">104</span>,<span class="number">97</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">104</span>,<span class="number">97</span>,<span class="number">116</span>,<span class="number">104</span>,<span class="number">105</span>,<span class="number">115</span>,<span class="number">105</span>,<span class="number">115</span>,<span class="number">102</span>,<span class="number">97</span>,<span class="number">99</span>,<span class="number">107</span>,<span class="number">102</span>,<span class="number">108</span>,<span class="number">97</span>,<span class="number">103</span>&#125;;</span><br><span class="line">DWORD d254D0[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">DWORD d25520[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">DWORD d25000[<span class="number">20</span>] = &#123; <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x09</span>, <span class="number">0x05</span>, <span class="number">0x06</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, </span><br><span class="line"> <span class="number">0x09</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x05</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x07</span>, <span class="number">0x05</span>, <span class="number">0x07</span>,</span><br><span class="line"> <span class="number">0x09</span>, <span class="number">0x07</span>&#125;;</span><br><span class="line">DWORD Str[<span class="number">20</span>];</span><br><span class="line">DWORD v3;</span><br><span class="line"></span><br><span class="line">Get_254D0(d254D0);</span><br><span class="line">Get_25520(d25520,d254D0,a);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿™é‡Œç”¨çš„æ˜¯çˆ†ç ´çš„æ–¹æ³•</span></span><br><span class="line"><span class="keyword">for</span>(DWORD p = <span class="number">0</span> ; p &lt; <span class="number">20</span> ; p++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>( DWORD k = <span class="number">0</span> ; k &lt; <span class="number">127</span> ; k++)</span><br><span class="line">&#123;</span><br><span class="line">Str[p] = k;</span><br><span class="line"><span class="keyword">if</span>( d25520[p] == sub_1124E(Str[p], d25000[p]) )</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,k);</span><br><span class="line"><span class="keyword">break</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//T1e_z3_1s_v1r9_3asy!</span></span><br></pre></td></tr></table></figure><h2 id="base64">base64</h2><p>ida64æ‰“å¼€ï¼Œä¸€çœ¼çœ‹å»åƒæ˜¯base64ç¼–ç æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä½†ç›´æ¥base64è§£ç æ˜¾ç„¶ä¸è¡Œ</p><p><img src="5.png" /></p><p>é¢˜ç›®æç¤ºéœ€è¦ä¿®å¤base64ç¼–ç ï¼Œè¿˜éœ€è¦è¿è¡Œlinuxå‘½ä»¤</p><p>ä½†å¹¸è¿çš„äº‹å‘ç”Ÿäº†ï¼</p><p>åšreé¢˜çš„ä¹ æƒ¯æ€§åšæ³•ï¼Œå…ˆæŸ¥çœ‹å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œç›´æ¥å‘ç°äº†...</p><p><img src="4.png" /></p><p>è¿™ä¸ªå°±æ˜¯base64æ›¿æ¢çš„æ–°è¡¨ï¼Œä¸Šè„šæœ¬ï¼Œè¿è¡Œå¾—åˆ°flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;ZXFWtmKgDZCyrmC5B+CiVfsyXUCQVfsyZRFzDU4yX2YCD/F5Ih8=&quot;</span></span><br><span class="line"></span><br><span class="line">string1 = <span class="string">&quot;QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbn/+m1234567890&quot;</span></span><br><span class="line">string2 = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(str1.translate(<span class="built_in">str</span>.maketrans(string1,string2))))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="A.png" /></p><h2 id="odscript">odscript</h2><p>æŸ¥å£³ï¼Œ32ä½æ— å£³ï¼Œè¿è¡Œä¸€ä¸‹å‘ç°æ˜¯å¼¹çª—è¾“å…¥æ³¨å†Œç ï¼Œéšä¾¿è¾“æç¤ºæœ‰é”™è¯¯ï¼Œ<del>ç„¶åå†è¯»è¯»æ›¹æ“èº«è¾¹çš„æ•…äº‹</del></p><p>è¾“å…¥æ³¨å†Œç ï¼Œæ˜¾ç¤ºç»“æœéƒ½æ˜¯ä»¥å¼¹çª—çš„å½¢å¼ï¼Œå¯ä»¥å°è¯•å»å¯»æ‰¾Messageboxå‡½æ•°</p><p>idaæ‰“å¼€ï¼Œå‘ç°sub_4016E0å’Œsub_401720ä¸­éƒ½æœ‰è°ƒç”¨Messageboxå‡½æ•°</p><p><img src="QQå›¾ç‰‡20231025202407.png" /></p><p>å¯ä»¥åˆç†çŒœæµ‹æ˜¯ä¸¤ä¸ªç»“æœçš„å¼¹çª—ï¼Œä¸€ä¸ªæ˜¯æ˜¾ç¤ºæ­£ç¡®ï¼Œä¸€ä¸ªæ˜¯æ˜¾ç¤ºé”™è¯¯</p><p>åœ¨x32dbgé‡Œè¿™ä¸¤å¤„éƒ½ä¸‹æ–­ç‚¹ï¼Œéšæœºè¾“å…¥æ³¨å†Œç ï¼Œå‘ç°ç¨‹åºåœåœ¨sub_401720å¤„ï¼Œæ— å¼¹çª—ï¼Œå†F9å‡ºç°é”™è¯¯å¼¹çª—ï¼Œç¡®å®šæƒ³æ³•æ˜¯å¯¹çš„</p><p>äºæ˜¯çœ‹sub_4016E0ï¼Œé€šè¿‡IDAäº¤å‰å¼•ç”¨çœ‹åˆ°ï¼Œ.text:00401617å¼•ç”¨äº†è¯¥å‡½æ•°</p><p>æ¥åˆ°.text:00401617</p><p><img src="QQæˆªå›¾20231025205445.png" /></p><p>çœ‹åˆ°ä¸€äº›å…³é”®å‡½æ•°</p><p><img src="QQæˆªå›¾20231025205708.png" /></p><p>è·Ÿè¿›ï¼Œå‘ç°æ˜¯æ­£æ˜¯sub_401630è°ƒç”¨äº†CString::CStringå‡½æ•°</p><p><img src="QQæˆªå›¾20231025210102.png" /></p><p>é˜…è¯»ä»£ç ï¼Œå¤§è‡´æ„æ€æ˜¯åˆ¤æ–­a2æŒ‡å‘çš„ä¸€æ®µå†…å­˜å’ŒthisæŒ‡å‘çš„ä¸€æ®µå†…å­˜æ˜¯å¦ç›¸ç­‰</p><p>é‚£ä¹ˆè°ƒè¯•æ—¶åœåœ¨sub_401630å¤„F7å•æ­¥å³å¯æŸ¥çœ‹é‡Œé¢çš„å†…å®¹</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†</p><p>ä¸Šé¢è¯•è¿‡ï¼Œéšä¾¿è¾“çš„æ³¨å†Œç ï¼Œå³ä½¿åœ¨sub_401630å¤„æ·»åŠ äº†æ–­ç‚¹ï¼ŒF9ä¹Ÿæ˜¯åœåœ¨sub_401720å¤„</p><p>è¯´æ˜ä¸Šæ–¹è¿˜æœ‰è·³è½¬ï¼Œç›´æ¥è·³è¿‡sub_401630èµ·çš„æ­£ç¡®å¼¹çª—åŒºåŸŸï¼Œè·³åˆ°sub_401720é”™è¯¯å¼¹çª—å»äº†</p><p>å‘ä¸ŠæŸ¥çœ‹ï¼Œæœç„¶æœ‰é—®é¢˜</p><p><img src="QQæˆªå›¾20231025212258.png" /></p><p>é˜…è¯»æœ€ä¸Šé¢çº¢æ¡†å†…å®¹ï¼ŒçŸ¥é“éœ€è¦æ»¡è¶³è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦ä¸º0x21ï¼Œå³33ä¸ªå­—ç¬¦</p><p>å¾—åˆ°ä»¥ä¸Šä¿¡æ¯ï¼Œå°±å¯ä»¥å¼€å§‹è°ƒè¯•äº†ï¼Œx32dbgæ‰“å¼€</p><p>åœ¨00401630å¤„è®¾ç½®æ–­ç‚¹ï¼ŒF9ï¼Œè¾“å…¥éšæœºçš„é•¿åº¦ä¸º33å­—ç¬¦çš„å­—ç¬¦ä¸²</p><p>ç¨‹åºåœåœ¨00401630å¤„ï¼ŒF7å•æ­¥æ­¥å…¥ï¼Œè·³è½¬æ¯”è¾ƒå‡½æ•°åå‘ç°flag</p><p><img src="QQæˆªå›¾20231025213613.png" /></p><p><img src="QQæˆªå›¾20231025213750.png" /></p><p>ï¼ˆæˆ–è€…æˆ‘å†™wpçš„æ—¶å€™æ‰å‘ç°00401666å¤„å·²ç»æœ‰äº†</p>]]></content>
      
      
      <categories>
          
          <category> WP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WP </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
